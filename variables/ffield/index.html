



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="ffield input variables">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/ffield/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Varff - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#ffield-input-variables" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            Varff
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Tutorial" class="md-tabs__link">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Varff
      </label>
    
    <a href="./" title="Varff" class="md-nav__link md-nav__link--active">
      Varff
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/ffield.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="ffield-input-variables">ffield input variables<a class="headerlink" href="#ffield-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
ffield input variables to be used in the input file for the abinit executable.</p>
<h2 id="atvshift"><strong>atvshift</strong><a class="headerlink" href="#atvshift" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ATomic potential (V) energy SHIFTs<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a DFT+U calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../ffield#natvshift">natvshift</a>,<a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>,<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../paw#usepawu">usepawu</a> /= 0 and <a class="wikilink codevar-wikilink" href="../ffield#natvshift">natvshift</a> in [5,7]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Defines for each atom and each spin channel (at present, can only be used with
<a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> = 1 or 2, like the +U scheme), a possible potential shift, for the d
(with <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> = 2, <a class="wikilink codevar-wikilink" href="../ffield#natvshift">natvshift</a> = 5), or f states (with <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> = 3,
<a class="wikilink codevar-wikilink" href="../ffield#natvshift">natvshift</a> = 7). In the case of d states, and 2 spin channels, a set of 10
numbers for each atom must be defined. The first set of 5 numbers corresponds
to real spherical harmonics m=-2 to m=+2 for the spin-up channel, the second
set of 5 numbers corresponds to real spherical harmonics m=-2 to m=+2 for the
spin-down channel. In the case of f states, the same ordering applies, for
sets of 7 numbers, corresponding to m=-3 to m=+3.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><a class="wikilink codevar-wikilink" href="../paw#usepawu">usepawu</a> should be non-zero, <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> should be 2 or 3.</p>
</div>
<h2 id="bdberry"><strong>bdberry</strong><a class="headerlink" href="#bdberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanD limits for BERRY phase<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (4)<br />
<em>Default value:</em> 4 * 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> in [1, 2, 3] and <a class="wikilink codevar-wikilink" href="../ffield#nberry">nberry</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="
AlP in hypothetical wurzite (hexagonal) structure
Alternative response function calculation for some rigid-atom
piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_5.abi" target="_blank">telast_5.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Test of the strain perturbation for the rigid-ion piezoelectric
tensor.  Rhombohedrally distorted
AlP as in the previous test, but using a ground-state finite-
difference calculation of the d/dk wave functions.  Such
calculations were used extensively to test the response function
piezoelectric tensor by comparison to numerical derivatives of
the ground-state polarization.  Using the same k sample in the
ground state and response function calculations, excellent
agreement has been obtained in a variety of cases (including a
better-converged version of this one).  Results using the finite-
diffrence d/dk and the analytic d/dk as in the preceeding test
agree in the limit of large k sample. The analytic form converges
much more rapidly, and is consistent with the slowly converging
polarization numerical derivatives. The present version of this
calculation uses berryopt = -2 to utilize the routine
berryphase_new.f
The ground-state polarization calculations used to compute the
numerical derivatives in such tests should also be computed using
berryphase_new.f setting berryopt = -1 and rfdir = 1 1 1 so that the
cartesian polarization is automatically generated. This eliminates
several issues that needed special attention using berryopt = 1
and the original berryphase.f routine.
The resulting cartesian polarization derivatives represent the
&quot;improper&quot; piezoelectric tensor, and have to be corrected to yield
the &quot;proper&quot; tensor as described in D. Vanderbilt, J. Phys. Chem.
Solids 61, 147 (2000), using Eq.(15).  The response-function calculation
gives the proper piezoelectric tensor.  Only the electron response, and
not the strain-induced movement of the rigid ions contributes to the
proper tensor." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>Give the lower band and the upper band of the set of bands for which the Berry
phase must be computed. Irrelevant if <a class="wikilink codevar-wikilink" href="../ffield#nberry">nberry</a> is not positive. When
<a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> is 1 (no spin-polarisation), only the two first numbers, giving the
lower and highest bands, are significant. Their occupation number is assumed
to be 2. When <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> is 2 (spin-polarized calculation), the two first
numbers give the lowest and highest bands for spin up, and the third and
fourth numbers give the lowest and highest bands for spin down. Their
occupation number is assumed to be 1.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Presently, <em>bdberry</em> MUST be initialized by the user in case of a Berry
phase calculation with <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 1, 2, or 3: the above-mentioned default
will cause an early exit.</p>
</div>
<h2 id="berryopt"><strong>berryopt</strong><a class="headerlink" href="#berryopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BERRY phase OPTions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [40/1087] in all abinit tests, [7/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="
AlP in hypothetical wurzite (hexagonal) structure
Finite-difference calculation for c-axis strain increment +/- 0.0001" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_4.abi" target="_blank">telast_4.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlP in hypothetical wurzite (hexagonal) structure
Alternative response function calculation for some rigid-atom
piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_5.abi" target="_blank">telast_5.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Finite difference calculation of the Born effective charges of AlP" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_1.abi" target="_blank">tffield_1.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Test of the strain perturbation for the rigid-ion piezoelectric
tensor.  Rhombohedrally distorted
AlP as in the previous test, but using a ground-state finite-
difference calculation of the d/dk wave functions.  Such
calculations were used extensively to test the response function
piezoelectric tensor by comparison to numerical derivatives of
the ground-state polarization.  Using the same k sample in the
ground state and response function calculations, excellent
agreement has been obtained in a variety of cases (including a
better-converged version of this one).  Results using the finite-
diffrence d/dk and the analytic d/dk as in the preceeding test
agree in the limit of large k sample. The analytic form converges
much more rapidly, and is consistent with the slowly converging
polarization numerical derivatives. The present version of this
calculation uses berryopt = -2 to utilize the routine
berryphase_new.f
The ground-state polarization calculations used to compute the
numerical derivatives in such tests should also be computed using
berryphase_new.f setting berryopt = -1 and rfdir = 1 1 1 so that the
cartesian polarization is automatically generated. This eliminates
several issues that needed special attention using berryopt = 1
and the original berryphase.f routine.
The resulting cartesian polarization derivatives represent the
&quot;improper&quot; piezoelectric tensor, and have to be corrected to yield
the &quot;proper&quot; tensor as described in D. Vanderbilt, J. Phys. Chem.
Solids 61, 147 (2000), using Eq.(15).  The response-function calculation
gives the proper piezoelectric tensor.  Only the electron response, and
not the strain-induced movement of the rigid ions contributes to the
proper tensor." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice. The Berry phase calculations are performed
in three different datasets. For each datatset, ABINIT writes
the polarization in reduced coordinates to a DDB." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs, zinc-blende structure (Test of Na Sai&#x27;s technique)
To compute the polarization, the finite
difference expression of the ddk and the second-order
energy derivatives." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Specifies the use of Berry phase for the computation of either the
polarization, the derivatives with respect to the wavevector, or finite
electric field calculations.</p>
<ul>
<li>0 &rarr; no computation of expressions relying on a Berry phase (default)</li>
<li>1 &rarr; the computation of Berry phases is activated (berryphase routine)</li>
<li>2 &rarr; the computation of derivatives with respect to the wavevector, thanks to the
    Berry phase finite-difference formula, is activated (uderiv routine)</li>
<li>3 &rarr; same as option 1 and 2 together</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that options 1 to 3 require the use of a serial build of Abinit.**</p>
</div>
<ul>
<li>-1 &rarr; alternative computation of Berry phases (berryphase_new routine)</li>
<li>-2 &rarr; alternative computation of derivatives with respect to the wavevector,
    thanks to the Berry phase finite-difference formula (berryphase_new routine)</li>
<li>-3 &rarr; same as option -1 and -2 together</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Options -1 to -3 permit use of a parallel build and will be preferred by
most users.</p>
</div>
<ul>
<li>4 &rarr; finite electric field calculation (unreduced E-field)</li>
<li>6 &rarr; finite electric displacement field calculation (unreduced D-field)</li>
<li>14 &rarr; finite reduced electric field calculation</li>
<li>16 &rarr; finite electric displacement field calculation</li>
<li>17 &rarr; mixed electric boundary condition: finite reduced electric field in some directions,
  finite reduced electric displacement field along other directions. See variable <a class="wikilink codevar-wikilink" href="../ffield#jfielddir">jfielddir</a> for more details.</li>
</ul>
<p>Other related input variables are:</p>
<ul>
<li>in case of <em>berryopt</em> = 1,2, or 3: <a class="wikilink codevar-wikilink" href="../ffield#bdberry">bdberry</a> and <a class="wikilink codevar-wikilink" href="../ffield#kberry">kberry</a>; also, <a class="wikilink codevar-wikilink" href="../ffield#nberry">nberry</a> must be larger than 0;</li>
<li>in case of <em>berryopt</em> = -1,-2, or -3: the variable <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> must be used to specify the primitive vector along which the projection of the polarization or the ddk will be computed. For example if <em>berryopt</em> = -1 and <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> = 1 0 0, the projection of the polarization along the reciprocal lattice vector <span><span class="MathJax_Preview">G_1</span><script type="math/tex">G_1</script></span> is computed. In case <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> = 1 1 1, ABINIT computes the projection of P along <span><span class="MathJax_Preview">G_1</span><script type="math/tex">G_1</script></span>, <span><span class="MathJax_Preview">G_2</span><script type="math/tex">G_2</script></span> and <span><span class="MathJax_Preview">G_3</span><script type="math/tex">G_3</script></span> and transforms the results to cartesian coordinates;</li>
<li>in cases where <em>berryopt</em> is negative, <a class="wikilink codevar-wikilink" href="../ffield#berrystep">berrystep</a> allow a computation of multiple-step Berry phase in order to accelerate the convergence.</li>
<li><a class="wikilink codevar-wikilink" href="../ffield#efield">efield</a> and <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> in case of <em>berryopt</em> = 4;</li>
</ul>
<p>The cases <em>berryopt</em> = -1,-2,-3, 4, 6, 7, 14, 16, and 17 have to be used with <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> = 1.</p>
<p>The cases <em>berryopt</em> = -1 and 4, 6, 7, 14, 16, 17 are compatible with PAW,
howevever, if in these cases one uses <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> /= 3, one must also use only
symmorphic symmetries (either because the space group is symmorphic or the
variable <a class="wikilink codevar-wikilink" href="../dev#symmorphi">symmorphi</a> is set to zero).</p>
<p>For a phonon calculation under a finite electric field, respect the following procedure.</p>
<ul>
<li>a) Run a scf ground-state calculation at zero electric field to get wavefunctions to initialize the ground-state calculation in finite electric fields.</li>
<li>b) Run a scf ground-state calculation in finite electric field. The electric field is controlled by the input variable <a class="wikilink codevar-wikilink" href="../ffield#efield">efield</a>. <em>berryopt</em> should be 4. The input variable <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> should be set to be 2.</li>
<li>c) Based on the wave functions obtained in step (2), perform phonon calculation by setting <em>berryopt</em> = 4, <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> = 3 and The same value of <a class="wikilink codevar-wikilink" href="../ffield#efield">efield</a> than in step 2. <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a> should be set to 1 currently but this restriction may be removed later. The other parameters are the same as phonon calculation at zero electric field.</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The choice of k-point sampling N x N x N should be the same in the three runs and N should be an even number.</p>
</div>
<p>In case of finite electric and displacement field calculations
(<em>berryopt</em> = 4,6,7,14,16,17), see also the input variables <a class="wikilink codevar-wikilink" href="../ffield#berrysav">berrysav</a>,
<a class="wikilink codevar-wikilink" href="../ffield#dfield">dfield</a>, <a class="wikilink codevar-wikilink" href="../ffield#red_dfield">red_dfield</a>, <a class="wikilink codevar-wikilink" href="../ffield#red_efield">red_efield</a>, <a class="wikilink codevar-wikilink" href="../ffield#ddamp">ddamp</a></p>
<h2 id="berrysav"><strong>berrysav</strong><a class="headerlink" href="#berrysav" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BERRY SAVe<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=6 (finite electric displacement field calculation,
relaxing cell perameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_124.abi" target="_blank">tsv6_124.abi</a></li>
</ul>
</details>
<ul>
<li>0 &rarr; for finite electric field calculation (<a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 4/14),
    the polarization branch will be chosen on each iteration from (-pi, pi).
    For finite electric displacement field calculation(<a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 6/7/16/17),
    the polarization will be chosen to minimize the internal energy.</li>
<li>
<p>1 &rarr; the polarization will be kept in the same branch on each iteration.
    At the end of the run, a file &ldquo;POLSAVE&rdquo; will be saved containing the reduced polarization in atomic units.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure that &ldquo;POLSAVE&rdquo; is empty or it does not exist before the calculation, or else that
it specifies the desired polarization branch.</p>
</div>
<h2 id="berrystep"><strong>berrystep</strong><a class="headerlink" href="#berrystep" title="Permanent link">&para;</a></h2>
</li>
</ul>
<p><em>Mnemonics:</em> BERRY phase: multiple STEP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> 0 &gt; <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
Test of berrystep
Al-As cristal, zinc-blende structure
Compute the polarization along strings
of k-points parallel to the primitive vectors of the reciprocal
lattice, and using multiple step berry phase calculation.
(Tests 21-30 are related to geometry optimization, molecular dynamics, etc)

Cannot be executed in parallel:
chkint_prt: ERROR -
Context : the value of the variable nproc is 2.
The value of the input variable berrystep is 5, while it must be
equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t20.abi" target="_blank">t20.abi</a></li>
</ul>
</details>
<p>If <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> is negative, this variable is used to compute berry phases
using multiple discrete steps, in order to accelerate convergence. The single-
step berry phase is the standard calculation using strings of k-points based
on overlap of Bloch function separated by <span><span class="MathJax_Preview">dk</span><script type="math/tex">dk</script></span>, while the two-step berry phase
use strings use overlaps based on dk and <span><span class="MathJax_Preview">2*dk</span><script type="math/tex">2*dk</script></span>, the three-step use overlaps
based on dk, <span><span class="MathJax_Preview">2*dk</span><script type="math/tex">2*dk</script></span> and <span><span class="MathJax_Preview">3*dk</span><script type="math/tex">3*dk</script></span>&hellip;</p>
<p>The default value of this variable is 1, meaning that only the single-step
berry phase calculation is done. If a larger value is set, ABINIT will compute
all the multiple-step berry phase from the single-step to the
<em>berrystep</em>-step, and use the large-step values of berry phase to correct
the single-step berry phase. Use with care: while experience is still to be
gained with this procedure, the outlook is promising.</p>
<h2 id="bfield"><strong>bfield</strong><a class="headerlink" href="#bfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> finite B FIELD calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to take into account an external magnetic field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t43.abi" target="_blank">t43.abi</a></li>
</ul>
</details>
<p>Perform finite magnetic field calculation.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>THIS CODE IS UNDER DEVELOPMENT AND IS NOT READY FOR USE.</p>
</div>
<h2 id="ddamp"><strong>ddamp</strong><a class="headerlink" href="#ddamp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electric Displacement field DAMPing parameter<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> in [6, 16]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=14 (finite reduced electric field calculation,relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_121.abi" target="_blank">tsv6_121.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=6 (finite electric displacement field calculation,
relaxing cell perameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_124.abi" target="_blank">tsv6_124.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs case, to test the &quot;polcen&quot; in finite reduced electric field calculation.
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_126.abi" target="_blank">tsv6_126.abi</a></li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 6, the electric field is updated after each SCF iteration
according to <span><span class="MathJax_Preview">E_{n+1}=</span><script type="math/tex">E_{n+1}=</script></span> <strong>ddamp</strong> <span><span class="MathJax_Preview">(D-4 \pi P_{n})+(1-</span><script type="math/tex">(D-4 \pi P_{n})+(1-</script></span> <strong>ddamp</strong> <span><span class="MathJax_Preview">)E_{n}</span><script type="math/tex">)E_{n}</script></span>, where
<span><span class="MathJax_Preview">P_{n}</span><script type="math/tex">P_{n}</script></span> and <span><span class="MathJax_Preview">E_{n}</span><script type="math/tex">E_{n}</script></span> are the polarization and electric field after <span><span class="MathJax_Preview">n_{th}</span><script type="math/tex">n_{th}</script></span> SCF
iteration.  <strong>ddamp</strong>  is a damping parameter used to control the convergence speed.
In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 16, the electric field is updated after each SCF
iteration according to <span><span class="MathJax_Preview">e_{n+1}=</span><script type="math/tex">e_{n+1}=</script></span> <strong>ddamp</strong> <span><span class="MathJax_Preview">(d-p_{n})+(1-</span><script type="math/tex">(d-p_{n})+(1-</script></span> <strong>ddamp</strong> <span><span class="MathJax_Preview">)e_{n}</span><script type="math/tex">)e_{n}</script></span>.
If you have difficulty getting convergence, try to reduce this value or reduce
maxestep. This parameter is used in finite electric displacement field
calculations (berryopt=6,16,17).</p>
<h2 id="dfield"><strong>dfield</strong><a class="headerlink" href="#dfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Displacement FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> == 6 and <a class="wikilink codevar-wikilink" href="../ffield#efield">efield</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=6 (finite electric displacement field calculation,
relaxing cell perameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_124.abi" target="_blank">tsv6_124.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs case, to test the &quot;polcen&quot; in finite reduced electric field calculation.
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_126.abi" target="_blank">tsv6_126.abi</a></li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 6,  <strong>dfield</strong>  specifies the (unreduced) finite electric
displacement field vector, in atomic units, that is to be imposed as a
constraint during the calculation.</p>
<h2 id="efield"><strong>efield</strong><a class="headerlink" href="#efield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electric FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> in [4, 6]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [25/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiNbO3, parallelism over k points
(coming from test v4#55 written by MVeithen, then modified by DHamann)
Test parallelism of the Berry phase calculation, and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.abi" target="_blank">t06.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
LiNbO3, rhombohedral.
Test finite electric field
Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.abi" target="_blank">tsv4_55.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs, zinc-blende structure.
Finite electric field calculation
In order to perform a first-principles calculation in an electric
field, the wavefunctions must be initialized properly. Therefore,
I do first a GS calculation to obtain the WF in the whole BZ under
zero electric field. Then, I increase the electric field slowly in
successive datasets. The calculation for each dataset is initialized
using the WF of a previous one.
I consider both positive and negative electric fields.
WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_78.abi" target="_blank">tsv4_78.abi</a>, <a class="wikilink abifile-wikilink" data-content="
CrystallIne AlAs
first three runs are for calculation of ground state at finite electric field
the fourth run gets the gs wavefunction and then do response calculation
the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_80.abi" target="_blank">tsv4_80.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite electric field calculation of AlP at clamped atomic positions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_6.abi" target="_blank">tffield_6.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
AlAs in Zincblende structure.
Test calculation of the Born effective charge and dielectric constant
tensor at finite electric fields.
The first dataset is for normal ground-state calculation at zero electric field.
The second dataset is for ground-state calculation at finite electric field.
The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.abi" target="_blank">t23.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Test berryopt -1 and berryopt 4, with NCPP, with spinors and spin-orbit coupling. This
test computes the polarization of GaAs in zero and finite electric field, in three
cases: nspinor 1, nspinor 2, and nspinor 2 with spin-orbit coupling (so_psp). HGH
norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 4, a finite electric field calculation is performed. The
value of this electric field, and its direction is determined by  <strong>efield</strong> .
It must be given in atomic units (1 a.u. of electric field= 514220624373.482
V/m, see note below), in cartesian coordinates.</p>
<p>References for the calculation under electric field (based on multi k point Berry phase):</p>
<ul>
<li><a class="wikilink citation-wikilink" data-content="Real-Space Approach to Calculation of Electric Polarization and Dielectric Constants" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#nunes1994">[Nunes1994]</a>: real-space version of the finite-field Hamiltonian</li>
<li><a class="wikilink citation-wikilink" data-content="Berry-phase treatment of the homogeneous electric field perturbation in insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#nunes2001">[Nunes2001]</a>: reciprocal-space version of the finite-field Hamiltonian (the one presently implemented), and extensive theoretical analysis</li>
<li><a class="wikilink citation-wikilink" data-content="First-Principles Approach to Insulators in Finite Electric Fields" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#souza2002">[Souza2002]</a>: implementation of the finite-field Hamiltonian (reciprocal-space version)</li>
<li><a class="wikilink citation-wikilink" data-content="Finite homogeneous electric fields in the projector augmented wave formalism: Applications to linear and nonlinear response" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#zwanziger2012">[Zwanziger2012]</a>: extension to PAW formalism</li>
</ul>
<p>See also <a class="wikilink citation-wikilink" data-content="Concentration of Small Ring Structures in Vitreous Silica from a First-Principles Analysis of the Raman Spectrum" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#umari2003">[Umari2003]</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The atomic unit of electric field strength is: <span><span class="MathJax_Preview">\frac{e_{Cb}}{4\pi\varepsilon_0a_0^2}</span><script type="math/tex">\frac{e_{Cb}}{4\pi\varepsilon_0a_0^2}</script></span>, where
<span><span class="MathJax_Preview">e_{Cb}</span><script type="math/tex">e_{Cb}</script></span> is the electronic charge in Coulomb (1.60217653<span><span class="MathJax_Preview">^{-19}</span><script type="math/tex">^{-19}</script></span>), <span><span class="MathJax_Preview">\varepsilon_0</span><script type="math/tex">\varepsilon_0</script></span> is the
electric constant (8.854187817d-12 F/m), and <span><span class="MathJax_Preview">a_0</span><script type="math/tex">a_0</script></span> is the Bohr radius in meter
(0.5291772108<span><span class="MathJax_Preview">^{-10}</span><script type="math/tex">^{-10}</script></span>).</p>
</div>
<h2 id="jfielddir"><strong>jfielddir</strong><a class="headerlink" href="#jfielddir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electric/displacement FIELD DIRection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 17<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a></li>
</ul>
</details>
<p>When specifying mixed electric field boundary conditions ( <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 17),
 <strong>jfielddir</strong>  controls whether reduced electric field ( <strong>jfielddir</strong>  = 1) or reduced
electric displacement field ( <strong>jfielddir</strong>  = 2) is chosen to be fixed, in each
of the three lattice directions (i.e., in the reduced, not the Cartesian,
frame). For example,  <strong>jfielddir</strong>  = (1 1 2) tells the code to use fixed <span><span class="MathJax_Preview">\bar{e}_1</span><script type="math/tex">\bar{e}_1</script></span>
and <span><span class="MathJax_Preview">\bar{e}_2</span><script type="math/tex">\bar{e}_2</script></span> along the first two lattice directions and fixed <span><span class="MathJax_Preview">d_3</span><script type="math/tex">d_3</script></span> along the third.
For the case of mixed electric field boundary conditions, <a class="wikilink codevar-wikilink" href="../ffield#red_efieldbar">red_efieldbar</a>
and <a class="wikilink codevar-wikilink" href="../ffield#red_dfield">red_dfield</a> are used to control <span><span class="MathJax_Preview">\bar{e}</span><script type="math/tex">\bar{e}</script></span> and <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>, respectively. For example,
for electric boundary conditions corresponding to a material in a parallel-
plate capacitor, if you want to control <span><span class="MathJax_Preview">d_3=d_0</span><script type="math/tex">d_3=d_0</script></span>, while fixing <span><span class="MathJax_Preview">\bar{e}_1=\bar{e}_1=0</span><script type="math/tex">\bar{e}_1=\bar{e}_1=0</script></span>,
then the input files should have <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 17,  <strong>jfielddir</strong>  = (1 1 2),
<a class="wikilink codevar-wikilink" href="../ffield#red_efieldbar">red_efieldbar</a> = (0.0 0.0 a), and <a class="wikilink codevar-wikilink" href="../ffield#red_dfield">red_dfield</a> = (<span><span class="MathJax_Preview">b\ c\ d_0</span><script type="math/tex">b\ c\ d_0</script></span>). Here a, b, and c
are the starting values. They can be chosen in this way: do a single run for
fixed d calculation (<a class="wikilink codevar-wikilink" href="../ffield#red_dfield">red_dfield</a> = 0,0,<span><span class="MathJax_Preview">d_0</span><script type="math/tex">d_0</script></span>), from the final results you will
have <span><span class="MathJax_Preview">\bar{e}_3</span><script type="math/tex">\bar{e}_3</script></span>, which is a good guess for a. Then do another single run for fixed
ebar calculation (<a class="wikilink codevar-wikilink" href="../ffield#red_efieldbar">red_efieldbar</a> = (0 0 0)), from the final results you will
have <span><span class="MathJax_Preview">d_1</span><script type="math/tex">d_1</script></span>,<span><span class="MathJax_Preview">d_2</span><script type="math/tex">d_2</script></span>, these are good guesses for b, c.</p>
<h2 id="kberry"><strong>kberry</strong><a class="headerlink" href="#kberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K wavevectors for BERRY phase computation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../ffield#nberry">nberry</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 1, 2, or 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si in diamond structure; 2 special points; low ecut.
With a 4x4x4 k point grid (!only one shift, but OK
because symmetry is imposed), compute the
dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_05.abi" target="_blank">tsv3_05.abi</a></li>
</ul>
</details>
<p>Used for values of <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 1, 2, or 3.</p>
<p>This array defines, for each Berry phase calculation (the number of such
calculations is defined by <a class="wikilink codevar-wikilink" href="../ffield#nberry">nberry</a>), the difference of wavevector between k
points for which the overlap matrix must be computed. The polarisation vector
will be projected on the direction of that wavevector, and the result of the
computation will be the magnitude of this projection. Doing more than one
wavevector, with different independent direction, allows one to find the full
polarisation vector. However, note that converged results need oriented grids,
denser along the difference wavevector than usual Monkhorst-Pack grids.</p>
<p>The difference of wavevector is computed in the coordinate system defined by
the k-points grid (see <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>), so that the values of
 <strong>kberry</strong>  are integers. Of course, such a k point grid must exist, and all
the corresponding wavefunctions must be available, so that the computation is
allowed only when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> is equal to 3. In order to save computing time,
it is suggested to make a preliminary calculation of the wavefunctions on the
irreducible part of the grid, with <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> equal to 1, and then use these
converged wavefunctions in the entire Brillouin zone, by reading them to
initialize the <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> = 3 computation.</p>
<h2 id="maxestep"><strong>maxestep</strong><a class="headerlink" href="#maxestep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAXimum Electric field STEP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.005<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 6, 16, or 17<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-content="
AlAs case, to test the &quot;polcen&quot; in finite reduced electric field calculation.
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_126.abi" target="_blank">tsv6_126.abi</a></li>
</ul>
</details>
<p>This variable controls the maximum change of electric field when updating the
electric field after each SCF iteration. When the calculation is difficult to
converge, try reducing this value or reducing <a class="wikilink codevar-wikilink" href="../ffield#ddamp">ddamp</a>. This variable is used
in finite electric displacement field calculations (<a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 6,16,17).</p>
<h2 id="natvshift"><strong>natvshift</strong><a class="headerlink" href="#natvshift" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATomic potential (V) energy SHIFTs (per atom)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a DFT+U calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../paw#usepawu">usepawu</a> /= 0, <a class="wikilink codevar-wikilink" href="../ffield#atvshift">atvshift</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Ni atom in a big box.
Test the use of the atvshift variable :
change the potential of the d orbitals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Number of atomic potential energy shifts (per atom), to be used to define the
array <a class="wikilink codevar-wikilink" href="../ffield#atvshift">atvshift</a>. If non-zero, only two possibilities exist: 5 for d states
(with <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> = 2), and 7 for f states (with <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> = 3). If non-zero, one
should define <a class="wikilink codevar-wikilink" href="../paw#usepawu">usepawu</a>, <a class="wikilink codevar-wikilink" href="../paw#lpawu">lpawu</a> and <a class="wikilink codevar-wikilink" href="../ffield#atvshift">atvshift</a>.</p>
<h2 id="nberry"><strong>nberry</strong><a class="headerlink" href="#nberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BERRY phase computations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 1, 2, or 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure.
Compute Berry phase along 0 0 1, using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.abi" target="_blank">tsv2_82.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a></li>
</ul>
</details>
<p>Gives the number of Berry phase computations of polarisation, or finite-
difference estimations of the derivative of wavefunctions with respect to the
wavevector, each of which might be characterized by a different change of
wavevector <a class="wikilink codevar-wikilink" href="../ffield#kberry">kberry</a>.</p>
<p>When equal to 0, no Berry phase calculation of polarisation is performed. The
maximal value of  <strong>nberry</strong>  is 20.</p>
<p>Note that the computation of the polarisation for a set of bands having
different occupation numbers is meaningless (although in the case of spin-
polarized calculations, the spin up bands might have an identical occupation
number, that might differ from the identical occupation number of spin down
bands). Although meaningless, ABINIT will perform such computation, if
required by the user. The input variable <a class="wikilink codevar-wikilink" href="../ffield#bdberry">bdberry</a> governs the set of bands
for which a Berry phase is computed.</p>
<p>For the <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 1, 2, and 3 cases, spinor wavefunctions are not
allowed, nor are parallel computations.</p>
<h2 id="polcen"><strong>polcen</strong><a class="headerlink" href="#polcen" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POLarization for CENtrosymmetric geometry<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
AlAs case, to test the &quot;polcen&quot; in finite reduced electric field calculation.
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_126.abi" target="_blank">tsv6_126.abi</a></li>
</ul>
</details>
<p>When doing a finite electric displacement field calculation, if the structure
is centrosymmetric but the polarization is non-zero (such as for AlAs), this
non-zero polarization should be specified as  <strong>polcen</strong>  (in REDUCED
coordinates, in atomic units) in the input file. See Eq.(24) in the Suppl. of <a class="wikilink citation-wikilink" data-content="Electric displacement as the fundamental variable in electronic-structure calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#stengel2009">[Stengel2009]</a></p>
<h2 id="qprtrb"><strong>qprtrb</strong><a class="headerlink" href="#qprtrb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q-wavevector of the PERTurbation<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform some artificial modifications of the physics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#vprtrb">vprtrb</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Gives the wavevector, in units of reciprocal lattice primitive translations,
of a perturbing potential of strength <a class="wikilink codevar-wikilink" href="../ffield#vprtrb">vprtrb</a>. See <a class="wikilink codevar-wikilink" href="../ffield#vprtrb">vprtrb</a> for more info.</p>
<h2 id="red_dfield"><strong>red_dfield</strong><a class="headerlink" href="#red_dfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Displacement FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 16, <a class="wikilink codevar-wikilink" href="../ffield#red_efield">red_efield</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a></li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 16, a reduced finite electric displacement field
calculation is performed. The value of this displacement field, and its
direction is determined by  <strong>red_dfield</strong> . It must be given in atomic units.</p>
<p><strong>red_dfield</strong>  is defined via Eq.(26) in the Supplement of <a class="wikilink citation-wikilink" data-content="Electric displacement as the fundamental variable in electronic-structure calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#stengel2009">[Stengel2009]</a>.</p>
<h2 id="red_efield"><strong>red_efield</strong><a class="headerlink" href="#red_efield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Electric FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 16<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=14 (finite reduced electric field calculation,relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_121.abi" target="_blank">tsv6_121.abi</a>, <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a></li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 16, a reduced finite electric displacement field
calculation is performed. In this case, the parameter  <strong>red_efield</strong>  specifies the
initial electric field used on the first iteration, in atomic units.</p>
<p><strong>red_efield</strong>  is defined via Eq.(25) in the Supplement <a class="wikilink citation-wikilink" data-content="Electric displacement as the fundamental variable in electronic-structure calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#stengel2009">[Stengel2009]</a>.</p>
<h2 id="red_efieldbar"><strong>red_efieldbar</strong><a class="headerlink" href="#red_efieldbar" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Electric FIELD BAR<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 14<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=14 (finite reduced electric field calculation,relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_121.abi" target="_blank">tsv6_121.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test berryopt=17 (mixed finite electric field and electric displacement
field boundary condition, relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_125.abi" target="_blank">tsv6_125.abi</a></li>
</ul>
</details>
<p>In case <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a> = 14, a reduced finite electric field calculation is
performed. The magnitude and direction of this electric field are determined
by  <strong>red_efieldbar</strong> . It must be given in atomic units.</p>
<p><strong>red_efieldbar</strong>  is defined via Eq.(28) in the Supplement of <a class="wikilink citation-wikilink" data-content="Electric displacement as the fundamental variable in electronic-structure calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#stengel2009">[Stengel2009]</a>.</p>
<h2 id="spinmagntarget"><strong>spinmagntarget</strong><a class="headerlink" href="#spinmagntarget" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPIN-MAGNetization TARGET<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a spin-polarized calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -99.99<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [53/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
CH molecule spin-polarized, in a big box.
Norm conserving : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 15) and box size (4 3 3 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 13, 5 4 4 box) : 1.138, 1.130, 1.131 Angstrom
Better  calculation  (ecut 18, 7 6 6 box) : 1.135, 1.124, 1.125 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-content="
CH molecule spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with slightly better converged ecut (ecut 15) and box size (6 5 5 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation (ecut 13, 5 4 4 box)     : 1.130, 1.121, 1.122 Angstrom
Better calculation (ecut 15, 6 5 5 box)      : 1.136, 1.125, 1.126 Angstrom
Even better calculation (ecut 18, 7 6 6 box) : 1.138, 1.126, 1.127 Angstrom
ABINIT Arnardi report (ecut acell unknown)   : 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)     : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*npkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-content="
N2 molecule
Test TDDFT in parallel, with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon : print the pwfn.data file,
for use in a subsequent run of the CASINO code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_90.abi" target="_blank">tsv4_90.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-content="
3H2 molecule with distant atoms : probe the use of the spinat variable
Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
Use PseudosGTH_pwteter/01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
Separation is 4 bohr.
Consider anti-parallel spin configuration,  which is the favoured one
for this distance. Get total energy of -0.981 839  Ha .
Note that the spin-polarization is not complete.
Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t39.abi" target="_blank">t39.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-content="
Silicon, diamond structure.
Test the ability to read an input wavefunction and to generate
from it any other wavefunction, changing different parameters.
One of the _DEN file is also used as starting point of
the cut3D tests." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
Test phonon RF for spin-polarized case.
ixc=1 (Teter LSDA)
From datasets 3 and 4, one gets the derivatives
with respect to the atomic displacement along x.
The simple finite-difference formula gives the
2DTE 6.283100652 Ha, while the direct computation,
without using Shubnikov symmetries, gives
6.282967527 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-content="
H diatomic molecule in the antiferromagnetic regime.
Different data sets.
Test Shubnikov symmetries." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Fe BCC crystal.
Constraint the magnetic moment, using the input variable spinmagntarget." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Crystalline Cu2O
Computation of the total energy and EFG tensors in DFT+U formalism
Note: Cu2O is a nonmagnetic insulator. However, DFT+U
as implemented requires nspden=2 in all cases." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
N2 molecule non-spin-polarized, but treated with nsppol=2, in a big box.
Similar to test 55 of tests/v3. There should be only
small numerical differences with respect to datasets 1 and 2 of this test,
due to the fact that the tetragonal symmetry was here slightly broken
for sake of portability of the automatic test.
Note however that the singlet and triplet states cannot be disentagled,
so one gets a big list of excitations, the merge of singlet and triplet
excitations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-content="
BeH spin-polarized, in a supercell
Test the spin-polarized TDDFT implementation.
nband 20 , ecut 8 , acell 14 14 14 .
For the first two excitations, one finds :
2.40967E+00 eV , doubly degenerate  (Pi excitation)
3.94165E+00 eV  (Sigma+ excitation)
They come mainly from the 2nd occupied Kohn-Sham state, spin up.
The third excitation, at 5.11592E+00 eV (Sigma+ excitation) comes mainly from
the 1st occupied Kohn-Sham state, spin down.
Then, come excitations that are in the continuum, or close to it
(depending on the parameters of the calculation), so, harder to converge,
In order to have a calculation converged
at the level of 0.1 eV, one needs parameters like
nband 40 , ecut 10 , acell 30.
In that case, the three above-mentioned excitations become
2.388 eV (Pi), 4.432 eV (Sigma+), 5.357 eV (Sigma+).
In this case, the latter is no more the third excitation, as other ones,
coupled to the vacuum have a lower energy.
These numbers can be compared to the values given by
J. Guan, ME Casida, DR Salahub, J. of Mol. Structure - Theochem 527,
229, Sp. Iss. SI (2000) :
2.391 eV (1Pi), 4.593 eV (2Sigma+), 5.418 eV (5Sigma+),
and to the experimental values (see the above paper)
2.56 eV/2.484 eV , 5.51 eV , 6.71 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test the mGGA implementation. Silicon bulk. Two datasets are run.
One with a fake native mGGA (fake2, i.e. ixc 32) involving laplacian of the density.
One with a fake native mGGA (fake3, i.e. ixc 33) involving gradient of the density.
Both calculation should give the same total and exchange-correlation energies.
(Two other datasets are also run for spin polarized case)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si diatomic molecule
Test of linear and non-linear response in the non-spin-polarized case.
Only four bands are allowed, both spin-up and spin-down, so that
the molecule is non spin polarized.
However nsppol=2 for testing purposes.
Over 1200 WARNINGS.
This test must give the same results of the test 64
non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.abi" target="_blank">t63.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
EuO rock salt structure.
27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 )
Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget,
and also metallic occopt. Also test pawxcdev=0" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="DFPT in non-collinear magnetism, ground state WF" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="DFPT in non-collinear magnetism: ddk with ixcrot=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-content="DFPT in non-collinear magnetism: ddk with ixcrot=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 08 (netcdf files with h1 matrix elements)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GaAs, zinc-blende structure. PAW. GGA-PBE. Treated with nsppol=2.
Generate the data for optic (linear coefficients).
to be analysed in test 12 (netcdf files with h1 matrix elements)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
</ul>
</details>
<p>This input variable is active only in the <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> = 2 case. If
 <strong>spinmagntarget</strong>  is not the &ldquo;magic&rdquo; value of -99.99, the spin-
magnetization of the primitive cell will be fixed (or optimized, if it is not
possible to impose it) to the value of  <strong>spinmagntarget</strong> , in Bohr magneton
units (for an Hydrogen atom, it is 1).
If <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> is a metallic one, the Fermi energies for spin up and spin down
are adjusted to give the target spin-polarisation (this is equivalent to an
exchange splitting). If <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> = 1 and <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> = 2, the occupation numbers
for spin up and spin down will be adjusted to give the required spin-
magnetization (occupation numbers are identical for all k-points, with
<a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> = 1). The definition of  <strong>spinmagntarget</strong>  is actually requested in
this case, except for the single isolated Hydrogen atom.
If  <strong>spinmagntarget</strong>  is the default one, the spin-magnetization will not be
constrained, and will be determined self-consistently, by having the same spin
up and spin down Fermi energy in the metallic case, while for the other cases,
there will be no spin-magnetization, except for an odd number of electrons if
<a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> = 1 and <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> = 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the time being, only the spin down Fermi energy is written out in
the main output file. In the fixed magnetic moment case, it differs from the
spin up Fermi energy.</p>
</div>
<h2 id="vprtrb"><strong>vprtrb</strong><a class="headerlink" href="#vprtrb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> potential -V- for the PeRTuRBation<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">DEVELOP</a>, <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform some artificial modifications of the physics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [0.0, 0.0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../ffield#qprtrb">qprtrb</a><br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
This should be linked with the computation of the dielectric constant,
test v2#05, that uses directly the RF capabilities of ABINIT,
for one diatomic molecule.
For dataset 1, one reproduces the results obtained in Tv2#05, multiplied by 4.
The total energy is consistent up to more than 10 digits :
-6.6499924738006 Ha for Tv2#05, -26.599969895203 Ha for the present calculation.
For dataset 2, the perturbation qprtrb 0 0 1 is frozen in, with vprtrb 100.
The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is
0.000348743572 Ha.
For dataset 3, a much smaller perturbation (10 times smaller) is taken,
giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is
0.3472583 microHa.
For dataset 4, an even smaller perturbation (100 times smaller) is taken,
giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is
0.000034725 microHa. With datasets 3 and 4, we are in the linear regime.
The previous amplitude is better for such studies.
Dataset 5 is the same as 3, with reversed amplitude. Results are similar to dataset 3.
I had no sufficient time to analyze these data correctly and make the connection with the
results of Tv2#05, unfortunately. The following (also test 02 below) gives some more data, and raise questions.
There might be some problem with the use of qprtrb and vprtrb.
For dataset 2, the group of the four lowest eigenenergies (each corresponding to a different molecule) is :
-0.47198  -0.46381  -0.46091  -0.45266 , whose spread is 0.01932 Ha.
One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha.
The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100, divided by the volume
of the cell, that is 5000 Bohr^3 : 0.02 Ha. The maximum
and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Chain of Silicon diatomic molecules (4 Si2 molecules in the cell)
Freeze oscillatory perturbations with different wavelengths and intensities,
thanks to the qprtrb and vprtrb input variables.
Compute the dielectric constant. Similar to test v6#01,
but uses a more symmetric geometry, to examine invariance
of the response with respect to shifts of potential, and also
a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response.
Such a sine wave should cause similar response as for the cosine wave.
No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>Gives the real and imaginary parts of a scalar potential perturbation. Can be
specified in Ha (the default), Ry, eV or Kelvin, since  <strong>vprtrb</strong>  has the
<a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a> characteristics.
This is made available for testing responses to such perturbations. The form
of the perturbation, which is added to the local potential, is:</p>
<ul>
<li>( <strong>vprtrb</strong> (1)<span><span class="MathJax_Preview">+I</span><script type="math/tex">+I</script></span> <strong>vprtrb</strong> (2)<span><span class="MathJax_Preview">)/2</span><script type="math/tex">)/2</script></span> at <span><span class="MathJax_Preview">G=</span><script type="math/tex">G=</script></span><a class="wikilink codevar-wikilink" href="../ffield#qprtrb">qprtrb</a> and</li>
<li>( <strong>vprtrb</strong> (1)<span><span class="MathJax_Preview">-I</span><script type="math/tex">-I</script></span> <strong>vprtrb</strong> (2)<span><span class="MathJax_Preview">)/2</span><script type="math/tex">)/2</script></span> at <span><span class="MathJax_Preview">G=-</span><script type="math/tex">G=-</script></span><a class="wikilink codevar-wikilink" href="../ffield#qprtrb">qprtrb</a> (see <a class="wikilink codevar-wikilink" href="../ffield#qprtrb">qprtrb</a> also).</li>
</ul>
<h2 id="zeemanfield"><strong>zeemanfield</strong><a class="headerlink" href="#zeemanfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ZEEMAN FIELD<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">MAGNETIC_FIELD</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to take into account an external magnetic field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-content="
Bi atom in a big supercell.
Test the application of a Zeeman field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t17.abi" target="_blank">t17.abi</a></li>
</ul>
</details>
<p>Give the value of the Zeeman field, <span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>, acting on the spinorial wavefunctions.
Note that Tesla are admitted. This sets the magnitude of <span><span class="MathJax_Preview">\mu_0H</span><script type="math/tex">\mu_0H</script></span>, in Tesla,
with H in Amperes/metre.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorial/" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Tutorial" class="md-tabs__link">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../eph/" title="Electron-Phonon" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Electron-Phonon
              </span>
            </div>
          </a>
        
        
          <a href="../files/" title="File-handling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                File-handling
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>