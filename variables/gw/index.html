



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="gw input variables">
      
      
        <link rel="canonical" href="https://docs.abinit.org/variables/gw/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>GW - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#gw-input-variables" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            GW
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Tutorial" class="md-tabs__link">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        GW
      </label>
    
    <a href="./" title="GW" class="md-nav__link md-nav__link--active">
      GW
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#awtr" title="awtr" class="md-nav__link">
    awtr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdgw" title="bdgw" class="md-nav__link">
    bdgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_customnimfrqs" title="cd_customnimfrqs" class="md-nav__link">
    cd_customnimfrqs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_frqim_method" title="cd_frqim_method" class="md-nav__link">
    cd_frqim_method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_full_grid" title="cd_full_grid" class="md-nav__link">
    cd_full_grid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_halfway_freq" title="cd_halfway_freq" class="md-nav__link">
    cd_halfway_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_imfrqs" title="cd_imfrqs" class="md-nav__link">
    cd_imfrqs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_max_freq" title="cd_max_freq" class="md-nav__link">
    cd_max_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_subset_freq" title="cd_subset_freq" class="md-nav__link">
    cd_subset_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecuteps" title="ecuteps" class="md-nav__link">
    ecuteps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecutsigx" title="ecutsigx" class="md-nav__link">
    ecutsigx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecutwfn" title="ecutwfn" class="md-nav__link">
    ecutwfn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftgw" title="fftgw" class="md-nav__link">
    fftgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqim_alpha" title="freqim_alpha" class="md-nav__link">
    freqim_alpha
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqremax" title="freqremax" class="md-nav__link">
    freqremax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqremin" title="freqremin" class="md-nav__link">
    freqremin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqspmax" title="freqspmax" class="md-nav__link">
    freqspmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqspmin" title="freqspmin" class="md-nav__link">
    freqspmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw1rdm" title="gw1rdm" class="md-nav__link">
    gw1rdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_customnfreqsp" title="gw_customnfreqsp" class="md-nav__link">
    gw_customnfreqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_freqsp" title="gw_freqsp" class="md-nav__link">
    gw_freqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqim_inzgrid" title="gw_frqim_inzgrid" class="md-nav__link">
    gw_frqim_inzgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqre_inzgrid" title="gw_frqre_inzgrid" class="md-nav__link">
    gw_frqre_inzgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqre_tangrid" title="gw_frqre_tangrid" class="md-nav__link">
    gw_frqre_tangrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_icutcoul" title="gw_icutcoul" class="md-nav__link">
    gw_icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_invalid_freq" title="gw_invalid_freq" class="md-nav__link">
    gw_invalid_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_nqlwl" title="gw_nqlwl" class="md-nav__link">
    gw_nqlwl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_nstep" title="gw_nstep" class="md-nav__link">
    gw_nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_qlwl" title="gw_qlwl" class="md-nav__link">
    gw_qlwl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_qprange" title="gw_qprange" class="md-nav__link">
    gw_qprange
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_sctype" title="gw_sctype" class="md-nav__link">
    gw_sctype
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_sigxcore" title="gw_sigxcore" class="md-nav__link">
    gw_sigxcore
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_toldfeig" title="gw_toldfeig" class="md-nav__link">
    gw_toldfeig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwaclowrank" title="gwaclowrank" class="md-nav__link">
    gwaclowrank
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwcalctyp" title="gwcalctyp" class="md-nav__link">
    gwcalctyp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwcomp" title="gwcomp" class="md-nav__link">
    gwcomp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwencomp" title="gwencomp" class="md-nav__link">
    gwencomp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwgamma" title="gwgamma" class="md-nav__link">
    gwgamma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwgmcorr" title="gwgmcorr" class="md-nav__link">
    gwgmcorr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_band_index" title="gwls_band_index" class="md-nav__link">
    gwls_band_index
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_correlation" title="gwls_correlation" class="md-nav__link">
    gwls_correlation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_diel_model" title="gwls_diel_model" class="md-nav__link">
    gwls_diel_model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_exchange" title="gwls_exchange" class="md-nav__link">
    gwls_exchange
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_first_seed" title="gwls_first_seed" class="md-nav__link">
    gwls_first_seed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_analytic" title="gwls_kmax_analytic" class="md-nav__link">
    gwls_kmax_analytic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_complement" title="gwls_kmax_complement" class="md-nav__link">
    gwls_kmax_complement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_numeric" title="gwls_kmax_numeric" class="md-nav__link">
    gwls_kmax_numeric
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_poles" title="gwls_kmax_poles" class="md-nav__link">
    gwls_kmax_poles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_list_proj_freq" title="gwls_list_proj_freq" class="md-nav__link">
    gwls_list_proj_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_model_parameter" title="gwls_model_parameter" class="md-nav__link">
    gwls_model_parameter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_n_proj_freq" title="gwls_n_proj_freq" class="md-nav__link">
    gwls_n_proj_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_npt_gauss_quad" title="gwls_npt_gauss_quad" class="md-nav__link">
    gwls_npt_gauss_quad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_nseeds" title="gwls_nseeds" class="md-nav__link">
    gwls_nseeds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_print_debug" title="gwls_print_debug" class="md-nav__link">
    gwls_print_debug
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_recycle" title="gwls_recycle" class="md-nav__link">
    gwls_recycle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_stern_kmax" title="gwls_stern_kmax" class="md-nav__link">
    gwls_stern_kmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwmem" title="gwmem" class="md-nav__link">
    gwmem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwrpacorr" title="gwrpacorr" class="md-nav__link">
    gwrpacorr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inclvkb" title="inclvkb" class="md-nav__link">
    inclvkb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc_sigma" title="ixc_sigma" class="md-nav__link">
    ixc_sigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptgw" title="kptgw" class="md-nav__link">
    kptgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mbpt_sciss" title="mbpt_sciss" class="md-nav__link">
    mbpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mdf_epsinf" title="mdf_epsinf" class="md-nav__link">
    mdf_epsinf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandkss" title="nbandkss" class="md-nav__link">
    nbandkss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqim" title="nfreqim" class="md-nav__link">
    nfreqim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqmidm" title="nfreqmidm" class="md-nav__link">
    nfreqmidm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqre" title="nfreqre" class="md-nav__link">
    nfreqre
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqsp" title="nfreqsp" class="md-nav__link">
    nfreqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkptgw" title="nkptgw" class="md-nav__link">
    nkptgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasf" title="nomegasf" class="md-nav__link">
    nomegasf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasi" title="nomegasi" class="md-nav__link">
    nomegasi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasrd" title="nomegasrd" class="md-nav__link">
    nomegasrd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npvel" title="npvel" class="md-nav__link">
    npvel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npwkss" title="npwkss" class="md-nav__link">
    npwkss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqptdm" title="nqptdm" class="md-nav__link">
    nqptdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#omegasimax" title="omegasimax" class="md-nav__link">
    omegasimax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#omegasrdmax" title="omegasrdmax" class="md-nav__link">
    omegasrdmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppmfrq" title="ppmfrq" class="md-nav__link">
    ppmfrq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppmodel" title="ppmodel" class="md-nav__link">
    ppmodel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pvelmax" title="pvelmax" class="md-nav__link">
    pvelmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptdm" title="qptdm" class="md-nav__link">
    qptdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rcut" title="rcut" class="md-nav__link">
    rcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rhoqpmix" title="rhoqpmix" class="md-nav__link">
    rhoqpmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_bsum_range" title="sigma_bsum_range" class="md-nav__link">
    sigma_bsum_range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_ngkpt" title="sigma_ngkpt" class="md-nav__link">
    sigma_ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_nshiftk" title="sigma_nshiftk" class="md-nav__link">
    sigma_nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_shiftk" title="sigma_shiftk" class="md-nav__link">
    sigma_shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spbroad" title="spbroad" class="md-nav__link">
    spbroad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spmeth" title="spmeth" class="md-nav__link">
    spmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symchi" title="symchi" class="md-nav__link">
    symchi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symsigma" title="symsigma" class="md-nav__link">
    symsigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa" title="ucrpa" class="md-nav__link">
    ucrpa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa_bands" title="ucrpa_bands" class="md-nav__link">
    ucrpa_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa_window" title="ucrpa_window" class="md-nav__link">
    ucrpa_window
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vcutgeo" title="vcutgeo" class="md-nav__link">
    vcutgeo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x1rdm" title="x1rdm" class="md-nav__link">
    x1rdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zcut" title="zcut" class="md-nav__link">
    zcut
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#awtr" title="awtr" class="md-nav__link">
    awtr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdgw" title="bdgw" class="md-nav__link">
    bdgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_customnimfrqs" title="cd_customnimfrqs" class="md-nav__link">
    cd_customnimfrqs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_frqim_method" title="cd_frqim_method" class="md-nav__link">
    cd_frqim_method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_full_grid" title="cd_full_grid" class="md-nav__link">
    cd_full_grid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_halfway_freq" title="cd_halfway_freq" class="md-nav__link">
    cd_halfway_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_imfrqs" title="cd_imfrqs" class="md-nav__link">
    cd_imfrqs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_max_freq" title="cd_max_freq" class="md-nav__link">
    cd_max_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cd_subset_freq" title="cd_subset_freq" class="md-nav__link">
    cd_subset_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecuteps" title="ecuteps" class="md-nav__link">
    ecuteps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecutsigx" title="ecutsigx" class="md-nav__link">
    ecutsigx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecutwfn" title="ecutwfn" class="md-nav__link">
    ecutwfn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftgw" title="fftgw" class="md-nav__link">
    fftgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqim_alpha" title="freqim_alpha" class="md-nav__link">
    freqim_alpha
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqremax" title="freqremax" class="md-nav__link">
    freqremax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqremin" title="freqremin" class="md-nav__link">
    freqremin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqspmax" title="freqspmax" class="md-nav__link">
    freqspmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freqspmin" title="freqspmin" class="md-nav__link">
    freqspmin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw1rdm" title="gw1rdm" class="md-nav__link">
    gw1rdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_customnfreqsp" title="gw_customnfreqsp" class="md-nav__link">
    gw_customnfreqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_freqsp" title="gw_freqsp" class="md-nav__link">
    gw_freqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqim_inzgrid" title="gw_frqim_inzgrid" class="md-nav__link">
    gw_frqim_inzgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqre_inzgrid" title="gw_frqre_inzgrid" class="md-nav__link">
    gw_frqre_inzgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_frqre_tangrid" title="gw_frqre_tangrid" class="md-nav__link">
    gw_frqre_tangrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_icutcoul" title="gw_icutcoul" class="md-nav__link">
    gw_icutcoul
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_invalid_freq" title="gw_invalid_freq" class="md-nav__link">
    gw_invalid_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_nqlwl" title="gw_nqlwl" class="md-nav__link">
    gw_nqlwl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_nstep" title="gw_nstep" class="md-nav__link">
    gw_nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_qlwl" title="gw_qlwl" class="md-nav__link">
    gw_qlwl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_qprange" title="gw_qprange" class="md-nav__link">
    gw_qprange
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_sctype" title="gw_sctype" class="md-nav__link">
    gw_sctype
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_sigxcore" title="gw_sigxcore" class="md-nav__link">
    gw_sigxcore
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gw_toldfeig" title="gw_toldfeig" class="md-nav__link">
    gw_toldfeig
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwaclowrank" title="gwaclowrank" class="md-nav__link">
    gwaclowrank
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwcalctyp" title="gwcalctyp" class="md-nav__link">
    gwcalctyp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwcomp" title="gwcomp" class="md-nav__link">
    gwcomp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwencomp" title="gwencomp" class="md-nav__link">
    gwencomp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwgamma" title="gwgamma" class="md-nav__link">
    gwgamma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwgmcorr" title="gwgmcorr" class="md-nav__link">
    gwgmcorr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_band_index" title="gwls_band_index" class="md-nav__link">
    gwls_band_index
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_correlation" title="gwls_correlation" class="md-nav__link">
    gwls_correlation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_diel_model" title="gwls_diel_model" class="md-nav__link">
    gwls_diel_model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_exchange" title="gwls_exchange" class="md-nav__link">
    gwls_exchange
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_first_seed" title="gwls_first_seed" class="md-nav__link">
    gwls_first_seed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_analytic" title="gwls_kmax_analytic" class="md-nav__link">
    gwls_kmax_analytic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_complement" title="gwls_kmax_complement" class="md-nav__link">
    gwls_kmax_complement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_numeric" title="gwls_kmax_numeric" class="md-nav__link">
    gwls_kmax_numeric
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_kmax_poles" title="gwls_kmax_poles" class="md-nav__link">
    gwls_kmax_poles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_list_proj_freq" title="gwls_list_proj_freq" class="md-nav__link">
    gwls_list_proj_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_model_parameter" title="gwls_model_parameter" class="md-nav__link">
    gwls_model_parameter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_n_proj_freq" title="gwls_n_proj_freq" class="md-nav__link">
    gwls_n_proj_freq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_npt_gauss_quad" title="gwls_npt_gauss_quad" class="md-nav__link">
    gwls_npt_gauss_quad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_nseeds" title="gwls_nseeds" class="md-nav__link">
    gwls_nseeds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_print_debug" title="gwls_print_debug" class="md-nav__link">
    gwls_print_debug
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_recycle" title="gwls_recycle" class="md-nav__link">
    gwls_recycle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwls_stern_kmax" title="gwls_stern_kmax" class="md-nav__link">
    gwls_stern_kmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwmem" title="gwmem" class="md-nav__link">
    gwmem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gwrpacorr" title="gwrpacorr" class="md-nav__link">
    gwrpacorr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inclvkb" title="inclvkb" class="md-nav__link">
    inclvkb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc_sigma" title="ixc_sigma" class="md-nav__link">
    ixc_sigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptgw" title="kptgw" class="md-nav__link">
    kptgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mbpt_sciss" title="mbpt_sciss" class="md-nav__link">
    mbpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mdf_epsinf" title="mdf_epsinf" class="md-nav__link">
    mdf_epsinf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandkss" title="nbandkss" class="md-nav__link">
    nbandkss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqim" title="nfreqim" class="md-nav__link">
    nfreqim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqmidm" title="nfreqmidm" class="md-nav__link">
    nfreqmidm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqre" title="nfreqre" class="md-nav__link">
    nfreqre
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfreqsp" title="nfreqsp" class="md-nav__link">
    nfreqsp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkptgw" title="nkptgw" class="md-nav__link">
    nkptgw
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasf" title="nomegasf" class="md-nav__link">
    nomegasf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasi" title="nomegasi" class="md-nav__link">
    nomegasi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomegasrd" title="nomegasrd" class="md-nav__link">
    nomegasrd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npvel" title="npvel" class="md-nav__link">
    npvel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npwkss" title="npwkss" class="md-nav__link">
    npwkss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nqptdm" title="nqptdm" class="md-nav__link">
    nqptdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#omegasimax" title="omegasimax" class="md-nav__link">
    omegasimax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#omegasrdmax" title="omegasrdmax" class="md-nav__link">
    omegasrdmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppmfrq" title="ppmfrq" class="md-nav__link">
    ppmfrq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ppmodel" title="ppmodel" class="md-nav__link">
    ppmodel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pvelmax" title="pvelmax" class="md-nav__link">
    pvelmax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qptdm" title="qptdm" class="md-nav__link">
    qptdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rcut" title="rcut" class="md-nav__link">
    rcut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rhoqpmix" title="rhoqpmix" class="md-nav__link">
    rhoqpmix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_bsum_range" title="sigma_bsum_range" class="md-nav__link">
    sigma_bsum_range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_ngkpt" title="sigma_ngkpt" class="md-nav__link">
    sigma_ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_nshiftk" title="sigma_nshiftk" class="md-nav__link">
    sigma_nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sigma_shiftk" title="sigma_shiftk" class="md-nav__link">
    sigma_shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spbroad" title="spbroad" class="md-nav__link">
    spbroad
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spmeth" title="spmeth" class="md-nav__link">
    spmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symchi" title="symchi" class="md-nav__link">
    symchi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symsigma" title="symsigma" class="md-nav__link">
    symsigma
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa" title="ucrpa" class="md-nav__link">
    ucrpa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa_bands" title="ucrpa_bands" class="md-nav__link">
    ucrpa_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ucrpa_window" title="ucrpa_window" class="md-nav__link">
    ucrpa_window
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vcutgeo" title="vcutgeo" class="md-nav__link">
    vcutgeo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x1rdm" title="x1rdm" class="md-nav__link">
    x1rdm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zcut" title="zcut" class="md-nav__link">
    zcut
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/variables/gw.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="gw-input-variables">gw input variables<a class="headerlink" href="#gw-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
gw input variables to be used in the input file for the abinit executable.</p>
<h2 id="awtr"><strong>awtr</strong><a class="headerlink" href="#awtr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> evaluate the Adler-Wiser expression of <span><span class="MathJax_Preview">\chi^{0}_{KS}</span><script type="math/tex">\chi^{0}_{KS}</script></span> assuming Time-Reversal<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [36/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculations within the PAW formalism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
FCC Argon
QPscGW calculation (only 1 iteration) meant to prepare the following cut3d analysis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor and plasmon-pole model, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
check numerical stability of Chi0 with inclvkb=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>This input variable defines whether the irreducible polarizability
<span><span class="MathJax_Preview">\chi^{0}_{KS}</span><script type="math/tex">\chi^{0}_{KS}</script></span> is evaluated taking advantage of time-reversal symmetry or not.</p>
<ul>
<li>0 &rarr; Use the &ldquo;standard&rdquo; Adler-Wiser expression without assuming time-reversal symmetry.
  In this case, the irreducible polarizability is calculated summing over all possible
  electronic transitions (both resonant and anti-resonant).</li>
<li>1 &rarr; Take advantage of time-reversal symmetry to halve the number of transitions to be explicitly considered.
  This method leads to a decrease in the CPU time by a factor two with respect to the <em>awtr</em> = 0 case.</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that the parallel algorithm <a class="wikilink codevar-wikilink" href="../paral#gwpara">gwpara</a> = 2 is not compatible with the choice <em>awtr</em> = 0.</p>
</div>
<h2 id="bdgw"><strong>bdgw</strong><a class="headerlink" href="#bdgw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanDs for GW calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2,<a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>,<a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [75/1087] in all abinit tests, [12/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="ZPR computation at the Gamma point for MgO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a>, <a class="wikilink abifile-wikilink" data-content="ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_5.abi" target="_blank">teph4zpr_5.abi</a>, <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt nband with the Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_6.abi" target="_blank">teph4zpr_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_3.abi" target="_blank">tgw1_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_4.abi" target="_blank">tgw1_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>For each k-point with number <code>ikptgw</code> in the range (1:<a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>) and each spin
index <code>isppol</code>, <strong>bdgw</strong>(1,<code>ikptgw</code>,<code>isppol</code>) is the number of the lowest band for
which the self-energy computation must be done.
<strong>bdgw</strong>(2,<code>ikptgw</code>,<code>isppol</code>) gives the index of the highest band for which the self-energy computation must be done.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The initial values given in the input file might be changed inside
the code so that all the degenerate states at a given k-point and spin are
included. This might happen when <a class="wikilink codevar-wikilink" href="../gw#symsigma">symsigma</a> = 1 is used or in the case of
self-consistent GW calculations.
When <a class="wikilink codevar-wikilink" href="../gw#symsigma">symsigma</a> == 1, indeed, the diagonal matrix elements of the self-energy are
obtained by averaging the unsymmetrized results in the subspace spanned by the degenerate states.</p>
</div>
<p>When <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> &gt;= 20, the quasi-particle wavefunctions are computed and
represented as linear combination of Kohn-Sham wavefunctions. In this case
<strong>bdgw</strong> designates the range of KS wavefunctions used as basis set. For each
k-point, indeed, the quasi-particle wavefunctions are expanded considering only
the KS states between <strong>bdgw</strong>(1,<code>ikptgw</code>,<code>isppol</code>) and <strong>bdgw</strong>(2,<code>ikptgw</code>,<code>isppol</code>).</p>
<p>For self-consistent calculations, on the other hand, the basis set used to
expand the GW wavefunctions should include all the degenerate states belonging
to the same irreducible representation. Only in this case, indeed, the initial
symmetries and energy degenerations are preserved.</p>
<h2 id="cd_customnimfrqs"><strong>cd_customnimfrqs</strong><a class="headerlink" href="#cd_customnimfrqs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation CUSTOM IMaginary FReQuencieS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> ==3 or <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> ==4) and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,9,12,19,22,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>cd_customnimfrqs</strong>  lets the user define the grid points along the imaginary
axis by hand. Set this to the number of frequencies you want. The frequencies
are specified with <a class="wikilink codevar-wikilink" href="../gw#cd_imfrqs">cd_imfrqs</a>.</p>
<h2 id="cd_frqim_method"><strong>cd_frqim_method</strong><a class="headerlink" href="#cd_frqim_method" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation FReQuency integration on IMaginary axis Method<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> ==4 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p><strong>cd_frqim_method</strong>  defines the choice of integration method along the
imaginary frequency axis for Contour Deformation calculations. The default
method is very robust, fast and optimal for the vast majority of cases.
However, for very accurate (&ldquo;paranoid level&rdquo;) convergence studies, ABINIT
offers the possibility of a variety of methods and grids. Note that as one
starts to change the defaults, one needs to carefully consider the grid used.
Therefore we recommend that in addition to reading the information below, the
user reads the description of the input variables <a class="wikilink codevar-wikilink" href="../gw#freqim_alpha">freqim_alpha</a>,
<a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a>, <a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>, <a class="wikilink codevar-wikilink" href="../gw#gw_frqim_inzgrid">gw_frqim_inzgrid</a>.</p>
<p>The integration to be performed for each matrix element of the self energy
along the imaginary axis is of the form:</p>
<div>
<div class="MathJax_Preview"> \langle i|\Sigma(\omega)|j \rangle  \propto
   \sum_s C_s \int_0^\infty d(i\omega^\prime)
   \frac{(\omega - \epsilon_s)}{(\omega-\epsilon_s)^2 + i{\omega^\prime}^2}
   f(i\omega^\prime),
</div>
<script type="math/tex; mode=display"> \langle i|\Sigma(\omega)|j \rangle  \propto
   \sum_s C_s \int_0^\infty d(i\omega^\prime)
   \frac{(\omega - \epsilon_s)}{(\omega-\epsilon_s)^2 + i{\omega^\prime}^2}
   f(i\omega^\prime),
</script>
</div>
<p>where  <span><span class="MathJax_Preview">\omega</span><script type="math/tex">\omega</script></span> is the frequency point along the real axis, <span><span class="MathJax_Preview">\epsilon_s</span><script type="math/tex">\epsilon_s</script></span> is an
eigenvalue, and  <span><span class="MathJax_Preview">i\omega^\prime</span><script type="math/tex">i\omega^\prime</script></span> is the variable along the imaginary axis. Thus the
function to be integrated is a Lorentzian weight function centred on the
origin (whose FWHM is decided by <span><span class="MathJax_Preview">|\omega-\epsilon_s|</span><script type="math/tex">|\omega-\epsilon_s|</script></span>), times a function. The
function is related to the inverse dielectric matrix. It might have a peaked
structure near the origin and is very smooth otherwise. the function decays
asymptotically as  <span><span class="MathJax_Preview">1/i\omega^\prime</span><script type="math/tex">1/i\omega^\prime</script></span>, so the whole integral converges as this to
the third power.</p>
<ul>
<li><strong>cd_frqim_method = 1 - Histogram:</strong> This is the <strong>default</strong> method where the function  <span><span class="MathJax_Preview">f(i\omega^\prime)</span><script type="math/tex">f(i\omega^\prime)</script></span> is approximated by a histogram, and the Lorentzian is integrated analytically in each sub-interval. See the section on grids below for a description of the default grid. This method combined with the default grid is the fastest and optimised for the use of few points along the imaginary axis.</li>
<li><strong>cd_frqim_method = 2 - Trapezoid:</strong> The next step up from the histogram approximation in the previous method. The integration region is transformed  <span><span class="MathJax_Preview">[0, \infty] \rightarrow [0,1]</span><script type="math/tex">[0, \infty] \rightarrow [0,1]</script></span> with a proper weight depending on the width of the Lorentzian. In this space  <span><span class="MathJax_Preview">f(i\omega^\prime)</span><script type="math/tex">f(i\omega^\prime)</script></span> is approximated by a linear function between grid points (trapezoids), and the integrand is integrated analytically in each sub-interval. This method tends to slightly overestimate contributions while the default method tends to slightly underestimate them, so the results from methods 1 and 2 should bracket the converged values. The asymptotic behaviour is explicitly taken into account by a fit using the last two grid points.</li>
<li><strong>cd_frqim_method = 3, 4, 5 - Natural Spline:</strong> The function is transformed  <span><span class="MathJax_Preview">[0, \infty] \rightarrow [0,1]</span><script type="math/tex">[0, \infty] \rightarrow [0,1]</script></span>. In this space  <span><span class="MathJax_Preview">f(i\omega^\prime)</span><script type="math/tex">f(i\omega^\prime)</script></span> is approximated by a natural spline function whose starting and ending sections are linear. This transform is chosen so that the function should approach a linear function asymptotically as the integration interval approaches 1, so that the asymptotic behaviour is automatically taken into account. For each Lorentzian width (determined by <span><span class="MathJax_Preview">|\omega-\epsilon_s|</span><script type="math/tex">|\omega-\epsilon_s|</script></span>) the integrand is appropriately scaled in the interval <span><span class="MathJax_Preview">[0,1]</span><script type="math/tex">[0,1]</script></span>, and a nested Gauss-Kronrod (GK) numerical integration rule is performed. The integrand is evaluated at the GK nodes by means of a spline-fit. The order of the GK rule is controlled by the index of the method:<ul>
<li>3 &rarr; Gauss 7 point, Kronrod 15 point rule.</li>
<li>4 &rarr; Gauss 11 point, Kronrod 23 point rule.</li>
<li>5 &rarr; Gauss 15 point, Kronrod 31 point rule.
There is rarely any difference to machine precision between these rules, and
the code will issue a warning if a higher-order rule is recommended.</li>
</ul>
</li>
</ul>
<p><strong>Grids for the integral along the imaginary axis:</strong></p>
<p>All the methods above should execute no matter what grid is used along the
imaginary axis, so this is very much under the control of the user. The only
requirement is that the grid be strictly increasing. The point at zero
frequency is assumed to lie on the real axis, so the calculation of that point
is controlled by <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> and corresponding variables. We highly recommend
extracting various elements of the dielectric matrix from the _SCR file using
the <strong>Mrgscr</strong> utility and plotting them for visual inspection.</p>
<ul>
<li><strong>Default</strong> - The default grid is an exponentially increasing grid given by the formula:</li>
</ul>
<div>
<div class="MathJax_Preview"> i\omega^\prime_k = \frac{\omega_p}{\alpha-2}\left[ e^{\frac{2k}{N+1} \ln(\alpha-1)} -1 \right]. </div>
<script type="math/tex; mode=display"> i\omega^\prime_k = \frac{\omega_p}{\alpha-2}\left[ e^{\frac{2k}{N+1} \ln(\alpha-1)} -1 \right]. </script>
</div>
<p>Here  <span><span class="MathJax_Preview">\omega_p</span><script type="math/tex">\omega_p</script></span> is the plasma frequency (by default determined by the average
density of the system, but this can be overridden by setting <a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>).  <span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>
is the total number of grid points (set by <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a>). <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> is a parameter
which determines how far out the final grid point will lie. The final point
will be at  <span><span class="MathJax_Preview">\alpha*\omega_p</span><script type="math/tex">\alpha*\omega_p</script></span> (the default is  <span><span class="MathJax_Preview">\alpha = 5</span><script type="math/tex">\alpha = 5</script></span>, and was hard-coded in
older versions of ABINIT). This grid is designed so that approximately half
the grid points are always distributed to values lower than the plasma
frequency, in order to resolve any peaked structure. If one seeks to increase
the outermost reach by increasing <a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a> one must simultaneously take care
to increase <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a> in order to have the appropriate resolution for the
low-frequency region. In more recent versions of ABINIT one can also simply
adjust the parameter  <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> by using <a class="wikilink codevar-wikilink" href="../gw#freqim_alpha">freqim_alpha</a>. This grid is optimised
for speed and accurate results with few grid points for <strong>cd_frqim_method = 1</strong>.</p>
<ul>
<li><strong>Inverse z transform</strong> - This grid is activated by the use of the variable <a class="wikilink codevar-wikilink" href="../gw#gw_frqim_inzgrid">gw_frqim_inzgrid</a>.
    This is the standard  <span><span class="MathJax_Preview">[0, \infty] \rightarrow [0,1]</span><script type="math/tex">[0, \infty] \rightarrow [0,1]</script></span> transform using the formula:</li>
</ul>
<div>
<div class="MathJax_Preview"> i\omega^\prime = \omega_p \frac{z}{1-z}. </div>
<script type="math/tex; mode=display"> i\omega^\prime = \omega_p \frac{z}{1-z}. </script>
</div>
<p>Here <span><span class="MathJax_Preview">\omega_p</span><script type="math/tex">\omega_p</script></span> is the plasma frequency (default can be overridden by setting
<a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>). The grid points are then picked by an equidistant grid (number of
points set by <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a>) in the interval  <span><span class="MathJax_Preview">z \subset [0,1]</span><script type="math/tex">z \subset [0,1]</script></span>. This grid can
easily be uniquely converged by just increasing <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a>. Again the points
are distributed so that approximately half of them lie below the plasma frequency.</p>
<ul>
<li><strong>User defined</strong> - The user can also define their own grid using the variables <a class="wikilink codevar-wikilink" href="../gw#cd_customnimfrqs">cd_customnimfrqs</a> and <a class="wikilink codevar-wikilink" href="../gw#cd_imfrqs">cd_imfrqs</a>.
    <em>With great power comes great responsibility!</em></li>
</ul>
<p>The <strong>mrgscr</strong> utility is handy in optimising the numerical effort expended in
convergence studies. By estimating the densest grid one can afford to
calculate in the SCR file, and successively removing frequencies from a single
file (using the utility), one only needs to perform the screening calculation
<strong>once</strong> on the dense mesh for a given convergence study. One can also use the
utility to merge independent screening calculations over q-points and frequency sections.</p>
<h2 id="cd_full_grid"><strong>cd_full_grid</strong><a class="headerlink" href="#cd_full_grid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation FULL GRID in complex plane<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>cd_full_grid</strong>  enables the calculation of the screening [both chi0 and
epsilon^(-1)] on a grid in the first quadrant of the complex plane. The grid
is determined by the (tensor) product of the grid in real frequency and the
grid in imaginary frequency. In the SUS and SCR files the grid points are stored as follows:</p>
<div class="codehilite"><pre><span></span><code>  **Index:**
  1   . . .   nfreqre   nfrqre+1 . . . nfreqre+nfreqim   nfreqre+nfreqim+1 . . . nfreqre*nfreqim
  **Entry:**
  | purely real freq.  |     purely imaginary freq.     |      gridpoints in complex plane        |
</code></pre></div>

<p>The grid in the complex plane is stored looping over the real dimension as the
inner loop and the imaginary as the outer loop. The contents of the generated
SUS and SCR files can be extracted for visualisation and further analysis with
the <strong>Mrgscr</strong> utility.</p>
<h2 id="cd_halfway_freq"><strong>cd_halfway_freq</strong><a class="headerlink" href="#cd_halfway_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation tangent grid HALFWAY FREQuency<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 100.0 eV<br />
<em>Only relevant if:</em> (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 or <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4) and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,9,12,19,22,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>cd_halfway_freq</strong>  determines the frequency where half of the number of
points defined in <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> are used up. The tangent transformed grid is
approximately linear up to this point. To be used in conjunction with <a class="wikilink codevar-wikilink" href="../gw#gw_frqre_tangrid">gw_frqre_tangrid</a>.</p>
<h2 id="cd_imfrqs"><strong>cd_imfrqs</strong><a class="headerlink" href="#cd_imfrqs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation IMaginary FReQuencieS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../gw#cd_customnimfrqs">cd_customnimfrqs</a>)<br />
<em>Default value:</em> None<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29] and <a class="wikilink codevar-wikilink" href="../gw#cd_customnimfrqs">cd_customnimfrqs</a> != 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>cd_imfrqs</strong>  specifies the grid points for the imaginary axis. The number of
frequencies is set by the value of <a class="wikilink codevar-wikilink" href="../gw#cd_customnimfrqs">cd_customnimfrqs</a>. For example,</p>
<div class="codehilite"><pre><span></span><code>cd_customnimfrqs   5
nfreqim            5
cd_imfrqs          0.1  0.2  0.5  1.0  5.0
</code></pre></div>

<p>If <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a> is not equal to <a class="wikilink codevar-wikilink" href="../gw#cd_customnimfrqs">cd_customnimfrqs</a> a warning will be issued.</p>
<p><strong>Use at own risk!</strong> The use of a custom grid makes it your responsibility
that the SUS and SCR files are valid in self-energy (i.e. <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4)
calculations, so caution is advised. Note that frequencies have to be strictly
increasing, and the point at zero frequency is <strong>not</strong> considered to be part
of the imaginary grid, but rather the grid along the real axis. The
calculation of that point should be controlled by <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> and related variables.</p>
<h2 id="cd_max_freq"><strong>cd_max_freq</strong><a class="headerlink" href="#cd_max_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation grid MAXimum FREQuency<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1000.0 eV<br />
<em>Only relevant if:</em> (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 or <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4) and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,9,12,19,22,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>cd_max_freq</strong>  determines the frequency where all the points defined in
<a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> are used up. To be used in conjunction with <a class="wikilink codevar-wikilink" href="../gw#gw_frqre_tangrid">gw_frqre_tangrid</a>.</p>
<h2 id="cd_subset_freq"><strong>cd_subset_freq</strong><a class="headerlink" href="#cd_subset_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Contour Deformation grid calculate SUBSET of FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, &lsquo;<a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a>&rsquo;]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29] and  <a class="wikilink codevar-wikilink" href="../gw#gw_frqre_tangrid">gw_frqre_tangrid</a> == 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p><strong>cd_subset_freq</strong>  Specifies that only a subset of the frequencies defined by
<a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> are to be calculated. The first index is the start and the second
the end, with index number 1 always being the origin. For example a
calculation with <strong><a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> = 100</strong> could be separated into two datasets with:</p>
<div class="codehilite"><pre><span></span><code>subset_freq1   1   50
subset_freq2   51  100
</code></pre></div>

<p>Any resulting susceptibility (_SUS) and screening (_SCR) files can then be
merged with the <strong>mrgscr</strong> utility.</p>
<h2 id="ecuteps"><strong>ecuteps</strong><a class="headerlink" href="#ecuteps" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy CUT-off for EPSilon (the dielectric matrix)<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to perform random stopping power calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RandStopPow">topic_RandStopPow</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [96/1087] in all abinit tests, [13/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scHSE06 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scHSE06 level, the Kohn-Sham basis delivers 6.834 eV,
while the plane wave basis delivers 6.850 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivers 7.314 eV,
while the plane wave basis delivers 7.344 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
5.8309 from scHSE06(KS) and 5.8202 from scHSE06(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
At the PBE level, the (KS) band gap was 5.661 eV,
At the scHSE06 level, the Kohn-Sham basis delivered 7.340 eV,
while the plane wave basis delivered 7.341 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivered 7.806 eV,
while the plane wave basis delivered 7.807 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
5.033 from scHSE06(KS) and 5.032 from scHSE06(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.
The pseudopotential includes a non-linear XC core correction." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor and plasmon-pole model, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>ecuteps</strong>  determines the cut-off energy of the planewave set used to
represent the independent-particle susceptibility <span><span class="MathJax_Preview">\chi^{0}_{KS}</span><script type="math/tex">\chi^{0}_{KS}</script></span>, the
dielectric matrix <span><span class="MathJax_Preview">\epsilon</span><script type="math/tex">\epsilon</script></span>, and its inverse.
It is not worth to take  <strong>ecuteps</strong>  bigger than four times <a class="wikilink codevar-wikilink" href="../gw#ecutwfn">ecutwfn</a>, this
latter limit corresponding to the highest Fourier components of a wavefunction
convoluted with itself. Usually, even twice the value of <a class="wikilink codevar-wikilink" href="../gw#ecutwfn">ecutwfn</a> might
overkill. A value of  <strong>ecuteps</strong>  between 5 and 10 Hartree often (but not
always) leads to converged results (at the level of 0.01 eV for the energy
gap). In any case, a convergence study is worth.</p>
<h2 id="ecutsigx"><strong>ecutsigx</strong><a class="headerlink" href="#ecutsigx" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy CUT-off for SIGma eXchange<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [80/1087] in all abinit tests, [8/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_3.abi" target="_blank">tgw1_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_4.abi" target="_blank">tgw1_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor and plasmon-pole model, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t92.abi" target="_blank">t92.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>ecutsigx</strong>  determines the cut-off energy of the planewave set used to
generate the exchange part of the self-energy operator. For norm-conserving
calculations, it is pointless to have  <strong>ecutsigx</strong>  bigger than 4*<a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a>,
while for PAW calculations, the maximal useful value is <a class="wikilink codevar-wikilink" href="../paw#pawecutdg">pawecutdg</a>. Thus,
if you do not care about CPU time, please use these values. If you want to
spare some CPU time, you might try to use a value between <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> and these upper limits.</p>
<h2 id="ecutwfn"><strong>ecutwfn</strong><a class="headerlink" href="#ecutwfn" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy CUT-off for WaveFunctioNs<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> if <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4],
0.0 otherwise.</p>
<p><em>Only relevant if:</em>  <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [87/1087] in all abinit tests, [7/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
check numerical stability of Chi0 with inclvkb=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>ecutwfn</strong>  determines the cut-off energy of the planewave set used to
represent the wavefunctions in the formula that generates the independent-
particle susceptibility <span><span class="MathJax_Preview">\chi^{0}_{KS}</span><script type="math/tex">\chi^{0}_{KS}</script></span> (for <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3), or the self-
energy (for <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4).
Usually,  <strong>ecutwfn</strong>  is smaller than <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a>, so that the wavefunctions are
filtered, and some components are ignored. As a side effect, the wavefunctions
are no more normalized, and also, no more orthogonal. Also, the set of plane
waves can be much smaller for <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3, than for <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4,
although a convergence study is needed to choose correctly both values.</p>
<p>The size of this set of planewaves is <a class="wikilink codevar-wikilink" href="../internal#npwwfn">%npwwfn</a>.</p>
<h2 id="fftgw"><strong>fftgw</strong><a class="headerlink" href="#fftgw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FFT for GW calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 21<br />
<em>Only relevant if:</em>  <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [14/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculations within the PAW formalism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
To check a G0W0+spin calculation with AFM symmetries (same as test t63 but only spin up
wavefunctions, non-symmorphic symmetries are obviously included)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Extrapolar approximation for GW calculations on metals. Norm-conserving.
PRB 78, 085125 (2008)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t72.abi" target="_blank">t72.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a></li>
</ul>
</details>
<p>The basic ingredients needed to perform both a screening and a sigma
calculation are the so-called oscillator matrix elements defined as</p>
<div>
<div class="MathJax_Preview"> \langle \mathbf{k-q},b_1 | e^{-i (\mathbf{q+G)} \mathbf{r}} | \mathbf{k}, b_2 \rangle </div>
<script type="math/tex; mode=display"> \langle \mathbf{k-q},b_1 | e^{-i (\mathbf{q+G)} \mathbf{r}} | \mathbf{k}, b_2 \rangle </script>
</div>
<p>In reciprocal space, this expression is evaluated by a convolution in which
the number of reciprocal lattice vectors employed to describe the
wavefunctions is given by <a class="wikilink codevar-wikilink" href="../gw#ecutwfn">ecutwfn</a>. In the case of screening calculations,
the number of <strong>G</strong> vectors in the above expression is defined by <a class="wikilink codevar-wikilink" href="../gw#ecuteps">ecuteps</a>,
while <a class="wikilink codevar-wikilink" href="../gw#ecutsigx">ecutsigx</a> defined the number of <strong>G</strong> used in sigma calculations. To
improve the efficiency of the code, the oscillator matrix elements are
evaluated in real space through FFT techniques, and the  <strong>fftgw</strong>  input
variable is used to select the FFT mesh to be used.</p>
<p><strong>fftgw</strong>  is the concatenation of two digits, labelled (A) and (B) whose value
is internally used to define the value of <a class="wikilink codevar-wikilink" href="../gstate#ngfft">ngfft</a>(1:3) (see the setmesh.F90 routine).</p>
<p>The first digit (A) defines the augmentation of the FFT grid. Possible values are 1, 2 and 3.</p>
<ul>
<li>0 &rarr; Use the FFT grid specified by the user through <a class="wikilink codevar-wikilink" href="../gstate#ngfft">ngfft</a>(1:3)</li>
<li>1 &rarr; Use a coarse FFT grid which encloses a sphere in reciprocal space whose radius
    depends on the largest value between <a class="wikilink codevar-wikilink" href="../gw#ecutwfn">ecutwfn</a> and <a class="wikilink codevar-wikilink" href="../gw#ecuteps">ecuteps</a></li>
<li>2 &rarr; Use a slightly augmented FFT which is sufficient for the correct treatment of the convolution</li>
<li>3 &rarr; Doubled FFT grid (same mesh as that used for GS calculations).</li>
</ul>
<p>The second digit (B) can be chosen between 0 and 1. It defines whether a FFT
grid compatible with all the symmetries of the space group must be enforced or not:</p>
<ul>
<li>0 &rarr; Use the smallest FFT mesh which is compatible with the FFT library (faster, save memory but is less accurate)</li>
<li>1 &rarr; Enforce a FFT grid which is compatible with all the symmetry operations of the space group.
    This method leads to an increase both of CPU time and memory, but the matrix elements are more accurate
    since the symmetry properties of the system are preserved.</li>
</ul>
<p>The behaviour of ABINIT before v5.5 corresponds to the default value 11.</p>
<h2 id="freqim_alpha"><strong>freqim_alpha</strong><a class="headerlink" href="#freqim_alpha" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREQuencies along the IMaginary axis ALPHA parameter<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p><strong>freqim_alpha</strong>  is used only for numerical integration of the GW self-energy
(<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in  [2, 12, 22, 9, 19, 29]).
 <strong>freqim_alpha</strong>  determines the location of the maximum frequency point along
the imaginary axis if the default grid is used in Contour Deformation
(numerical integration) calculations. It is set as  <span><span class="MathJax_Preview">\alpha*\omega_p</span><script type="math/tex">\alpha*\omega_p</script></span>, where <span><span class="MathJax_Preview">\omega_p</span><script type="math/tex">\omega_p</script></span>
is the plasma frequency determined by the average density of the system
(this can be set by hand by using the variable <a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>). See the section on
grids in the descriptive text for <a class="wikilink codevar-wikilink" href="../gw#cd_frqim_method">cd_frqim_method</a> for a detailed</p>
<h2 id="freqremax"><strong>freqremax</strong><a class="headerlink" href="#freqremax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREQuencies along the Real axis MAXimum<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
create the screening file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_2.abi" target="_blank">tgw2_2.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Hilbert transform for chi0. Use nfreqre and freqremin, freqremax to split
the calculation along the real axis. The SCR files produced in dataset 3 and 4
are then merged my mrgscr in the next test." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a></li>
</ul>
</details>
<p><strong>freqremax</strong>  is used only for numerical integration of the GW self-energy
(<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in  [2, 12, 22, 9, 19, 29]).
 <strong>freqremax</strong>  sets the maximum real frequency used to calculate the dielectric
matrix in order to perform the numerical integration of the GW self-energy.
 <strong>freqremax</strong> , <a class="wikilink codevar-wikilink" href="../gw#freqremin">freqremin</a> and <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> define the spacing of the frequency mesh along the real axis.</p>
<h2 id="freqremin"><strong>freqremin</strong><a class="headerlink" href="#freqremin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREQuencies along the Real axis MINimum<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
LiF. Hilbert transform for chi0. Use nfreqre and freqremin, freqremax to split
the calculation along the real axis. The SCR files produced in dataset 3 and 4
are then merged my mrgscr in the next test." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a></li>
</ul>
</details>
<p><strong>freqremin</strong>  is used only for numerical integration of the GW self-energy
(<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in  [2, 12, 22, 9, 19, 29]).
 <strong>freqremin</strong>  sets the minimum real frequency used to calculate the dielectric
matrix in order to perform the numerical integration of the GW self-energy.
 <strong>freqremin</strong>  can be used to split a wide frequency interval into smaller
subintervals that can be calculated independently. The different subintervals
can then be merged together with the <strong>mrgscr</strong> utility thus obtaining a
single screening file that can used for self-energy calculations. Note that
<a class="wikilink codevar-wikilink" href="../gw#freqremax">freqremax</a>,  <strong>freqremin</strong>  and <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> define the spacing of the
frequency mesh along the real axis.</p>
<h2 id="freqspmax"><strong>freqspmax</strong><a class="headerlink" href="#freqspmax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREQuencies for the SPectral function MAXimum<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [12/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt q-sampling with Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_8.abi" target="_blank">teph4zpr_8.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum : perform the GW calculation
at the bottom of the valence band
Obtain the corresponding spectral function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_4.abi" target="_blank">tgw2_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t60.abi" target="_blank">t60.abi</a></li>
</ul>
</details>
<p><strong>freqspmax</strong>  sets the maximum real frequency used to calculate the spectral
function from the GW Green&rsquo;s function. <a class="wikilink codevar-wikilink" href="../gw#freqspmin">freqspmin</a>,  <strong>freqspmax</strong>  and
<a class="wikilink codevar-wikilink" href="../gw#nfreqsp">nfreqsp</a> define the spacing of an equidistant frequency mesh along the real
axis. Alternatively, the variables <a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a> and <a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a> can
be used to make a user-defined grid.</p>
<h2 id="freqspmin"><strong>freqspmin</strong><a class="headerlink" href="#freqspmin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FREQuencies for the SPectral function MINimum<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -<a class="wikilink codevar-wikilink" href="../gw#freqspmax">freqspmax</a><br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p><strong>freqspmin</strong>  sets the minimum real frequency used to calculate the spectral
function from the GW Green&rsquo;s function.  <strong>freqspmin</strong>  is set to -<a class="wikilink codevar-wikilink" href="../gw#freqspmax">freqspmax</a>
if left undefined.  <strong>freqspmin</strong> , <a class="wikilink codevar-wikilink" href="../gw#freqspmax">freqspmax</a>, and <a class="wikilink codevar-wikilink" href="../gw#nfreqsp">nfreqsp</a> define the
spacing of an equidistant frequency mesh along the real axis. Alternatively,
the variables <a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a> and <a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a> can be used to make a user-defined grid.</p>
<h2 id="gw1rdm"><strong>gw1rdm</strong><a class="headerlink" href="#gw1rdm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW 1-Reduced Density Matrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> 9.4.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW 1RDM update BUT using only Sigma_X (not including Sigma_c term)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<p><strong>gw1rdm</strong>  governs the calculation of the density matrix within the linearized GW approximation.
It must be used with <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a>=21.</p>
<div class="codehilite"><pre><span></span><code><span class="o">*</span><span class="w">  </span><span class="o">**</span><span class="n">gw1rdm</span><span class="o">**</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="n">matrix</span><span class="p">.</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="o">**</span><span class="n">gw1rdm</span><span class="o">**</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="k">Compute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="n">point</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="o">[</span><span class="n">[kptgw</span><span class="o">]</span><span class="err">]</span><span class="p">.</span><span class="w"> </span>
<span class="o">*</span><span class="w">  </span><span class="o">**</span><span class="n">gw1rdm</span><span class="o">**</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="n">Same</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="k">compute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Fock</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">energies</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<h2 id="gw_customnfreqsp"><strong>gw_customnfreqsp</strong><a class="headerlink" href="#gw_customnfreqsp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW CUSTOM FREQuencies for SPectral function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p><strong>gw_customnfreqsp</strong>  lets the user define the grid points along the real
frequency axis by hand for the calculation of the self-energy along the real
axis. Set this to the number of frequencies you want. The frequencies are specified with <a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a>.</p>
<h2 id="gw_freqsp"><strong>gw_freqsp</strong><a class="headerlink" href="#gw_freqsp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW SPectral FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a>)<br />
<em>Default value:</em> [ {&lsquo;start&rsquo;: 1, &lsquo;stop&rsquo;: &lsquo;<a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a>&rsquo;}; -&gt;<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4 and <a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p><strong>gw_freqsp</strong>  specifies the grid points for the real frequency axis when the
real and imaginary (spectral function) parts of sigma are calculated explicitly
for post-processing or plotting. Only activated if <a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a> is not
equal to 0. The number of frequencies is set by the value of
<a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a>. Example:</p>
<div class="codehilite"><pre><span></span><code>gw_customnfreqsp   5
nfreqsp            5
gw_freqsp         -0.5  -0.1  0.0  1.0  10.0 eV
</code></pre></div>

<p>If <a class="wikilink codevar-wikilink" href="../gw#nfreqsp">nfreqsp</a> is not equal to <a class="wikilink codevar-wikilink" href="../gw#gw_customnfreqsp">gw_customnfreqsp</a> a warning will be issued.</p>
<h2 id="gw_frqim_inzgrid"><strong>gw_frqim_inzgrid</strong><a class="headerlink" href="#gw_frqim_inzgrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Contour Deformation FReQuencies on IMaginary axis Inverse Z Grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4] and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p><strong>gw_frqim_inzgrid</strong>  creates grid points along the <strong>imaginary</strong> frequency axis
by using an equidistant grid in the variable  <span><span class="MathJax_Preview">z \subset [0,1]</span><script type="math/tex">z \subset [0,1]</script></span> where the transform
is:</p>
<div>
<div class="MathJax_Preview"> i\omega^\prime = w_p \frac{z}{1-z}. </div>
<script type="math/tex; mode=display"> i\omega^\prime = w_p \frac{z}{1-z}. </script>
</div>
<p>Here  <span><span class="MathJax_Preview">\omega_p</span><script type="math/tex">\omega_p</script></span> is the plasma frequency (default can be overridden by setting
<a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>). The equidistant grid in z is determined uniquely by <a class="wikilink codevar-wikilink" href="../gw#nfreqim">nfreqim</a>)
and the points are distributed so that half of them lie below the plasma frequency.</p>
<h2 id="gw_frqre_inzgrid"><strong>gw_frqre_inzgrid</strong><a class="headerlink" href="#gw_frqre_inzgrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Contour Deformation FReQuencies on REal axis Inverse Z Grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4] and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2, 9, 12, 19, 22, 29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p><strong>gw_frqre_inzgrid</strong>  creates grid points along the <strong>real</strong> frequency axis by
using an equidistant grid in the variable  <span><span class="MathJax_Preview">z \subset [0, 1]</span><script type="math/tex">z \subset [0, 1]</script></span> where the transform is:</p>
<div>
<div class="MathJax_Preview"> \omega = \omega_p \frac{z}{1-z}. </div>
<script type="math/tex; mode=display"> \omega = \omega_p \frac{z}{1-z}. </script>
</div>
<p>Here <span><span class="MathJax_Preview">\omega_p</span><script type="math/tex">\omega_p</script></span> is the plasma frequency (default can be overridden by setting
<a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>). The equidistant grid in z is determined uniquely by <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a> )
and the points are distributed so that half of them lie below the plasma
frequency. This is useful in conjunction with <a class="wikilink codevar-wikilink" href="../gw#gw_frqim_inzgrid">gw_frqim_inzgrid</a> if one needs
to use a grid which maps <span><span class="MathJax_Preview">[0, \infty] \rightarrow [0,1]</span><script type="math/tex">[0, \infty] \rightarrow [0,1]</script></span>. Note that typically <em>many</em> more
points are needed along the real axis in order to properly resolve peak
structures. In contrast, both the screening and self-energy are very smooth
along the imaginary axis. Also, please note that this is <strong>not</strong> an efficient
grid for <strong>standard</strong> Contour Deformation calculations, where typically only a
smaller range of frequencies near the origin is required. The maximum value
needed along the real frequency axis is output in the logfile during Contour
Deformation sigma calculations.</p>
<h2 id="gw_frqre_tangrid"><strong>gw_frqre_tangrid</strong><a class="headerlink" href="#gw_frqre_tangrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Contour Deformation FReQencies on REal axis - Use Tangent Grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4] and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,9,12,19,22,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a></li>
</ul>
</details>
<p><strong>gw_frqre_tangrid</strong>  defines a nonuniform grid to be used in frequency, with
stepsize increasing proportional to <span><span class="MathJax_Preview">\tan(x)</span><script type="math/tex">\tan(x)</script></span>. This makes the grid approximately
linear to start with, with a rapid increase towards the end. Also, this is the
grid which gives equal importance to each point used in the integration of a
function which decays as <span><span class="MathJax_Preview">1/x^2</span><script type="math/tex">1/x^2</script></span>. To be used in conjunction with <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a>,
<a class="wikilink codevar-wikilink" href="../gw#cd_max_freq">cd_max_freq</a> and <a class="wikilink codevar-wikilink" href="../gw#cd_halfway_freq">cd_halfway_freq</a> which determine the parameters of the transformed grid.</p>
<h2 id="gw_icutcoul"><strong>gw_icutcoul</strong><a class="headerlink" href="#gw_icutcoul" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW CUT-off for COULomb interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Coulomb">topic_Coulomb</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 6<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> 9.1  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [67/1087] in all abinit tests, [4/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scHSE06 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scHSE06 level, the Kohn-Sham basis delivers 6.834 eV,
while the plane wave basis delivers 6.850 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivers 7.314 eV,
while the plane wave basis delivers 7.344 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
5.8309 from scHSE06(KS) and 5.8202 from scHSE06(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
At the PBE level, the (KS) band gap was 5.661 eV,
At the scHSE06 level, the Kohn-Sham basis delivered 7.340 eV,
while the plane wave basis delivered 7.341 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivered 7.806 eV,
while the plane wave basis delivered 7.807 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
5.033 from scHSE06(KS) and 5.032 from scHSE06(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.
The pseudopotential includes a non-linear XC core correction." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: convergence in ecuteps" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_4.abi" target="_blank">tbs_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>Many-body calculations for fully periodic systems are problematic due to the
presence of the integrable Coulomb singularity at <span><span class="MathJax_Preview">\mathbf{G}=0</span><script type="math/tex">\mathbf{G}=0</script></span> that hinders
the convergence with respect to the number of q-points used to sample the
Brillouin zone. The convergence can be accelerated by integrating accurately
the zone in the neighborhood of <span><span class="MathJax_Preview">\mathbf{G}=0</span><script type="math/tex">\mathbf{G}=0</script></span>.</p>
<p><strong>gw_icutcoul</strong>  defines the particular expression to be used for such integration.
It can be used in conjunction with its equivalent for the ground state electronic
structure cut-off <a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a>.</p>
<ul>
<li>0 &rarr; sphere (molecules, but also 3D-crystals, see below).</li>
<li>1 &rarr; cylinder (nanowires, nanotubes).</li>
<li>2 &rarr; surface.</li>
<li>3 &rarr; Integration in a spherical mini-Brillouin Zone, legacy value.</li>
<li>4 &rarr; ERF, long-range only Coulomb interaction.</li>
<li>5 &rarr; ERFC, short-range only Coulomb interaction (e.g. as used in the HSE functional).</li>
<li>6 &rarr; auxiliary function integration for 3D systems from <a class="wikilink citation-wikilink" data-content="General treatment of the singularities in Hartree-Fock and exact-exchange Kohn-Sham methods for solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#carrier2007">[Carrier2007]</a>.</li>
<li>7 &rarr; auxiliary function for 3D systems of Gygi and Baldereschi <a class="wikilink citation-wikilink" data-content="Self-consistent Hartree-Fock and screened-exchange calculations in solids: Application to silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gygi1986">[Gygi1986]</a>.</li>
<li>14 &rarr; Monte-Carlo integration in the mini-Brillouin zone for ERF, long-range only Coulomb interaction.</li>
<li>15 &rarr; Monte-Carlo integration in the mini-Brillouin zone for ERFC, short-range only Coulomb interaction.</li>
<li>16 &rarr; Monte-Carlo integration in the mini-Brillouin zone for Full Coulomb interaction.</li>
</ul>
<h2 id="gw_invalid_freq"><strong>gw_invalid_freq</strong><a class="headerlink" href="#gw_invalid_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW treatment of INVALID FREQuency for Hybertsen-Louie PPM<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4] and <a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a> in [2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
TiO2
GW calculations with PPM-HL treating invalid frequencies in different ways." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t41.abi" target="_blank">t41.abi</a></li>
</ul>
</details>
<p><strong>gw_invalid_freq</strong>  sets the procedure to follow when a PPM frequency is
invalid (negative or imaginary).</p>
<ul>
<li><strong>gw_invalid_freq</strong>  = 0: Drop them as proposed in Appendix B of <a class="wikilink citation-wikilink" data-content="Electron correlation in semiconductors and insulators: Band gaps and quasiparticle energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#hybertsen1986">[Hybertsen1986]</a>.</li>
<li><strong>gw_invalid_freq</strong>  = 1: Set them to 1 hartree, as done for the PPM of Godby-Needs <a class="wikilink citation-wikilink" data-content="Metal-insulator transition in Kohn-Sham theory and quasiparticle theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#godby1989">[Godby1989]</a>.</li>
<li><strong>gw_invalid_freq</strong>  = 2: Set them to infinity.</li>
</ul>
<h2 id="gw_nqlwl"><strong>gw_nqlwl</strong><a class="headerlink" href="#gw_nqlwl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW, Number of Q-points for the Long Wave-Length Limit<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BSE">topic_BSE</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4,99]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>Only relevant if <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3,4,99 that is, screening, sigma or Bethe-
Salpeter calculations, although the actual meaning of the variable depends on
the particular run-level (see discussion below).</p>
<p><strong>gw_nqlwl</strong>  defines the number of directions in reciprocal space used to
describe the non-analytical behaviour of the heads (<span><span class="MathJax_Preview">G = G'=0</span><script type="math/tex">G = G'=0</script></span>) and the wings
(<span><span class="MathJax_Preview">G=0</span><script type="math/tex">G=0</script></span> or <span><span class="MathJax_Preview">G'=0</span><script type="math/tex">G'=0</script></span>) of the dielectric matrix in the optical limit (i.e. for <span><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span>
tending to zero). The number of directions is specified by the additional
variable <a class="wikilink codevar-wikilink" href="../gw#gw_qlwl">gw_qlwl</a>.</p>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3,  <strong>gw_nqlwl</strong>  and <strong>gw_qlwl</strong> define the set of &ldquo;small&rdquo; <span><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span>
that will be calculated and stored in the final SCR file. Therefore, the two
variables can be used to analyze how the optical spectra depend on the
direction of the incident phonon (useful especially in anisotropic systems).</p>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4,  <strong>gw_nqlwl</strong>  and <strong>gw_qlwl</strong> can be used to specify the
heads and the wings to be used to perform the quadrature of the correlated
part of the self-energy in the small region around the origin. (NB: not yet
available, at present the quadrature is performed using a single direction in
q-space)</p>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 99,  <strong>gw_nqlwl</strong>  and <strong>gw_qlwl</strong> define the set of
directions in q-space along which the macroscopic dielectric function is
evaluated. By default the Bethe-Salpeter code calculates the macroscopic
dielectric function using six different directions in q-space (the three basis
vectors of the reciprocal lattice and the three Cartesian axis).</p>
<h2 id="gw_nstep"><strong>gw_nstep</strong><a class="headerlink" href="#gw_nstep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Number of self-consistent STEPs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 30<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 8<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p>Gives the maximum number of self-consistent GW cycles (or &ldquo;iterations&rdquo;) in
which G and/or W will be updated until the quasi-particle energies are
converged within <a class="wikilink codevar-wikilink" href="../gw#gw_toldfeig">gw_toldfeig</a>. <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> and <a class="wikilink codevar-wikilink" href="../gw#gw_sctype">gw_sctype</a> are used to
define the type of self-consistency.</p>
<h2 id="gw_qlwl"><strong>gw_qlwl</strong><a class="headerlink" href="#gw_qlwl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW, Q-points for the Long Wave-Length limit<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a>, <a class="wikilink topic-wikilink" data-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BSE">topic_BSE</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../gw#gw_nqlwl">gw_nqlwl</a>)<br />
<em>Default value:</em> [1e-05, 2e-05, 3e-05]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4,99]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3,  <strong>gw_qlwl</strong>  defines the set of q-points around Gamma
that are considered during the evaluation of the non-analytical behaviour of
the dielectric matrix. Optical spectra (with and without non-local field
effects) are evaluated for each direction specified by  <strong>gw_qlwl</strong> .</p>
<h2 id="gw_qprange"><strong>gw_qprange</strong><a class="headerlink" href="#gw_qprange" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW QuasiParticle RANGE policy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scHSE06 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scHSE06 level, the Kohn-Sham basis delivers 6.834 eV,
while the plane wave basis delivers 6.850 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivers 7.314 eV,
while the plane wave basis delivers 7.344 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
5.8309 from scHSE06(KS) and 5.8202 from scHSE06(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
At the PBE level, the (KS) band gap was 5.661 eV,
At the scHSE06 level, the Kohn-Sham basis delivered 7.340 eV,
while the plane wave basis delivered 7.341 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivered 7.806 eV,
while the plane wave basis delivered 7.807 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
5.033 from scHSE06(KS) and 5.032 from scHSE06(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.
The pseudopotential includes a non-linear XC core correction." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t45.abi" target="_blank">t45.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Use of the tetrahedron method for the electron linewidth" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t54.abi" target="_blank">t54.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Use of the two-grids technique" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t60.abi" target="_blank">t60.abi</a></li>
</ul>
</details>
<p><strong>gw_qprange</strong>  is active only when <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a> is equal to zero (default
value). This variable simplifies the specification of the list of kpoints and
of the bands to be used for the computation of the quasi-particle corrections.
The possible values are:</p>
<ul>
<li>0 &rarr; Compute the QP corrections only for the fundamental and the optical gap</li>
<li>+num &rarr; Compute the QP corrections for all the k-points in the irreducible zone,
     and include <code>num</code> bands above and below the Fermi level.</li>
<li>-num &rarr; Compute the QP corrections for all the k-points in the irreducible zone.
     Include all occupied states and <code>num</code> empty states.</li>
</ul>
<p>The default value is 0 and is very handy for one-shot calculations. It is
important to stress, however, that the position of the optical/fundamental
gaps is deduced from the energies computed on the k-mesh used for the WFK
file. Therefore the computed gaps might differ from the correct ones that can
only be obtained with an appropriate sampling of the irreducible zone.
Positive values are useful if we do not know the position of the GW HOMO, LOMO
and we want to investigate the effect of the GW corrections on the states
close to the gap Negative values are usually used for self-consistent
calculations Note that, in the case of self-consistency or <a class="wikilink codevar-wikilink" href="../gw#symsigma">symsigma</a> == 1, the
code might change the bands range so that all the degenerate states are
included. Note also that <a class="wikilink codevar-wikilink" href="../gw#kptgw">kptgw</a>, and <a class="wikilink codevar-wikilink" href="../gw#bdgw">bdgw</a> are ignored when this options
is used. If you want to select manually the list of k-points and bands, you
have to provide the three variables <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>, <a class="wikilink codevar-wikilink" href="../gw#kptgw">kptgw</a>, and <a class="wikilink codevar-wikilink" href="../gw#bdgw">bdgw</a>.</p>
<h2 id="gw_sctype"><strong>gw_sctype</strong><a class="headerlink" href="#gw_sctype" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW, Self-Consistency TYPE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p>This variable is used to partially define the kind of self-consistency for GW
calculations. The other piece of information is given by <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> that
defines the particular approximation for the self-energy operator as well as
whether the wavefunctions have to replaced by quasi-particle amplitudes.</p>
<p>If  <strong>gw_sctype</strong>  is specified in the input file, the code will perform an
iterative update of the quantities entering the GW equations until the quasi-
particle energies are converged within <a class="wikilink codevar-wikilink" href="../gw#gw_toldfeig">gw_toldfeig</a>. The maximum number of
iterations is specified by <a class="wikilink codevar-wikilink" href="../gw#gw_nstep">gw_nstep</a>. Possible values are:</p>
<ul>
<li>1 &rarr; standard one-shot method (one screening calculation followed by a single sigma run)</li>
<li>2 &rarr; self-consistency only on W (iterative update of W followed by a sigma run in which G is approximated with the Kohn-Sham independent-particle Green&rsquo;s function G0)</li>
<li>3 &rarr; self-consistency only of G (a single screening calculation to obtain the Kohn-Sham polarizability followed by an iterative update of the Green&rsquo;s functions in the self-energy)</li>
<li>4 &rarr; fully self-consistent algorithm (iterative update of both G and W)</li>
</ul>
<p>It is possible to initialize the self-consistent procedure by reading a
previously calculated SCR or SUSC file via the variables <a class="wikilink codevar-wikilink" href="../files#getscr">getscr</a> or
<a class="wikilink codevar-wikilink" href="../files#getsuscep">getsuscep</a>, respectively. <a class="wikilink codevar-wikilink" href="../files#getqps">getqps</a> can be used to read a previous QPS
file thus initializing the Green functions to be used in the first self-
consistent iteration.</p>
<h2 id="gw_sigxcore"><strong>gw_sigxcore</strong><a class="headerlink" href="#gw_sigxcore" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW, SIGma (self-energy) for the CORE contribution<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4 and <a class="wikilink codevar-wikilink" href="../internal#usepaw">%usepaw</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculations within the PAW formalism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t66.abi" target="_blank">t66.abi</a></li>
</ul>
</details>
<p>Only available for PAW and relevant if <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4 that is, sigma
calculations.</p>
<p>Theoretical introduction: GW calculations performed on top of electronic
calculations relying when the frozen-core approximation is used to separate
inner-core electrons from valence electrons, only the contribution to the
self-energy arising from valence electrons is explicitly accounted for. In the
standard approach based on pseudopotentials the contribution to the self-
energy due to core electrons is approximated by means of the KS exchange-
correlation potential generated by the core density. In the case of GW
calculations employing the PAW method, the core contribution to the self-
energy can be more accurately estimated in terms of the Fock operator
generated by the core wavefunctions. In the simplest approach, the only
ingredients required for this more refined treatment are the wave functions of
the core electrons in the reference atomic configuration that are calculated
during the generation of the PAW setup. This is a good approximation provided
that the core wave functions are strictly localized inside the PAW spheres.</p>
<p><strong>gw_sigxcore</strong>  defines the approximation used to evaluate the core
contribution to sigma.</p>
<ul>
<li><strong>gw_sigxcore</strong>  = 0, standard approach, the core contribution is approximated with vxc.</li>
<li><strong>gw_sigxcore</strong>  = 1, the core term is approximated with the Fock operator inside the PAW spheres.</li>
</ul>
<h2 id="gw_toldfeig"><strong>gw_toldfeig</strong><a class="headerlink" href="#gw_toldfeig" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW TOLerance on the DiFference of the EIGenvalues<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1 eV<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 8<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p>Sets a tolerance for absolute differences of QP energies that will cause one
self-consistent GW cycle to stop.
Can be specified in Ha (the default), Ry, eV or Kelvin, since <strong>toldfe</strong> has
the <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a> characteristics (1 Ha = 27.2113845 eV)</p>
<h2 id="gwaclowrank"><strong>gwaclowrank</strong><a class="headerlink" href="#gwaclowrank" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Analytic Continuation LOW RANK approximation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> 9.2.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a></li>
</ul>
</details>
<p><strong>gwaclowrank</strong> governs the number of eigenvectors of epsm1(iw&rsquo;) that will be retained in the calculation.
The default value <strong>gwaclowrank</strong> = 0 means all eigenvectors are retained and therefore no approximation is made.
<strong>gwaclowrank</strong> is by definition lower than the number of planewaves used for epsm1, which is set by <a class="wikilink codevar-wikilink" href="../internal#npweps">%npweps</a> or indirectly by <a class="wikilink codevar-wikilink" href="../gw#ecuteps">ecuteps</a>.
The lower <strong>gwaclowrank</strong>, the faster the calculation.</p>
<h2 id="gwcalctyp"><strong>gwcalctyp</strong><a class="headerlink" href="#gwcalctyp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW CALCulation TYPe<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a>, <a class="wikilink topic-wikilink" data-content="How to calculate the RPA correlation energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RPACorrEn">topic_RPACorrEn</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [54/1087] in all abinit tests, [5/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
create the screening file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_2.abi" target="_blank">tgw2_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
calculation of the quasi-particle Fermi energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_3.abi" target="_blank">tgw2_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum : perform the GW calculation
at the bottom of the valence band
Obtain the corresponding spectral function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_4.abi" target="_blank">tgw2_4.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
To check a G0W0+spin calculation with AFM symmetries (same as test t63 but only spin up
wavefunctions, non-symmorphic symmetries are obviously included)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the KSS, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>gwcalctyp</strong> governs the choice between the different capabilities of the GW code.</p>
<ul>
<li>0 &lt;= <strong>gwcalctyp</strong> &lt;= 9: standard &ldquo;1 shot&rdquo; quasi-particle method.</li>
<li>10 &lt;= <strong>gwcalctyp</strong> &lt;= 19: self-consistent quasi-particle method on energies only.</li>
<li>
<p>20 &lt;= <strong>gwcalctyp</strong> &lt;= 29: self-consistent quasi-particle method on energies and wavefunctions.</p>
</li>
<li>
<p><strong>gwcalctyp</strong> = 0, 10, or 20: standard Plasmon-Pole model GW calculation.</p>
</li>
<li><strong>gwcalctyp</strong> = 1: GW calculation where the self-energy along the real axis is obtained by performing the analytic continuation from the imaginary axis to the full complex plane via the Pade approximant. Only available for standard &ldquo;1 shot&rdquo; quasi-particle method.</li>
<li><strong>gwcalctyp</strong> = 2, 12, or 22: GW calculation using numerical integration (contour deformation method, see e.g. <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a>).</li>
<li><strong>gwcalctyp</strong> = 5, 15, or 25: Hybrid functional or Hartree-Fock calculation, with the identifier of the functional given by <a class="wikilink codevar-wikilink" href="../gw#ixc_sigma">ixc_sigma</a>. See the latter for the definition of other related variables.</li>
<li><strong>gwcalctyp</strong> = 6, 16, or 26: Screened Exchange calculation.</li>
<li><strong>gwcalctyp</strong> = 7, 17, or 27: COHSEX calculation.</li>
<li><strong>gwcalctyp</strong> = 8, 18, or 28: model GW calculation following <a class="wikilink citation-wikilink" data-content="All-Electron Self-ConsistentGWApproximation: Application to Si, MnO, and NiO" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#faleev2004">[Faleev2004]</a> using a Plasmon-Pole model.</li>
<li><strong>gwcalctyp</strong> = 9, 19, or 29: model GW calculation following <a class="wikilink citation-wikilink" data-content="All-Electron Self-ConsistentGWApproximation: Application to Si, MnO, and NiO" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#faleev2004">[Faleev2004]</a> using numerical integration (contour deformation method).</li>
</ul>
<h2 id="gwcomp"><strong>gwcomp</strong><a class="headerlink" href="#gwcomp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW COMPleteness<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with extrapolar approximation and in-core solution.
Similar to t65, the main difference is that symmetries are used both in chi0 and sigma and also
the extrapolar term is symmetrized. Using a larger G-sphere for wavefunctions wrt t65 in order to
reduce the number of G1-G2 vectors falling outside the &quot;ecutwfn&quot; sphere (see completchi0_deltapart.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Extrapolar approximation for GW calculations on metals. Norm-conserving.
PRB 78, 085125 (2008)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t72.abi" target="_blank">t72.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p><strong>gwcomp</strong>  governs the use of an extrapolar approximation. If  <strong>gwcomp</strong>  == 1,
one improves the completeness in a truncated sum over states. In practice,
this permits one to reduce quite much the number of bands required in the
calculation of the screening or of the self-energy. The energy parameter
needed in the extrapolar approximation is set by <a class="wikilink codevar-wikilink" href="../gw#gwencomp">gwencomp</a>. See
<a class="wikilink citation-wikilink" data-content="Accurate GW self-energies in a plane-wave basis using only a few empty states: Towards large systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2008">[Bruneval2008]</a> for a description of the methodology.</p>
<h2 id="gwencomp"><strong>gwencomp</strong><a class="headerlink" href="#gwencomp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW ENergy for COMPleteness<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4] and <a class="wikilink codevar-wikilink" href="../gw#gwcomp">gwcomp</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [10/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with extrapolar approximation and in-core solution.
Similar to t65, the main difference is that symmetries are used both in chi0 and sigma and also
the extrapolar term is symmetrized. Using a larger G-sphere for wavefunctions wrt t65 in order to
reduce the number of G1-G2 vectors falling outside the &quot;ecutwfn&quot; sphere (see completchi0_deltapart.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Extrapolar approximation for GW calculations on metals. Norm-conserving.
PRB 78, 085125 (2008)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t72.abi" target="_blank">t72.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p><strong>gwencomp</strong>  sets the energy parameter used in the extrapolar approximation
used to improve completeness and make the convergence against the number of
bands much faster.</p>
<p>See <a class="wikilink citation-wikilink" data-content="Accurate GW self-energies in a plane-wave basis using only a few empty states: Towards large systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2008">[Bruneval2008]</a> for a description of the methodology.</p>
<h2 id="gwgamma"><strong>gwgamma</strong><a class="headerlink" href="#gwgamma" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW GAMMA<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3 or 4 (Sigma calculations)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the KSS, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a></li>
</ul>
</details>
<p>If  <strong>gwgamma</strong>  is 1, the vertex correction will be included leading to what is
known as &ldquo;GW-Gamma&rdquo; approximation. see R. Del Sole, L. Reining, and R. W.
Godby, Phys. Rev. B 49, 8024 (1994). Note that, in order to include the vertex
correction in W, one has to start the sigma calculation from the
susceptibility file_SUSC instead of the _SCR file (see <a class="wikilink codevar-wikilink" href="../files#getsuscep">getsuscep</a>   and
<a class="wikilink codevar-wikilink" href="../files#irdsuscep">irdsuscep</a>  ) Not available for PAW calculations.</p>
<p><strong>gwgamma</strong>  = -4 activates the bootstrap kernel of Sharma et al. <a class="wikilink citation-wikilink" data-content="Bootstrap Approximation for the Exchange-Correlation Kernel of Time-Dependent Density-Functional Theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#sharma2011">[Sharma2011]</a>
in the test-charge-test-charge dielectric function <a class="wikilink citation-wikilink" data-content="Accurate band gaps of extended systems via efficient vertex corrections in $GW$" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#chen2015">[Chen2015]</a>.</p>
<p><strong>gwgamma</strong>  = -6 uses the same bootstrap kernel as with  <strong>gwgamma</strong>  = -4
but with only the head of the kernel. As such, the self-consistent iteration in the kernel
can be disregarded <a class="wikilink citation-wikilink" data-content="Ab initio Electronic Structure of Liquid Water" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#chen2016">[Chen2016]</a>.</p>
<p><strong>gwgamma</strong>  = -8 activates the RPA bootstrap-like kernel (one-shot) (see <a class="wikilink citation-wikilink" data-content="Fully Parameter-Free Calculation of Optical Spectra for Insulators, Semiconductors, and Metals from a Simple Polarization Functional" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#berger2015">[Berger2015]</a>
and <a class="wikilink citation-wikilink" data-content="Estimating Excitonic Effects in the Absorption Spectra of Solids: Problems and Insight from a Guided Iteration Scheme" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#rigamonti2015">[Rigamonti2015]</a>).</p>
<h2 id="gwgmcorr"><strong>gwgmcorr</strong><a class="headerlink" href="#gwgmcorr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW Galitskii-Migdal CORRelation energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the RPA correlation energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RPACorrEn">topic_RPACorrEn</a>, <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> 9.4.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a></li>
</ul>
</details>
<p><strong>gwgmcorr</strong> ==1 allows to compute the GW correlation energy with the Galitskii-Migdal (GM) formula.
It must be used with <a class="wikilink codevar-wikilink" href="../gw#gwrpacorr">gwrpacorr</a>&gt;0. For <a class="wikilink codevar-wikilink" href="../gw#gwrpacorr">gwrpacorr</a>=1 it will be obtained for free, while for <a class="wikilink codevar-wikilink" href="../gw#gwrpacorr">gwrpacorr</a>&gt;1 it will require an extra inversion of the polarizability matrix. </p>
<h2 id="gwls_band_index"><strong>gwls_band_index</strong><a class="headerlink" href="#gwls_band_index" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS BAND INDEX<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Governs the DFT eigenstate <span><span class="MathJax_Preview">|e\rangle</span><script type="math/tex">|e\rangle</script></span> in which the self-energy will be evaluated, as
shown in Eq. (7) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>. That is, it is the state
to be corrected in the G0W0 scheme.</p>
<h2 id="gwls_correlation"><strong>gwls_correlation</strong><a class="headerlink" href="#gwls_correlation" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS CORRELATION<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Governs the use of a dielectric model (as explained in Sec. V of
<a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a> and the use of the Lanczos scheme to solve Eqs. (30) and
(35) of the same reference at all external <a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a> and integration (as
generated from <a class="wikilink codevar-wikilink" href="../gw#gwls_npt_gauss_quad">gwls_npt_gauss_quad</a>) frequencies. The different choices
are:</p>
<ul>
<li><strong>gwls_correlation</strong>  == 1: GWLS calculation <strong>with</strong> the dielectric model and <strong>without</strong> the shift Lanczos technique,</li>
<li><strong>gwls_correlation</strong>  == 2: GWLS calculation <strong>without</strong> the dielectric model and <strong>without</strong> the shift Lanczos technique,</li>
<li><strong>gwls_correlation</strong>  == 3: GWLS calculation <strong>with</strong> the dielectric model and <strong>with</strong> the shift Lanczos technique,</li>
<li><strong>gwls_correlation</strong>  == 4: GWLS calculation <strong>without</strong> the dielectric model and <strong>with</strong> the shift Lanczos technique,</li>
<li><strong>gwls_correlation</strong>  == 5: Not a GWLS calculation; just calculate and print the eigenvalues of the (static) dielectric matrix (for debugging purposes).</li>
</ul>
<p>The default, ( <strong>gwls_correlation</strong>  == 3), is the most performant option and
should be kept by the user. Option 1, 2 and 5 are deprecated and will be
removed.</p>
<h2 id="gwls_diel_model"><strong>gwls_diel_model</strong><a class="headerlink" href="#gwls_diel_model" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS dielectric model<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Not used yet.</p>
<h2 id="gwls_exchange"><strong>gwls_exchange</strong><a class="headerlink" href="#gwls_exchange" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS exact EXCHANGE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Governs whether the exact exchange for the state to be corrected
(<a class="wikilink codevar-wikilink" href="../gw#gwls_band_index">gwls_band_index</a>) is calculated ( <strong>gwls_exchange</strong>  == 1) or not
( <strong>gwls_exchange</strong>  = =0).</p>
<h2 id="gwls_first_seed"><strong>gwls_first_seed</strong><a class="headerlink" href="#gwls_first_seed" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS FIRST SEED vector<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="../gw#gwls_band_index">gwls_band_index</a><br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable sets the band index to be used to generate the first seed vector
to be used in the construction of the Lanczos basis for the (static)
dielectric matrix in a GWLS calculation. See Sec. IV of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>.
Together with <a class="wikilink codevar-wikilink" href="../gw#gwls_nseeds">gwls_nseeds</a>, this defines the seeds for the
Lanczos procedure. That is, the states associated to band index
 <strong>gwls_first_seed</strong>  to  <strong>gwls_first_seed</strong> +<a class="wikilink codevar-wikilink" href="../gw#gwls_nseeds">gwls_nseeds</a>-1 are used to
generate the seed vectors.</p>
<p>The default  <strong>gwls_first_seed</strong>  == <a class="wikilink codevar-wikilink" href="../gw#gwls_band_index">gwls_band_index</a> and <a class="wikilink codevar-wikilink" href="../gw#gwls_nseeds">gwls_nseeds</a> == 1
has been thoroughly tested and seems to be the most performant. Users should
therefore keep the default value.</p>
<h2 id="gwls_kmax_analytic"><strong>gwls_kmax_analytic</strong><a class="headerlink" href="#gwls_kmax_analytic" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS KMAX for the ANALYTIC term<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 8<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Governs the number of iterations to be done in the shift Lanczos solution of
Eq. (35) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a> to solve it at all external
frequencies requested by the user (<a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a>). The default value is
converged to a few 10s of meV for all molecules studied so far.</p>
<h2 id="gwls_kmax_complement"><strong>gwls_kmax_complement</strong><a class="headerlink" href="#gwls_kmax_complement" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS KMAX for the COMPLEMENT space.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>The G0W0 formalism involves the calculation of a summation conceptually linked
to the trace of the dielectric matrix [see Eq. (38) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>].
Since the eigenvalues spectrum of the dielectric matrix of formed by a
few large discrete eigenvalues and an integrable divergence in the density of
eigenvalues around 0, it is expensive to sample accurately this divergence
using the exact dielectric operator. It this becomes interesting to calculate
the &lsquo;trace&rsquo; of the &lsquo;exact - model&rsquo; dielectric matrix in a small basis and add
it to the &lsquo;trace&rsquo; of the &lsquo;model&rsquo; dielectric matrix obtained in a large basis.
In the context where the model dielectric matrix is used in the calculations,
<a class="wikilink codevar-wikilink" href="../gw#gwls_stern_kmax">gwls_stern_kmax</a> determines the size of the &lsquo;small&rsquo; basis and
 <strong>gwls_kmax_complement</strong>  determines the size of the &lsquo;large&rsquo; basis.</p>
<p>For more information on the exact role of these bases and on the model
dielectric operator used, see Sec. V of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>.</p>
<h2 id="gwls_kmax_numeric"><strong>gwls_kmax_numeric</strong><a class="headerlink" href="#gwls_kmax_numeric" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS KMAX for the NUMERIC term<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 16<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Governs the number of iterations to be done in the shift Lanczos solution of
Eq. (30) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a> to solve it simultaneously at all
integration frequencies (generated automatically by the number of points
<a class="wikilink codevar-wikilink" href="../gw#gwls_npt_gauss_quad">gwls_npt_gauss_quad</a> to use in the gaussian quadrature) and all external
frequencies requested by the user (<a class="wikilink codevar-wikilink" href="../gw#gw_freqsp">gw_freqsp</a>). The default value is
converged to a few 10s of meV for all molecules studied so far.</p>
<h2 id="gwls_kmax_poles"><strong>gwls_kmax_poles</strong><a class="headerlink" href="#gwls_kmax_poles" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS KMAX for the calculation of the POLES residue<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 4<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>The contour deformation technique, in the G0W0 context, will involve the
calculation of pole residues associated to states lying between the one
corrected (<a class="wikilink codevar-wikilink" href="../gw#gwls_band_index">gwls_band_index</a>) and the Fermi level. These residues take the
form of a matrix element of the inverse dielectric matrix at a real frequency
[see Eq. (11) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>]. Therefore, the dielectric
matrix must be constructed in some basis at these frequencies and inverted to
calculate the matrix element. The present input variable sets the size of the
Lanczos basis to be constructed for this purpose. The default value has proven
to be very robust for many molecular systems and should therefore be left to
the default value by the user.</p>
<p>For more information on the Lanczos basis constructed for the calculation of
the residues, see Sec. IV of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>.</p>
<h2 id="gwls_list_proj_freq"><strong>gwls_list_proj_freq</strong><a class="headerlink" href="#gwls_list_proj_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS LIST of the PROJection FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../gw#gwls_n_proj_freq">gwls_n_proj_freq</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable sets the frequencies to be used to construct the basis in which
the Hamiltonian is projected to accelerate the solution of the Sternheimer
equations involved by the construction of the dielectric matrix at finite
frequencies. See Sec. VI of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>. For most cases,
since the frequencies <span><span class="MathJax_Preview">\infty</span><script type="math/tex">\infty</script></span> and 0.0 (if <a class="wikilink codevar-wikilink" href="../gw#gwls_recycle">gwls_recycle</a> &gt; 0) are used at no
computational cost, <a class="wikilink codevar-wikilink" href="../gw#gwls_n_proj_freq">gwls_n_proj_freq</a> == 0 (which means no ADDITIONAL
frequency is to be used) is fine and no frequencies need to be picked up.</p>
<h2 id="gwls_model_parameter"><strong>gwls_model_parameter</strong><a class="headerlink" href="#gwls_model_parameter" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS MODEL PARAMETER<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This is the width of the lorentzian, in Ha, used to model the frequency
dependence of the dielectric matrix in the GWLS calculation [see Eqs. (12-16)
and (34) of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>]. More
precisely, this parameter is the value of <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> used in Eq. (34). This model
is then used to separate the integration over frequencies into a &lsquo;model&rsquo; part
[second term of Eq. (12)] and an &lsquo;exact - model&rsquo; part [first term of Eq. (12)].
Since the &lsquo;model&rsquo; part can be integrated analytically [see Eqs. (15), (16) and
(34)], only the &lsquo;exact - model&rsquo; part needs to be integrated numerically.</p>
<p>The only effect of this model is therefore to alleviate the numerical cost of
the integration over frequencies in the G0W0 calculation. The value of the
associated parameter has thus an impact on the convergence rate of the GWLS
calculation with respect to the number of frequencies of integration
(<a class="wikilink codevar-wikilink" href="../gw#gwls_npt_gauss_quad">gwls_npt_gauss_quad</a>), but no impact on the converged result of the GWLS
calculation. Typically, the default ( <strong>gwls_model_parameter</strong>  == 1.0) is optimal.</p>
<h2 id="gwls_n_proj_freq"><strong>gwls_n_proj_freq</strong><a class="headerlink" href="#gwls_n_proj_freq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS Number of PROJection FREQuencies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable sets the number of frequencies, on top of <span><span class="MathJax_Preview">\infty</span><script type="math/tex">\infty</script></span> and 0.0 (if
<a class="wikilink codevar-wikilink" href="../gw#gwls_recycle">gwls_recycle</a> &gt; 0), to be used for the construction of the basis in which
the Hamiltonian is projected to accelerate the solution of the Sternheimer
equations involved in the construction of the dielectric matrix at finite
frequencies. See Sec. VI of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>. For most cases,
the default ( <strong>gwls_n_proj_freq</strong>  == 0) is fine.</p>
<h2 id="gwls_npt_gauss_quad"><strong>gwls_npt_gauss_quad</strong><a class="headerlink" href="#gwls_npt_gauss_quad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS Number of PoinTs to use for the GAUSSian QUADrature<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable defines the number of points used for the numerical integration
of the self-energy over frequencies in GWLS computations [see Eq. (12) of
<a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>]. The default is fine for most cases.</p>
<h2 id="gwls_nseeds"><strong>gwls_nseeds</strong><a class="headerlink" href="#gwls_nseeds" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS Number of SEED vectorS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable sets the number of seed vectors to be used in the construction
of the Lanczos basis for the (static) dielectric matrix in a GWLS calculation.
See Sec. IV of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>. Only  <strong>gwls_nseeds</strong>  == 1 has
been tested for now and users should keep this value.</p>
<h2 id="gwls_print_debug"><strong>gwls_print_debug</strong><a class="headerlink" href="#gwls_print_debug" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS PRINT level for DEBUGging<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>Influences the level of verbosity for debugging purposes in a GWLS
calculation. Users should keep its value at the default.</p>
<h2 id="gwls_recycle"><strong>gwls_recycle</strong><a class="headerlink" href="#gwls_recycle" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS RECYCLE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable let the user choose if and how he wants to recycle the solutions
of the Sternheimer equations involved in the construction of the static dielectric matrix.</p>
<ul>
<li><strong>gwls_recycle</strong>  = 0: No recycling of the solutions.</li>
<li><strong>gwls_recycle</strong>  = 1: Recycle the solutions. To do so, store them in RAM.</li>
<li><strong>gwls_recycle</strong>  = 2: Recycle the solutions. To do so, store them on disk.</li>
</ul>
<p>If the user choose to recycle the solutions, they are used to construct the
basis in which the Hamiltonian is projected for the solution of the
Sternheimer equations involved by the calculation of the dielectric matrix at
finite frequencies. The other solutions used will be those at <span><span class="MathJax_Preview">\omega \to \infty</span><script type="math/tex">\omega \to \infty</script></span>
(always used) and those at <span><span class="MathJax_Preview">\omega=</span><script type="math/tex">\omega=</script></span><a class="wikilink codevar-wikilink" href="../gw#gwls_list_proj_freq">gwls_list_proj_freq</a>. For more
information of the basis constructed, see Sec. IV of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>.</p>
<p>It is important to note that the solutions rapidly take much space to store.
Therefore, it is often not possible to store them in RAM in production
calculations, yet still desirable to retain them. This is when it becomes
interesting to store them on disk. It is particularly efficient to choose the
path of the file to be on disk space local to the processor in large MPI
calculations, since each processor need only his own solutions in the
construction of the basis.</p>
<h2 id="gwls_stern_kmax"><strong>gwls_stern_kmax</strong><a class="headerlink" href="#gwls_stern_kmax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GWLS Kmax<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 66<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
</ul>
</details>
<p>This variable sets the dimension of the dielectric matrix used in a GWLS
calculation [see Sec. IV of <a class="wikilink citation-wikilink" data-content="Efficient dielectric matrix calculations using the Lanczos algorithm for fast many-body $G_0W_0$ implementations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#laflamme2015">[Laflamme2015]</a>]. Typically
converged at a value of a few hundreds to a few thousands for a convergence
criterion of 50 meV on the eigenenergies.</p>
<h2 id="gwmem"><strong>gwmem</strong><a class="headerlink" href="#gwmem" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW MEMory<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a>, <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 11<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [8/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculation starting either from the SCR file or from the SUSC file.
In the later case both the in-core solution and the out-of-core solution
for the storage of the inverse dielectric matrix are tested." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t70.abi" target="_blank">t70.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<p><strong>gwmem</strong>  governs the memory strategy during a screening and/or a sigma run.</p>
<ul>
<li><strong>gwmem</strong>  = 1x, the screening matrix are read for all q-vectors and stored in the memory.</li>
<li>
<p><strong>gwmem</strong>  = 0x, the screening matrix are read just a q-vector after another.</p>
</li>
<li>
<p><strong>gwmem</strong>  = x1, the real-space wavefunctions are stored in the memory.</p>
</li>
<li><strong>gwmem</strong>  = x0, the real-space wavefunctions are not stored, but rather recalculated on-fly each abinit needs them using FFTs.</li>
</ul>
<p>The default is  <strong>gwmem</strong>  = 11, which is the fastest, but also the most memory
consuming. When experiencing memory shortage, one should try  <strong>gwmem</strong>  = 0.
The first digit is only meaningful when performing sigma calculations.</p>
<h2 id="gwrpacorr"><strong>gwrpacorr</strong><a class="headerlink" href="#gwrpacorr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GW RPA CORRelation energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the RPA correlation energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RPACorrEn">topic_RPACorrEn</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [1,11,21]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a></li>
</ul>
</details>
<p><strong>gwrpacorr</strong>  governs the calculation of the RPA correlation energy.</p>
<ul>
<li><strong>gwrpacorr</strong>  = 0, no RPA correlation energy is calculated.</li>
<li><strong>gwrpacorr</strong>  = 1, the RPA correlation energy is calculated using an exact integration
    over the coupling constant: it requires one diagonalization of the polarizability matrix.</li>
<li><strong>gwrpacorr</strong>  = <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> &gt; 1, the RPA correlation energy is calculated using <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> values
    for the coupling constant: it requires <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> inversions of the polarizability matrix.</li>
</ul>
<h2 id="inclvkb"><strong>inclvkb</strong><a class="headerlink" href="#inclvkb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> INCLude VKB<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BSE">topic_BSE</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,99]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [66/1087] in all abinit tests, [6/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of velocity matrix elements (DDK) with
optdriver 8 and wfk_task4 &quot;wfk_ddk&quot;." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t59.abi" target="_blank">t59.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor and plasmon-pole model, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t92.abi" target="_blank">t92.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
</ul>
</details>
<p>Possible values of  <strong>inclvkb</strong>  are 0,1,2. If  <strong>inclvkb</strong>  is 1 or 2, the
commutator of the non-local part of the pseudopotential with the position
operator is correctly included in the q &rarr; 0 contribution. This is
unfortunately time-consuming and in particular when the old algorithm
implemented by  <strong>inclvkb</strong>  = 1 is used ( <strong>inclvkb</strong>  = 2 is the recommended option). When
 <strong>inclvkb</strong>  is 0, this contribution is incorrectly omitted, but the computation is much faster.</p>
<p>The importance of this contribution depends on the number of k points. Turning
off  <strong>inclvkb</strong>  is to let to the choice of the user.</p>
<p>In general, the use of  <strong>inclvkb</strong>  = 0 is fine for GW calculations in
crystalline systems provided that the k-point sampling is sufficiently converged.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The use of  <strong>inclvkb</strong>  = 2 is strongly recommended for the calculation of optical properties.</p>
</div>
<h2 id="ixc_sigma"><strong>ixc_sigma</strong><a class="headerlink" href="#ixc_sigma" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of eXchange-Correlation functional used for self-energy calculations (SIGMA)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the exchange and correlation functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/xc">topic_xc</a>, <a class="wikilink topic-wikilink" data-content="How to use hybrid functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> Default corresponds to Teter parametrization.<br />
<em>Only relevant if:</em> mod(<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a>,10)==5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scHSE06 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scHSE06 level, the Kohn-Sham basis delivers 6.834 eV,
while the plane wave basis delivers 6.850 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivers 7.314 eV,
while the plane wave basis delivers 7.344 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
5.8309 from scHSE06(KS) and 5.8202 from scHSE06(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
At the PBE level, the (KS) band gap was 5.661 eV,
At the scHSE06 level, the Kohn-Sham basis delivered 7.340 eV,
while the plane wave basis delivered 7.341 eV.
At the G0W0-scHSE06 level, the Kohn-Sham basis delivered 7.806 eV,
while the plane wave basis delivered 7.807 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
5.033 from scHSE06(KS) and 5.032 from scHSE06(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scHSE06 calculation. Monitor the direct gap at Gamma.
The pseudopotential includes a non-linear XC core correction." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t45.abi" target="_blank">t45.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test self-consistent HF (3 iterations)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t87.abi" target="_blank">t87.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW 1RDM update BUT using only Sigma_X (not including Sigma_c term)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<p>When <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> == 5, 15 or 25,  <strong>ixc_sigma</strong>  gives the identifier of the
advanced functional (usually a hybrid) that is used perturbatively or self-
consistently to obtain the improved electronic structure.</p>
<p>The meaning of the values of  <strong>ixc_sigma</strong>  is the same as the ones of <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>,
so we refer to the latter for the list of possible values.</p>
<p>This input variable is introduced because in such calculation with
<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> == 5, 15 or 25, there is an underlying primary exchange-
correlation functional, that was used to obtain the starting wavefunctions and
eigenenergies, whose identified is <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>. The definition of both <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a> and
 <strong>ixc_sigma</strong>  allows one to bypass possible sources of confusion.</p>
<p>Note however that in the case where <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> == 5, 15 or 25, the values of
the input variables <a class="wikilink codevar-wikilink" href="../gstate#auxc_ixc">auxc_ixc</a>, <a class="wikilink codevar-wikilink" href="../gstate#hyb_mixing">hyb_mixing</a>, <a class="wikilink codevar-wikilink" href="../gstate#hyb_mixing_sr">hyb_mixing_sr</a>,
<a class="wikilink codevar-wikilink" href="../gstate#hyb_range_fock">hyb_range_fock</a> and <a class="wikilink codevar-wikilink" href="../gstate#hyb_range_dft">hyb_range_dft</a> refers to the advanced functional,
and not the primary one. Also, <a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> and <a class="wikilink codevar-wikilink" href="../gw#rcut">rcut</a> have precedence over
<a class="wikilink codevar-wikilink" href="../gstate#hyb_mixing">hyb_mixing</a>, <a class="wikilink codevar-wikilink" href="../gstate#hyb_mixing_sr">hyb_mixing_sr</a>, <a class="wikilink codevar-wikilink" href="../gstate#hyb_range_fock">hyb_range_fock</a> and <a class="wikilink codevar-wikilink" href="../gstate#hyb_range_dft">hyb_range_dft</a> to
define the parameters of the hybrid functional.</p>
<h2 id="kptgw"><strong>kptgw</strong><a class="headerlink" href="#kptgw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K-PoinTs for GW calculations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [81/1087] in all abinit tests, [13/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="ZPR computation at the Gamma point for MgO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a>, <a class="wikilink abifile-wikilink" data-content="ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_5.abi" target="_blank">teph4zpr_5.abi</a>, <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt nband with the Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_6.abi" target="_blank">teph4zpr_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_3.abi" target="_blank">tgw1_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_4.abi" target="_blank">tgw1_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>For each k-point with number igwpt in the range (1:<a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>),
 <strong>kptgw</strong> (1,igwpt) is the reduced coordinate of the k-point where the self-energy
corrections are required while <a class="wikilink codevar-wikilink" href="../gw#bdgw">bdgw</a> (1:2,igwpt) specifies the range of
bands to be considered.</p>
<p>At present, not all k-points are possible. Only those corresponding to the
k-point grid defined with the same repetition parameters ( <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, or
<a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> ) than the GS one, but <strong>without</strong> any shift, are allowed.</p>
<h2 id="mbpt_sciss"><strong>mbpt_sciss</strong><a class="headerlink" href="#mbpt_sciss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Many Body Perturbation Theory SCISSor operator<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a>, <a class="wikilink topic-wikilink" data-content="How to compute the matrix elements of the electron-phonon interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4,7,99]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: convergence in ecuteps" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_4.abi" target="_blank">tbs_4.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
G0W0 calculation updating G and W by a scissor operator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t67.abi" target="_blank">t67.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Computation of the excitonic levels with the Bethe-Salpeter equation.
Dataset3 uses the band-by-band conjugate gradient method to compute the lowest 10 states
Dataset4 performs the same task with partial direct diagonalization (Lapack)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock
(only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization
WARNING: This feature is still under testing, files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t51.abi" target="_blank">t51.abi</a></li>
</ul>
</details>
<p>The scissor operator energy added to the conductions states. In some cases,
it mimics a second iteration self-consistent GW calculation.</p>
<h2 id="mdf_epsinf"><strong>mdf_epsinf</strong><a class="headerlink" href="#mdf_epsinf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Model Dielectric Function, EPSilon INFinity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BSE">topic_BSE</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 99 and <a class="wikilink codevar-wikilink" href="../bse#bs_coulomb_term">bs_coulomb_term</a> in [20,21] (Bethe-Salpeter calculations with a model dielectric function<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [11/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Computation of the excitonic levels with the Bethe-Salpeter equation.
Dataset3 uses the band-by-band conjugate gradient method to compute the lowest 10 states
Dataset4 performs the same task with partial direct diagonalization (Lapack)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock
(only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p><strong>mdf_epsinf</strong>  specifies the value of the macroscopic dielectric function used
to model the screening function (see <a class="wikilink citation-wikilink" data-content="An efficient method for calculating quasiparticle energies in semiconductors" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bechstedt1992">[Bechstedt1992]</a>).
The proper spatial symmetry of the screening <span><span class="MathJax_Preview">W(\mathbf{r},\mathbf{r}^\prime)</span><script type="math/tex">W(\mathbf{r},\mathbf{r}^\prime)</script></span> is enforced using
Eq. (7) of <a class="wikilink citation-wikilink" data-content="Precise quasiparticle energies and Hartree-Fock bands of semiconductors and insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vonderlinden1988">[vonderLinden1988]</a>.</p>
<h2 id="nbandkss"><strong>nbandkss</strong><a class="headerlink" href="#nbandkss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BANDs in the KSS file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [12/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
KSS file generation for silicon with a different number of bands in the KSS
computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute band structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute band structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_1.abi" target="_blank">tucrpa_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>This input variable is used for the preparation of a GW calculation: it is
used in a GS run (where <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 0) to generate a _KSS file. In this run,
 <strong>nbandkss</strong>  should be non-zero. The generated _KSS file can be subsequently
used to calculate the irreducible polarizabilty <span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span> using
<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3 or to calculate GW corrections setting <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4.</p>
<ul>
<li>If  <strong>nbandkss</strong>  = 0, no _KSS file is created.</li>
<li>If  <strong>nbandkss</strong>  = -1, all the available eigenstates (energies and eigenfunctions) are stored in the abo_KSS file at the end of the ground state calculation. The number of states is forced to be the same for all k-points: it will be the minimum of the number of plane waves over all k-points.</li>
<li>If  <strong>nbandkss</strong>  is greater than 0, abinit stores (about)  <strong>nbandkss</strong>  eigenstates in the abo_KSS file. This number of states is forced to be the same for all k-points.</li>
</ul>
<p>See <a class="wikilink codevar-wikilink" href="../gw#npwkss">npwkss</a> for the selection of the number of the planewave components of
the eigenstates to be stored.
The input variable <a class="wikilink codevar-wikilink" href="../dev#iomode">iomode</a> can be used to read and write KSS files
according to different fileformat (presently only <a class="wikilink codevar-wikilink" href="../dev#iomode">iomode</a> = 0 and 3 are
available in the GW part).
The precision of the KSS file can be tuned through the input variable <a class="wikilink codevar-wikilink" href="../files#kssform">kssform</a>.
For more details about the format of the abo_KSS file, see the routine outkss.F90.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the time being, <a class="wikilink codevar-wikilink" href="../dev#istwfk">istwfk</a> must be 1 for all the k-points in order to generate a _KSS file.</p>
</div>
<h2 id="nfreqim"><strong>nfreqim</strong><a class="headerlink" href="#nfreqim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of FREQuencies along the IMaginary axis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a>, <a class="wikilink topic-wikilink" data-content="How to calculate the RPA correlation energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RPACorrEn">topic_RPACorrEn</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,12,22,9,19,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [31/1087] in all abinit tests, [4/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
create the screening file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_2.abi" target="_blank">tgw2_2.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>nfreqim</strong>  sets the number of pure imaginary frequencies used to calculate
the dielectric matrix in order to perform the numerical integration of the GW self-energy.</p>
<h2 id="nfreqmidm"><strong>nfreqmidm</strong><a class="headerlink" href="#nfreqmidm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Nth FREQuency Moment of the Imaginary part of the Dielectric Matrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p>depending on the value of  <strong>nfreqmidm</strong>  will calculate the frequency moment of
the dielectric matrix or its inverse,</p>
<ul>
<li>if  <strong>nfreqmidm</strong>  is positive: calculate (nth= <strong>nfreqmidm</strong> ) frequency moment of the dielectric matrix.</li>
<li>if  <strong>nfreqmidm</strong>  is negative: calculate (nth= <strong>nfreqmidm</strong> ) frequency moment of the inverse dielectric matrix.</li>
<li>if  <strong>nfreqmidm</strong>  = 0: calculate first frequency moment of the full polarizability.</li>
</ul>
<p>See <a class="wikilink citation-wikilink" data-content="Frequency moments of the dielectric function for an inhomogeneous electron gas" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#taut1985">[Taut1985]</a>.</p>
<h2 id="nfreqre"><strong>nfreqre</strong><a class="headerlink" href="#nfreqre" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of FREQuencies along the REal axis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to define frequency meshes (on the imaginary and real axes) for MBPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/FrequencyMeshMBPT">topic_FrequencyMeshMBPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> in [2,12,22,9,19,29]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [26/1087] in all abinit tests, [4/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
create the screening file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_2.abi" target="_blank">tgw2_2.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>nfreqre</strong>  sets the number of real frequencies used to calculate the
dielectric matrix in order to perform the numerical integration of the GW self-energy.</p>
<p>It can be used also in case of GW calculations with plasmon-pole models, <em>i.e.</em>
<a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a>&lt;10, to reduce the number of frequencies used to evaluate the
dielectric matrix from the (default) two to one frequency (omega=0) by setting
 <strong>nfreqre</strong>  = 1. This might be a good idea in case one is planning to use
<a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a> &gt; 1. This will force the calculation of the screening on a single
frequency (<span><span class="MathJax_Preview">\omega=0</span><script type="math/tex">\omega=0</script></span>) and hence reduce memory and disk space requirement. The
only draw back is that the user will not be able to perform self energy
calculation using <a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a> = 1, since in the last case the dielectric matrix
calculated on two frequencies is required. If the user is not sure which
ppmodel to use, then s/he is not advised to use this input variable. Using the
default values, one must be able to get a screening file that can be used with any <a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a>.</p>
<h2 id="nfreqsp"><strong>nfreqsp</strong><a class="headerlink" href="#nfreqsp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of FREQuencies for the SPectral function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [14/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt q-sampling with Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_8.abi" target="_blank">teph4zpr_8.abi</a></li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum : perform the GW calculation
at the bottom of the valence band
Obtain the corresponding spectral function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_4.abi" target="_blank">tgw2_4.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t60.abi" target="_blank">t60.abi</a></li>
</ul>
</details>
<p><strong>nfreqsp</strong>  defines the number of real frequencies used to calculate the
spectral function of the GW Green&rsquo;s function.</p>
<h2 id="nkptgw"><strong>nkptgw</strong><a class="headerlink" href="#nkptgw" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K-PoinTs for GW corrections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [81/1087] in all abinit tests, [13/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="ZPR computation at the Gamma point for MgO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a>, <a class="wikilink abifile-wikilink" data-content="ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_5.abi" target="_blank">teph4zpr_5.abi</a>, <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt nband with the Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_6.abi" target="_blank">teph4zpr_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_3.abi" target="_blank">tgw1_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_4.abi" target="_blank">tgw1_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>nkptgw</strong>  gives the number of k-points for which the GW calculation must be
done. It is used to dimension <a class="wikilink codevar-wikilink" href="../gw#kptgw">kptgw</a>.</p>
<h2 id="nomegasf"><strong>nomegasf</strong><a class="headerlink" href="#nomegasf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of OMEGA to evaluate the Spectral Function<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#spmeth">spmeth</a>!=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Hilbert transform for chi0. Use nfreqre and freqremin, freqremax to split
the calculation along the real axis. The SCR files produced in dataset 3 and 4
are then merged my mrgscr in the next test." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a></li>
</ul>
</details>
<p><strong>nomegasf</strong>  defines the number of real frequencies used to describe the
spectral function associated to the irreducible polarizability
<span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span>. The frequency mesh will cover the interval between 0 and
the maximum (positive) transition energy between occupied and empty states.
The delta function entering the expression defining the spectral function is
approximated using two different methods according to the value of the <a class="wikilink codevar-wikilink" href="../gw#spmeth">spmeth</a> input variable.</p>
<p>It is important to notice that an accurate description of the imaginary part
of <span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span> requires an extremely dense frequency mesh. It should be
kept in mind, however, that the memory required grows fast with the value of  <strong>nomegasf</strong> .</p>
<h2 id="nomegasi"><strong>nomegasi</strong><a class="headerlink" href="#nomegasi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of OMEGA(S) along the Imaginary axis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 12<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW 1RDM update BUT using only Sigma_X (not including Sigma_c term)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test for Silicon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t36.abi" target="_blank">t36.abi</a></li>
</ul>
</details>
<p><strong>nomegasi</strong>  defines the number of frequency points used to sample the self-
energy along the imaginary axis. The frequency mesh is linear and covers the
interval between <code>omegasimin</code>=0.01 Hartree and <a class="wikilink codevar-wikilink" href="../gw#omegasimax">omegasimax</a>.</p>
<h2 id="nomegasrd"><strong>nomegasrd</strong><a class="headerlink" href="#nomegasrd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of OMEGA to evaluate the Sigma Real axis Derivative<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 9<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a></li>
</ul>
</details>
<p>The number of real frequencies around the KS energy where the self-energy
<span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> is evaluated. From these values, the derivative of <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span> at the KS
energy is numerically estimated through linear interpolation.</p>
<h2 id="npvel"><strong>npvel</strong><a class="headerlink" href="#npvel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Particle VELocities<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform random stopping power calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RandStopPow">topic_RandStopPow</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a></li>
</ul>
</details>
<p>In the context of the electronic stopping power of impinging ion in matter,
 <strong>npvel</strong>  sets the number of the ion velocities to be calculated via linear response.
When  <strong>npvel</strong>  = 0, no stopping power calculation is performed.
The direction and the velocity maximum are set with the input variable
<a class="wikilink codevar-wikilink" href="../gw#pvelmax">pvelmax</a>. Note that the results are output for a <span><span class="MathJax_Preview">Z=1</span><script type="math/tex">Z=1</script></span> impinging ion, i.e. a proton.</p>
<h2 id="npwkss"><strong>npwkss</strong><a class="headerlink" href="#npwkss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PlaneWaves in the KSS file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/1087] in all abinit tests, [0/148] in abinit tutorials</summary></details>
<p>This input variable is used for the preparation of a GW calculation: the GS
run (where <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 1 and <a class="wikilink codevar-wikilink" href="../gw#nbandkss">nbandkss</a>/=0) should be followed with a run
where <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3. Also, if <a class="wikilink codevar-wikilink" href="../gw#nbandkss">nbandkss</a> = 0, no use of  <strong>npwkss</strong> .</p>
<p><strong>npwkss</strong>  defines the number of planewave components of the Kohn-Sham states
to build the Hamiltonian, in the routine outkss.F90, and so, the size of the
matrix, the size of eigenvectors, and the number of available states, to be
stored in the abo_KSS file. If it is set to 0, then, the planewave basis set
defined by the usual Ground State input variable <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> is used to generate
the superset of all planewaves used for all k points. Note that this (large)
planewave basis is the same for all k points.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For the time being, <a class="wikilink codevar-wikilink" href="../dev#istwfk">istwfk</a> must be 1 for all the k points.</p>
</div>
<h2 id="nqptdm"><strong>nqptdm</strong><a class="headerlink" href="#nqptdm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Q-PoinTs for the Dielectric Matrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a></li>
</ul>
</details>
<p>If  <strong>nqptdm</strong>  is equal to 0, the set of q points for computing the dielectric
matrix is determined automatically considering all the possible differences
between the k-points contained in the _KSS file. When  <strong>nqptdm</strong>  is non-zero,
the list of q points is read from <a class="wikilink codevar-wikilink" href="../gw#qptdm">qptdm</a>. This allows one to split the big
calculation of all the dielectric matrices into smaller calculations that can
be performed independently. The _SCR files generated in different runs can be
merged thanks to the <strong>Mrgscr</strong> utility. If  <strong>nqptdm</strong>  is equal to -1, the
code reports the list of q-points in the log file (YAML format) and then stops.</p>
<h2 id="omegasimax"><strong>omegasimax</strong><a class="headerlink" href="#omegasimax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OMEGA to evaluate Sigma along the Imaginary axis D: MAXimal value<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 50 eV<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4 and <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a></li>
</ul>
</details>
<p><strong>omegasimax</strong>  defines the maximum frequency along the imaginary the axis. In
conjunction with <a class="wikilink codevar-wikilink" href="../gw#nomegasi">nomegasi</a>,  <strong>omegasimax</strong>  uniquely defines the linear mesh
employed to sample the self-energy along the imaginary axis.</p>
<h2 id="omegasrdmax"><strong>omegasrdmax</strong><a class="headerlink" href="#omegasrdmax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OMEGA to evaluate the Sigma Real axis Derivative: MAXimal value<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0 eV<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a></li>
</ul>
</details>
<p>The maximum distance from the KS energy where to evaluate Sigma. Sigma is
evaluated at [ KS_energy -  <strong>omegasrdmax</strong> , KS_energy +  <strong>omegasrdmax</strong>  ]
sampled <a class="wikilink codevar-wikilink" href="../gw#nomegasrd">nomegasrd</a> times.</p>
<h2 id="ppmfrq"><strong>ppmfrq</strong><a class="headerlink" href="#ppmfrq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Plasmon Pole Model FReQuency<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0 Ha<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [29/1087] in all abinit tests, [5/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, one-shot GW calculation, parallelism over k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t71.abi" target="_blank">t71.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation to get the density
Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)
Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.abi" target="_blank">tgw1_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections
Dataset 1: ground state calculation
Dataset 2: calculation of the WFK file for only Gamma point
Dataset 3: calculation of the screening (epsilon^-1 matrix for W)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_2.abi" target="_blank">tgw1_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Calculation of the GW corrections" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_4.abi" target="_blank">tgw1_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculations within the PAW formalism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
G0W0 calculation updating G and W by a scissor operator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculation starting either from the SCR file or from the SUSC file.
In the later case both the in-core solution and the out-of-core solution
for the storage of the inverse dielectric matrix are tested." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t70.abi" target="_blank">t70.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
FCC Argon
QPscGW calculation (only 1 iteration) meant to prepare the following cut3d analysis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
</ul>
</details>
<p><strong>In plasmon-pole calculations</strong></p>
<p>Usually only effective if GW corrections are evaluated using the plasmon-pole
model of Godby-Needs (<a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a> == 1).</p>
<p>In the present status of the GW code, the convolution in frequency space
defining the self-energy operator can be evaluated using two different
approaches: numerical integration and plasmon-pole models.
Methods based on the numerical integration (contour deformation, analytic
continuation) require the knowledge of the screened interaction for several
frequencies. These approaches give the most accurate results but at the price
of an increase in the CPU time required.
Alternatively, it is possible to approximate the dynamical behaviour of the
screened interaction through simple analytical expressions, the so-called
plasmon-pole models. In the plasmon-pole model proposed by Godby-Needs
(<a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a> = 1), the screening must be available at zero frequency, as well as
at another imaginary frequency, of the order of the plasmon frequency (the
peak in the EELS spectrum). This information is used to model the behaviour of
the dielectric matrix for all frequencies. During the calculation of the
screening,  <strong>ppmfrq</strong>  defines the imaginary frequency where the dielectric
matrix is evaluated, in addition to the zero frequency. During the self-energy
run,  <strong>ppmfrq</strong>  can be used to define the second frequency to be used to
calculate the plasmon-pole parameters. This is particularly useful when the
SCR file contains several frequencies along the imaginary axis. In this case
the frequency whose value is the closest one to  <strong>ppmfrq</strong>  will be selected.
Note that, if the plasmon-pole approximation is good, then, the choice of
 <strong>ppmfrq</strong>  should have no influence on the final result. One should check
whether this is the case. In general, the plasmon frequencies of bulk solids
are of the order of 0.5 Hartree.</p>
<p><strong>In Contour Deformation calculations</strong></p>
<p><strong>ppmfrq</strong>  is here used to <strong>override</strong> the default value calculated from the
average electronic density per unit cell. This can affect the distribution of
gridpoints along the imaginary and real frequency axes. See
<a class="wikilink codevar-wikilink" href="../gw#cd_frqim_method">cd_frqim_method</a>, <a class="wikilink codevar-wikilink" href="../gw#gw_frqim_inzgrid">gw_frqim_inzgrid</a> and <a class="wikilink codevar-wikilink" href="../gw#gw_frqre_inzgrid">gw_frqre_inzgrid</a> for more
details.</p>
<h2 id="ppmodel"><strong>ppmodel</strong><a class="headerlink" href="#ppmodel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Plasmon Pole MODEL<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3,4]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
G0W0 calculation updating G and W by a scissor operator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
To check a G0W0+spin calculation with AFM symmetries (same as test t63 but only spin up
wavefunctions, non-symmorphic symmetries are obviously included)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculation starting either from the SCR file or from the SUSC file.
In the later case both the in-core solution and the out-of-core solution
for the storage of the inverse dielectric matrix are tested." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t70.abi" target="_blank">t70.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-content="
FCC Argon
QPscGW calculation (only 1 iteration) meant to prepare the following cut3d analysis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-content="
TiO2
GW calculations with PPM-HL treating invalid frequencies in different ways." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t41.abi" target="_blank">t41.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<ul>
<li><strong>ppmodel</strong> = 1: PP model of Godby and Needs <a class="wikilink citation-wikilink" data-content="Metal-insulator transition in Kohn-Sham theory and quasiparticle theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#godby1989">[Godby1989]</a>.</li>
<li><strong>ppmodel</strong> = 2: PP model of Hybertsen and Louie <a class="wikilink citation-wikilink" data-content="Electron correlation in semiconductors and insulators: Band gaps and quasiparticle energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#hybertsen1986">[Hybertsen1986]</a>.</li>
<li><strong>ppmodel</strong> = 3: PP model of W. von der Linden and P. Horsh <a class="wikilink citation-wikilink" data-content="Precise quasiparticle energies and Hartree-Fock bands of semiconductors and insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vonderlinden1988">[vonderLinden1988]</a>.</li>
<li><strong>ppmodel</strong> = 4: PP model of Farid and Engel <a class="wikilink citation-wikilink" data-content="Generalized plasmon-pole model and plasmon band structures of crystals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#engel1993">[Engel1993]</a>.</li>
<li><strong>ppmodel</strong> = 0: no PP model, numerical integration (contour deformation method <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a>).</li>
</ul>
<p>Please note the difference between <strong>ppmodel</strong> 1 and <strong>ppmodel</strong> 2,3,4. In the
first case (<strong>ppmodel</strong> = 1), the plasmon-pole parameters are determined in
order to reproduce the behaviour of the dielectric matrix at two calculated
frequencies: the static limit (<span><span class="MathJax_Preview">\omega=0</span><script type="math/tex">\omega=0</script></span>) and the imaginary frequency defined by
<a class="wikilink codevar-wikilink" href="../gw#ppmfrq">ppmfrq</a>. In the last three cases, instead, the plasmon-pole parameters are
found by using the dielectric matrix calculated only at <span><span class="MathJax_Preview">\omega=0</span><script type="math/tex">\omega=0</script></span> and enforcing
the so-called f-sum rule. See also <a class="wikilink codevar-wikilink" href="../gw#nfreqre">nfreqre</a>.</p>
<p>Please note also that in the case of <strong>ppmodel</strong> 4, the plasmon energies are
not simple mathematical parameters, but rather have a physical meaning (at
least the lowest ones). Thus the calculated plasmon band structure (plasmon
energy vs q vector) is reported in the output file for the lowest 10 bands.</p>
<h2 id="pvelmax"><strong>pvelmax</strong><a class="headerlink" href="#pvelmax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Particle VELocity MAXimum<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform random stopping power calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/RandStopPow">topic_RandStopPow</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 1.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a></li>
</ul>
</details>
<p>When <a class="wikilink codevar-wikilink" href="../gw#npvel">npvel</a> is larger than 0, it performs electronic stopping power
calculations on a velocity grid along the direction determined by  <strong>pvelmax</strong> .
The vector  <strong>pvelmax</strong>  defines both the direction and the maximum velocity.
 <strong>pvelmax</strong>  is input in Cartesian coordinates.</p>
<h2 id="qptdm"><strong>qptdm</strong><a class="headerlink" href="#qptdm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q-PoinTs for the Dielectric Matrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../gw#nqptdm">nqptdm</a>)<br />
<em>Default value:</em> <em>0.0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#nqptdm">nqptdm</a>!=0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Test on splitting screening calculation using nqptdm and qptdm
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In datasets 2-4, ABINIT computes the eps^-1 matrix for 1 qpt , 2 qpts, 3qpts respectively" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t87.abi" target="_blank">t87.abi</a></li>
</ul>
</details>
<p><strong>qptdm</strong>  contains the set of q points used in the screening part of ABINIT,
instead of the automatic generation of the q points when <a class="wikilink codevar-wikilink" href="../gw#nqptdm">nqptdm</a> = 0. These q
points are given in terms of reciprocal space primitive translations (<strong>not</strong> in
cartesian coordinates!). For further explanation, see the input variable <a class="wikilink codevar-wikilink" href="../gw#nqptdm">nqptdm</a>.</p>
<h2 id="rcut"><strong>rcut</strong><a class="headerlink" href="#rcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radius of the CUT-off for coulomb interaction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-content="
5. Galaborane molecule to test the HGH pseudo-potentials.
WARNING : BigDFT try to read an additional line giving rcutoff and rloc, present in some pseudopotentials.
If such a line exist after the value defined by lmax, but does NOT contain proper rcutoff and rloc (e.g. 0.0), BigDFT might fail by hanging
or SEGFAULT, without giving proper error message. This is difficult to debug." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t05.abi" target="_blank">t05.abi</a></li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="Na2, Molecule, 2 atoms, parallelism over bands for scfGW with a cutoffed interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t77.abi" target="_blank">t77.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Isolated hydrogen atom
Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-content="
RPA correlation energy calculation in Si:
using exact or numerical integration over the coupling constant, using extrapolar trick or not,
using the full or long-range only Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2.
Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t68.abi" target="_blank">t68.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a></li>
</ul>
</details>
<p>Truncation of the Coulomb interaction in real space. The meaning of  <strong>rcut</strong> 
is governed by the cutoff shape option <a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a>.</p>
<p>If  <strong>rcut</strong>  is negative, the cutoff is automatically calculated so to enclose
the same volume inside the cutoff as the volume of the primitive cell.</p>
<h2 id="rhoqpmix"><strong>rhoqpmix</strong><a class="headerlink" href="#rhoqpmix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RHO QuasiParticle MIXing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [9/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si, Bulk, 2 atoms, parallelism over k-points for the WFK file creation
parallelism over bands for GW without PPM" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t74.abi" target="_blank">t74.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test self-consistent model GW (2 iterations) following Faleev et al. [PRL 93, 126406 (2004)]." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t88.abi" target="_blank">t88.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Diamond: GW band gap with vertex corrections in W; Gygi-Baldereschi aux function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t36.abi" target="_blank">t36.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>For self-consistent GW runs,  <strong>rhoqpmix</strong>  sets the mixing coefficient between
the new and the previous electronic densities. This mixing damps the spurious
oscillations in the Hartree potential when achieving self-consistency.
 <strong>rhoqpmix</strong>  is meaningful only when doing self-consistency on the
wavefunctions with <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a> &gt;= 20.</p>
<h2 id="sigma_bsum_range"><strong>sigma_bsum_range</strong><a class="headerlink" href="#sigma_bsum_range" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SIGMA: Band SUM RANGE<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [7]<br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t60.abi" target="_blank">t60.abi</a></li>
</ul>
</details>
<p>This variable allows the user to specify the range of bands in the sum over states for the e-ph self-energy <span><span class="MathJax_Preview">\Sigma_{n\kk}</span><script type="math/tex">\Sigma_{n\kk}</script></span>.
If not specified, the code includes all the states from 1 up to <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>.
Note that this option can be used only when computing both the real and imaginary part of the self-energy.
In the calculation of electron linewidths, indeed, the states are automatically selected using an energy window
that takes into account the maximum phonon frequency.</p>
<h2 id="sigma_ngkpt"><strong>sigma_ngkpt</strong><a class="headerlink" href="#sigma_ngkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SIGMA: Number of Grid points for K PoinTs generation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7]<br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="
E-ph for mobility in semiconductors" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4mob_7.abi" target="_blank">teph4mob_7.abi</a>, <a class="wikilink abifile-wikilink" data-content="Computation of isotropic Migdal-Eliashberg Tc" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4isotc_3.abi" target="_blank">teph4isotc_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="Computation of isotropic Migdal-Eliashberg Tc" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4isotc_4.abi" target="_blank">teph4isotc_4.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t62.abi" target="_blank">t62.abi</a></li>
</ul>
</details>
<p>This variable allows the user to specify the list of k-points in the self-energy <span><span class="MathJax_Preview">\Sigma_{n\kk}</span><script type="math/tex">\Sigma_{n\kk}</script></span>
in terms of a homogeneous mesh in the IBZ instead of the traditional approach based on <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a>, <a class="wikilink codevar-wikilink" href="../gw#kptgw">kptgw</a>, <a class="wikilink codevar-wikilink" href="../gw#bdgw">bdgw</a>.</p>
<p>The specification in terms of sigma_ngkpt is easier to use in particular when
the self-energy is needed on a sub-mesh used to generate the input WFK file.</p>
<p>The set of bands can be specified either with <a class="wikilink codevar-wikilink" href="../eph#sigma_erange">sigma_erange</a> or <a class="wikilink codevar-wikilink" href="../gw#gw_qprange">gw_qprange</a>.
<a class="wikilink codevar-wikilink" href="../eph#sigma_erange">sigma_erange</a> is the recommended approach when computing transport properties.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>sigma_ngkpt and <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a> and are mutually exclusive.</p>
</div>
<h2 id="sigma_nshiftk"><strong>sigma_nshiftk</strong><a class="headerlink" href="#sigma_nshiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SIGMA: Number of SHIFTs for K point grids<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7] and <a class="wikilink codevar-wikilink" href="../gw#sigma_shiftk">sigma_shiftk</a><br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Computation of isotropic Migdal-Eliashberg Tc" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4isotc_3.abi" target="_blank">teph4isotc_3.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t62.abi" target="_blank">t62.abi</a></li>
</ul>
</details>
<p>The number of shifts in <a class="wikilink codevar-wikilink" href="../gw#sigma_shiftk">sigma_shiftk</a>.</p>
<h2 id="sigma_shiftk"><strong>sigma_shiftk</strong><a class="headerlink" href="#sigma_shiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SHIFT for K points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../gw#sigma_nshiftk">sigma_nshiftk</a>)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7] and <a class="wikilink codevar-wikilink" href="../gw#sigma_nshiftk">sigma_nshiftk</a><br />
<em>The use of this variable forbids the use of:</em> <a class="wikilink codevar-wikilink" href="../eph#sigma_erange">sigma_erange</a> or <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a><br />
<em>Added in version:</em> 9.0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/1087] in all abinit tests, [2/148] in abinit tutorials</summary><ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Computation of isotropic Migdal-Eliashberg Tc" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4isotc_3.abi" target="_blank">teph4isotc_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="Computation of isotropic Migdal-Eliashberg Tc" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4isotc_4.abi" target="_blank">teph4isotc_4.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t62.abi" target="_blank">t62.abi</a></li>
</ul>
</details>
<p>The shifts of the k-mesh used to define the list of k-points for the computation of the
electron self-energy <span><span class="MathJax_Preview">\Sigma_{n\kk}</span><script type="math/tex">\Sigma_{n\kk}</script></span>.
See also <a class="wikilink codevar-wikilink" href="../gw#sigma_nshiftk">sigma_nshiftk</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
</div>
<p>This variable is not compatible with <a class="wikilink codevar-wikilink" href="../gw#nkptgw">nkptgw</a> and <a class="wikilink codevar-wikilink" href="../eph#sigma_erange">sigma_erange</a>.</p>
<h2 id="spbroad"><strong>spbroad</strong><a class="headerlink" href="#spbroad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPectral BROADening<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3 and <a class="wikilink codevar-wikilink" href="../gw#spmeth">spmeth</a> == 2<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a></li>
</ul>
</details>
<p>When a screening calculation (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3) uses a spectral representation
of the irreducible polarizability in which the delta function is replaced by
the gaussian approximant (<a class="wikilink codevar-wikilink" href="../gw#spmeth">spmeth</a> == 2), the standard deviation of the
gaussian is given by  <strong>spbroad</strong> .</p>
<h2 id="spmeth"><strong>spmeth</strong><a class="headerlink" href="#spmeth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPectral METHod<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [6/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with contour deformation. Hilbert transform is used to calculate
the irreducible polarizability starting from the imaginary part. The delta distribution
is approximated by means of a triangular function as in PRB 74, 035101 (2006)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t71.abi" target="_blank">t71.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the cd_custom_imfrq, cd_imfrqs and cd_full_grid options" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Hilbert transform for chi0. Use nfreqre and freqremin, freqremax to split
the calculation along the real axis. The SCR files produced in dataset 3 and 4
are then merged my mrgscr in the next test." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a></li>
</ul>
</details>
<p>The  <strong>spmeth</strong>  input variable defines the method used to calculate the
irreducible polarizability <span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span>.</p>
<p>By default <span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span> is calculated employing the Adler-Wiser
expression ( <strong>spmeth</strong>  = 0) with a CPU effort that scales linearly with the
number of frequencies. This approach is convenient when few frequencies are
required, and is usually used in conjunction with plasmon-pole models in which
only one or two frequencies are calculated, according to the value of <a class="wikilink codevar-wikilink" href="../gw#ppmodel">ppmodel</a>.
Unfortunately a calculation based on the Adler-Wiser expression might be quite
CPU demanding if the matrix elements of the self-energy operator are evaluated
by performing numerically the convolution defining the self-energy. The
integrand function, indeed, has poles above and below the real axis, and the
screened interaction has to be evaluated on a dense frequency mesh in order to
obtain accurate results.</p>
<p>In the spectral method ( <strong>spmeth</strong>  = 1 or 2) the irreducible polarizability is
expressed as the Hilbert transform of the imaginary part. The advantage in
using this approach consists in the fact that, once the spectral function is
known, the irreducible polarizability for an arbitrary frequency can be easily
obtained through inexpensive integrations. On the other hand, an accurate
evaluation of the imaginary part requires a dense frequency mesh due to the
presence of delta functions. Two different approaches can be used to
approximate these delta functions thus allowing the use of affordable
frequency grids.</p>
<p>Summarizing:</p>
<ul>
<li>0 &rarr;  use Adler-Wiser expression to calculate <span><span class="MathJax_Preview">\chi^{(0)}_{KS}</span><script type="math/tex">\chi^{(0)}_{KS}</script></span></li>
<li>1 &rarr;  use the spectral method approximating the delta function with a triangular approximant as proposed in <strong>REF TO BE ADDED</strong></li>
<li>2 &rarr; use spectral method but approximating the delta function with a Taylor expansion of the exponential as proposed in <strong>REF TO BE ADDED</strong></li>
</ul>
<h2 id="symchi"><strong>symchi</strong><a class="headerlink" href="#symchi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetryze <span><span class="MathJax_Preview">\chi_0</span><script type="math/tex">\chi_0</script></span><br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [35/1087] in all abinit tests, [4/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.abi" target="_blank">tmbt_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz.
Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.abi" target="_blank">tmbt_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW calculations within the PAW formalism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t66.abi" target="_blank">t66.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials.
W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV.
First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian, then
the Haydock iterative method is employed to calculate the macroscopic dielectric function.
The last dataset solves the BSE problem including the coupling between resonant and
anti-resonant transition via brute force diagonalization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-content="
LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.abi" target="_blank">t14.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor and plasmon-pole model, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test G0W0 with nspinor, Contour-deformation and Hilbert transform, no SOC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Silicon
One-shot GW with analytic continuation of Sigma(iw)
convolution is performed on the imaginary axis = \int dz G(iw+iz) W(iz)
low-rank approximation is used in the last dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Silicon
check numerical stability of Chi0 with inclvkb=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t40.abi" target="_blank">t40.abi</a> &hellip;</li>
</ul>
</details>
<p>The evaluation of the irreducible polarizability for a given q point requires
an integration over the Brillouin zone (BZ) which is approximated by a
discrete sum over k points. In principle the integrand function should be
evaluated for each k-point in the BZ, however it is possible to reduce the
number of points to be explicitly considered by taking advantage of symmetry
properties. The development input variable  <strong>symchi</strong>  is used to choose
between these two equivalent methods:</p>
<ul>
<li>0 &rarr;  the summation over k points is performed considering <strong>all</strong> the points in the BZ (useful for testing and debugging).</li>
<li>1 &rarr;  the summation is restricted to the k points belonging to the irreducible wedge defined by the little group associated to the external vector q.</li>
</ul>
<h2 id="symsigma"><strong>symsigma</strong><a class="headerlink" href="#symsigma" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetrization of SIGMA matrix elements<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> The default value changed in Abinitv9 from 0 to 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [4, 7]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [69/1087] in all abinit tests, [3/148] in abinit tutorials</summary><ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: hybrid functional calculation HSE with the GW code.
The Fock exchange mixing parameter is tunable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-content="Si, Bulk, 2 atoms, qp-SC calculation, parallelism over k points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t73.abi" target="_blank">t73.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum:
calculation of the quasi-particle Fermi energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_3.abi" target="_blank">tgw2_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline aluminum : perform the GW calculation
at the bottom of the valence band
Obtain the corresponding spectral function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw2_4.abi" target="_blank">tgw2_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test GW calculation with and without plasmon-pole model." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Al FCC, in primitive cell (1 atom/cell).
Test GW calculation with and without plasmon-pole model for a metal." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Si FCC, in primitive cell (2 atoms/cell).
Test HF, SEX, and COHSEX calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Beta-SiC
Calculation of the GW corrections with out-of-core solutions and
extrapolar approximation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t65.abi" target="_blank">t65.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Carbon in diamond structure. Chained GW calculation: The first run produces the WFK, the SCR, the SUSC
and the QPS file. These file are subsequently read and used in t537 using irdwfk, irdscr, irdsuscep and irdqps
In the second dataset of t85, the screened interaction W is approximated using the test-electron
expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-content="
HF calculation with NC pseudopotentials, different combinations of nspinor in [1, 2], with/wo SOC
Test WFK IO and wafunction conversion nspinor 1 --&gt; nspinor 2
HF results in dataset 4-5 should be indentical, dataset 6 should show SOC splitting." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t90.abi" target="_blank">t90.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Test sigma driver with nspinor == 2. Use screening computed with nspinor 1 and nspden 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t91.abi" target="_blank">t91.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t34.abi" target="_blank">t34.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>This option activates the symmetrization of the self-energy matrix elements ( <strong>symsigma</strong>  = 1).
In this case the BZ integration defining the self-energy
matrix elements is reduced to an appropriate irreducible wedge defined
by the point group of the wave-vector k specified in the <a class="wikilink codevar-wikilink" href="../gw#kptgw">kptgw</a> list.</p>
<p>The symmetrized expression leads to a considerable speedup of the run, especially
for high-symmetry k points e.g. <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>.
Unfortunately, this option is not yet compatible with self-consistent GW
calculations (see <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a>).</p>
<p>The code constructs a symmetric invariant
for the diagonal matrix elements of the self-energy by averaging the self-energy matrix
elements within the degenerate subspace. Therefore, particular care has to be
taken in the presence of accidental degeneracies. Since calculations
performed with  <strong>symsigma</strong>  = 1 will not be able to remove the initial
accidental degeneracy. This is the reason why this option is not activated by default.</p>
<h2 id="ucrpa"><strong>ucrpa</strong><a class="headerlink" href="#ucrpa" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> calculation of the screened interaction U with the Constrained RPA method<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the effective Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/CRPA">topic_CRPA</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/1087] in all abinit tests, [2/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute band structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_1.abi" target="_blank">tucrpa_1.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>When equal to one or two, this variable allows one to calculate U with
the cRPA method. An explicit test is shown in automatic tests
<a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">v7[23]</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">v7[24]</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">v7[25]</a>, <a class="wikilink abifile-wikilink" data-content="
Diamond: G0W0 @ scPBE0-1/3 calculation. Monitor the direct gap at Gamma.

First, with the scGW methodology based on a Kohn-Sham basis,
then doing the scPBE0 using the planewave basis, followed by a one-shot G0W0.
The agreement is reasonable with the parameters used in the automatic test,
but can be improved with better parameters (esp. nband), see later.
At the PBE level, the (KS) band gap is 5.231 eV,
At the scPBE0-1/3 level, the Kohn-Sham basis delivers 8.101 eV,
while the plane wave basis delivers 8.122 eV.
At the G0W0-scPBE0-1/3 level, the Kohn-Sham basis delivers 7.638 eV,
while the plane wave basis delivers 7.659 eV.
The macroscopic dielectric constant (at Gamma) is 9.3698 from PBE,
4.4126 from scPBE0-1/3(KS) and 4.4105 from scPBE0-1/3(planewaves).

These calculations have also been done with better
parameters, in order to observe a better agreement between the KS basis set and the
planewave basis set (ecut 20  ecutsigx 20  nband 30 gw_qprange 30 - note however that ecuteps 2 is low),
at the expense of CPU time..
In this case, one used the PBE0 functional (ixc_sigma=41 or ixc_sigma=-406,
of even isc_sigma=42 with hyb_mixing=0.25 - all the cases were checked).
At the PBE level, the (KS) band gap was 5.661 eV,
At the scPBE0 level, the Kohn-Sham basis delivered 7.882 eV,
while the plane wave basis delivered 7.884 eV.
At the G0W0-scPBE0 level, the Kohn-Sham basis delivered 7.820 eV,
while the plane wave basis delivered 7.827 eV.
The macroscopic dielectric constant (at Gamma) was 7.845 from PBE,
4.483 from scPBE0(KS) and 4.490 from scPBE0(planewaves)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t68.abi" target="_blank">v7[68]</a>, and <a class="wikilink abifile-wikilink" data-content="Test of Fock in sequential case, with simple mixing and NC psps" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t69.abi" target="_blank">v7[69]</a>.
The present implementation is parallelized (as for usual GW
calculations), use symmetry over k points only for calculations involving one
correlated atom, and can be use when correlated bands are entangled or not.
The constrained calculation of the polarisability can be done by eliminating
transition betweens correlated bands (and not orbitals) with the variable
<a class="wikilink codevar-wikilink" href="../gw#ucrpa_bands">ucrpa_bands</a>.</p>
<p>For  <strong>ucrpa</strong>  = 1, two solutions are possible. The first one is to specify
(with the variable <a class="wikilink codevar-wikilink" href="../gw#ucrpa_bands">ucrpa_bands</a>) the bands to exclude from the
polarisability calculation. The second solution is to provide an energy window
(with the variable <a class="wikilink codevar-wikilink" href="../gw#ucrpa_window">ucrpa_window</a>). The electronic transitions inside this
window will not be taken into account in the polarisability calculation.</p>
<p>For  <strong>ucrpa</strong>  = 2, the ucrpa_bands should be equal to the <a class="wikilink codevar-wikilink" href="../dmft#dmftbandi">dmftbandi</a> and
<a class="wikilink codevar-wikilink" href="../dmft#dmftbandf">dmftbandf</a> values, and the polarisability of the correlated subspace is
constructed with a band and k point dependent weight.</p>
<p>The implementation is restricted to the case of <a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a> = 1 (collinear case).</p>
<p>A short presentation of the method and some aspect of the implementation can
be found in Sec. II and Appendix A of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>.</p>
<h2 id="ucrpa_bands"><strong>ucrpa_bands</strong><a class="headerlink" href="#ucrpa_bands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> For the calculation of U with the Constrained RPA method, gives correlated BANDS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the effective Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/CRPA">topic_CRPA</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [-1, -1]<br />
<em>Comment:</em> That is, the default includes no band.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/1087] in all abinit tests, [1/148] in abinit tutorials</summary><ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tucrpa_2.abi" target="_blank">tucrpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute density, WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t78.abi" target="_blank">t78.abi</a></li>
</ul>
</details>
<p>Gives the first and last correlated bands for the cRPA calculation of the polarisability.</p>
<h2 id="ucrpa_window"><strong>ucrpa_window</strong><a class="headerlink" href="#ucrpa_window" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> For the calculation of U with the Constrained RPA method, gives energy WINDOW<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the effective Coulomb interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/CRPA">topic_CRPA</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [-1, -1]<br />
<em>Comment:</em> That is, the energy window is empty by default.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Specify a window of energy for the cRPA calculation of the polarisability. The
transition inside this window will not be taken into account in the
constrained polarisabilty calculations.</p>
<p>The lower bound and the upper bound energies must be specified (two real
numbers) with respect to the position of the Fermi level.</p>
<h2 id="vcutgeo"><strong>vcutgeo</strong><a class="headerlink" href="#vcutgeo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> V (potential) CUT-off GEOmetry<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW- Lanczos-Sternheimer calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GWls">topic_GWls</a>, <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3 * 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> in [1,2]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
Test the 0D and 2D Coulomb cut-off functionality
in the ground state  for graphene." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t90.abi" target="_blank">t90.abi</a></li>
</ul>
</details>
<p><strong>vcutgeo</strong>  is used in conjunction with <a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> to specify the geometry
used to truncate the Coulomb interaction, as well as the particular approach
to be used. It has a meaning only for a periodic one-dimensional system, typically
a nanowire, nanotube or polymer surrounded by vacuum separating the system
from images in neighbouring cells
(<a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> = 1) or in the case of periodic two-dimensional system,
typically a slab with vacuum separating it from images in neighbouring cells ((<a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> = 2). For each
geometry, two different definitions of the cutoff region are available (see
<a class="wikilink citation-wikilink" data-content="Truncation of periodic image interactions for confined systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ismail-beigi2006">[Ismail-Beigi2006]</a> and <a class="wikilink citation-wikilink" data-content="Exact Coulomb cutoff technique for supercell calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#rozzi2006">[Rozzi2006]</a> for a complete description
of the methods)</p>
<p>In the method of Ismail-Beigi <a class="wikilink citation-wikilink" data-content="Truncation of periodic image interactions for confined systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ismail-beigi2006">[Ismail-Beigi2006]</a> for one-dimensional systems, the cutoff region is given by the
Wigner-Seitz cell centered on the axis of the cylinder. The cutoff region is
thus automatically defined by the unit cell and there is no need to specify
the value of <a class="wikilink codevar-wikilink" href="../gw#rcut">rcut</a>.</p>
<p>To define a cylinder along the z-axis use the following lines:
<div class="highlight"><pre><span></span><code>icutcoul 1
vcutgeo  0 0 1
</code></pre></div></p>
<p>Please note that the method of Ismail-Beigi is implemented only in the case of an
orthorhombic Bravais lattice. For hexagonal lattices, one has to use the method
of Rozzi <a class="wikilink citation-wikilink" data-content="Exact Coulomb cutoff technique for supercell calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#rozzi2006">[Rozzi2006]</a>. In this case, the interaction is truncated
in a finite cylinder. Contrarily to the first approach, the user has to
specify both the radius of the cylinder with <a class="wikilink codevar-wikilink" href="../gw#rcut">rcut</a> as well as the length of
the cylinder along the periodic dimension, that should always be smaller than
the extension of the Born von Karman box. The length of the cylinder is given
in terms of a multiple of the primitive vector along the periodic direction.
Another option provided by Rozzi <a class="wikilink citation-wikilink" data-content="Exact Coulomb cutoff technique for supercell calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#rozzi2006">[Rozzi2006]</a> is the infinite length cylinder.
In order to activate it in ABINIT,
one needs to use a very large negative  <strong>vcutgeo</strong>  value on the third direction
(i.e. vcutgeo(3) &lt;= -999).</p>
<p>For example, in order to define a finite cylinder along z of radius 2.5 Bohr
and length 3*R3,
<div class="highlight"><pre><span></span><code>icutcoul 1
vcutgeo  0 0 -3.0 # note the minus sign
rcut     2.5
</code></pre></div></p>
<p>For two-dimensional systems (<a class="wikilink codevar-wikilink" href="../gstate#icutcoul">icutcoul</a> = 2),  <strong>vcutgeo</strong>  is used to define the
two periodic directions. Also in this case two different
techniques are available. In the method of Ismail-Beigi, the (positive) non-zero
components of vcutgeo define the periodic directions of the infinite surface.
The interaction is truncated within a slab of width L where L is the length of
the primitive vector of the lattice along the non-periodic dimension. For
example:
<div class="highlight"><pre><span></span><code>icutcoul 2
vcutgeo  1 1 0
</code></pre></div>
At present, the implementation of the Beigi technique for two-dimensional systems is restricted
to the periodic directions being in the x-y plane.</p>
<p>In Rozzi&rsquo;s method, it is also possible to define a finite range
for the Coulomb interaction in the periodic directions by employing negative values. For example:
<div class="highlight"><pre><span></span><code>icutcoul 2
vcutgeo -3 -2 0
</code></pre></div>
<strong>Definition to be added</strong></p>
<p>Note that not all k-point grids are allowed in these 1D and 2D cases:
the k point vector component(s) along non-periodic direction(s) must vanish.
So, if the 2D Ismail-Beigi technique is used, the z-component of the k points must vanish.</p>
<h2 id="x1rdm"><strong>x1rdm</strong><a class="headerlink" href="#x1rdm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXchange-only 1-Reduced Density Matrix<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> == 4<br />
<em>Added in version:</em> 9.4.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/1087] in all abinit tests, [0/148] in abinit tutorials</summary><ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-content="
GW.at.KS density matrix test (Print new WFK and DEN files and compute energies)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Same as t33.out but reading some checkpoint (i.e. 1, 2, and 5) files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-content="
GW 1RDM update BUT using only Sigma_X (not including Sigma_c term)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v9/Input/t35.abi" target="_blank">t35.abi</a></li>
</ul>
</details>
<p><strong>x1rdm</strong> ==1 forces the update of the density-matrix using only the exchange operator (instead of exchange and GW correlation).
It must be used with <a class="wikilink codevar-wikilink" href="../gw#gwcalctyp">gwcalctyp</a>==21 and <a class="wikilink codevar-wikilink" href="../gw#gw1rdm">gw1rdm</a>&gt;0.</p>
<h2 id="zcut"><strong>zcut</strong><a class="headerlink" href="#zcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Z-CUT<br />
<em>Characteristics:</em> <a class="wikilink" href="../../guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How compute the frequency-dependent susceptibility matrix, and related screened interaction matrix, and inverse dielectric marix" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Susceptibility">topic_Susceptibility</a>, <a class="wikilink topic-wikilink" data-content="How to perform a Bethe-Salpeter calculation of neutral excitation energies and dielectric function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BSE">topic_BSE</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0036749326<br />
<em>Comment:</em> 0.1 eV (0.0036749326 Ha)<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> in [3, 4, 7, 99]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/1087] in all abinit tests, [8/148] in abinit tutorials</summary><ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="ZPR computation at the Gamma point for MgO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_4.abi" target="_blank">teph4zpr_4.abi</a>, <a class="wikilink abifile-wikilink" data-content="ZPR computation at Gamma for MgO. Convergence of ZPR wrt nband" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_5.abi" target="_blank">teph4zpr_5.abi</a>, <a class="wikilink abifile-wikilink" data-content="Convergence of ZPR wrt nband with the Sternheimer method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph4zpr_6.abi" target="_blank">teph4zpr_6.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline silicon
BS run: convergence in ecuteps" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_4.abi" target="_blank">tbs_4.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t64.abi" target="_blank">t64.abi</a>, <a class="wikilink abifile-wikilink" data-content="
SiC in zinc-blende structure
G0W0 calculation updating G and W by a scissor operator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t67.abi" target="_blank">t67.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-content="Random stopping power within RPA and TD-LDA" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
</ul>
</details>
<p>It is meant to avoid some divergences that might occur during the evaluation
of the Adler-Wiser expression of the irreducible polarizability
(<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 3) or during the numerical treatment of the integrals defining
the contribution to the self-energy matrix elements (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4). If the
denominator becomes smaller than <strong>zcut</strong>, a small imaginary part (depending
on <strong>zcut</strong>) is added, in order to avoid the divergence.</p>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 99, <strong>zcut</strong> defines the small complex shift used to avoid
divergences in the expression for the macroscopic dielectric function. It
simulates the experimental uncertainty and the finite lifetime of the
quasi-particles (although the true lifetime should be k- and band-dependent).
The value of <strong>zcut</strong> affects the number of iteration needed to achieve
convergence in the Haydock iterative method. In this case, <strong>zcut</strong> should be
larger than the typical distance between the eigenvalues of the exciton Hamiltonian.
Ideally, one should make a convergence study decreasing the value of <strong>zcut</strong>
for increasing number of k points.</p>
<p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 7, <strong>zcut</strong> defines the small complex shift used to avoid
divergences in the expression for the Fan-Migdal e-ph self-energy.
Note that the default value is too large for e-ph calculations, smaller values of the order
of 0.001 or 0.001 eV should be used (and carefully tested).</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorial/" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Tutorial" class="md-tabs__link">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../gstate/" title="Ground-State" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Ground-State
              </span>
            </div>
          </a>
        
        
          <a href="../internal/" title="Internal" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Internal
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>