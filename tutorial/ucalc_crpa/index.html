



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/ucalc_crpa/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Ucalc crpa - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#calculation-of-u-and-j-using-crpa" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  DFT_PLUS_U
                </span>
              
            
            Ucalc crpa
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" checked>
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Ucalc crpa
      </label>
    
    <a href="./" title="Ucalc crpa" class="md-nav__link md-nav__link--active">
      Ucalc crpa
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Using the constrained RPA to compute the U and J in the case of SrVO3." class="md-nav__link">
    Using the constrained RPA to compute the U and J in the case of SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="1 The cRPA method to compute effective interaction: summary and key parameters" class="md-nav__link">
    1 The cRPA method to compute effective interaction: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="3 Definition of screening and orbitals in cRPA: models, input file and log file" class="md-nav__link">
    3 Definition of screening and orbitals in cRPA: models, input file and log file
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-constrained-polarization-calculation" title="3.1. The constrained polarization calculation." class="md-nav__link">
    3.1. The constrained polarization calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier-functions" title="3.2. The input file for cRPA calculation: correlated orbitals, Wannier functions" class="md-nav__link">
    3.2. The input file for cRPA calculation: correlated orbitals, Wannier functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-the-first-dataset-a-converged-lda-calculation" title="3.2.1. The first DATASET: A converged LDA calculation" class="md-nav__link">
    3.2.1. The first DATASET: A converged LDA calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of-wannier-functions" title="3.2.2. The second DATASET: A converged LDA calculation and definition of Wannier functions" class="md-nav__link">
    3.2.2. The second DATASET: A converged LDA calculation and definition of Wannier functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-third-dataset-compute-the-constrained-polarizability-and-dielectric-function" title="3.2.2. The third DATASET: Compute the constrained polarizability and dielectric function" class="md-nav__link">
    3.2.2. The third DATASET: Compute the constrained polarizability and dielectric function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-the-fourth-dataset-compute-the-effective-interactions" title="3.2.3. The fourth DATASET: Compute the effective interactions" class="md-nav__link">
    3.2.3. The fourth DATASET: Compute the effective interactions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324-the-crpa-calculation-the-log-file-for-the-d-d-model" title="3.2.4 The cRPA calculation: the log file (for the d-d model)" class="md-nav__link">
    3.2.4 The cRPA calculation: the log file (for the d-d model)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-studies" title="4 Convergence studies" class="md-nav__link">
    4 Convergence studies
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-cutoff-in-energy-for-the-polarisability-ecuteps" title="4.1 Cutoff in energy for the polarisability ecuteps" class="md-nav__link">
    4.1 Cutoff in energy for the polarisability ecuteps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-number-of-bands-nband" title="4.2 Number of bands nband" class="md-nav__link">
    4.2 Number of bands nband
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-cutoff-in-energy-for-the-calculation-of-the-coulomb-interaction-ecutsigx" title="4.3 Cutoff in energy for the calculation of the Coulomb interaction ecutsigx" class="md-nav__link">
    4.3 Cutoff in energy for the calculation of the Coulomb interaction ecutsigx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-k-point" title="4.4 k-point" class="md-nav__link">
    4.4 k-point
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-effective-interactions-for-different-models" title="5 Effective interactions for different models" class="md-nav__link">
    5 Effective interactions for different models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-frequency-dependent-interactions" title="6 Frequency dependent interactions" class="md-nav__link">
    6 Frequency dependent interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-conclusion" title="7 Conclusion" class="md-nav__link">
    7 Conclusion
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Using the constrained RPA to compute the U and J in the case of SrVO3." class="md-nav__link">
    Using the constrained RPA to compute the U and J in the case of SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="1 The cRPA method to compute effective interaction: summary and key parameters" class="md-nav__link">
    1 The cRPA method to compute effective interaction: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="3 Definition of screening and orbitals in cRPA: models, input file and log file" class="md-nav__link">
    3 Definition of screening and orbitals in cRPA: models, input file and log file
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-constrained-polarization-calculation" title="3.1. The constrained polarization calculation." class="md-nav__link">
    3.1. The constrained polarization calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier-functions" title="3.2. The input file for cRPA calculation: correlated orbitals, Wannier functions" class="md-nav__link">
    3.2. The input file for cRPA calculation: correlated orbitals, Wannier functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-the-first-dataset-a-converged-lda-calculation" title="3.2.1. The first DATASET: A converged LDA calculation" class="md-nav__link">
    3.2.1. The first DATASET: A converged LDA calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of-wannier-functions" title="3.2.2. The second DATASET: A converged LDA calculation and definition of Wannier functions" class="md-nav__link">
    3.2.2. The second DATASET: A converged LDA calculation and definition of Wannier functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-third-dataset-compute-the-constrained-polarizability-and-dielectric-function" title="3.2.2. The third DATASET: Compute the constrained polarizability and dielectric function" class="md-nav__link">
    3.2.2. The third DATASET: Compute the constrained polarizability and dielectric function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-the-fourth-dataset-compute-the-effective-interactions" title="3.2.3. The fourth DATASET: Compute the effective interactions" class="md-nav__link">
    3.2.3. The fourth DATASET: Compute the effective interactions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324-the-crpa-calculation-the-log-file-for-the-d-d-model" title="3.2.4 The cRPA calculation: the log file (for the d-d model)" class="md-nav__link">
    3.2.4 The cRPA calculation: the log file (for the d-d model)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-studies" title="4 Convergence studies" class="md-nav__link">
    4 Convergence studies
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-cutoff-in-energy-for-the-polarisability-ecuteps" title="4.1 Cutoff in energy for the polarisability ecuteps" class="md-nav__link">
    4.1 Cutoff in energy for the polarisability ecuteps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-number-of-bands-nband" title="4.2 Number of bands nband" class="md-nav__link">
    4.2 Number of bands nband
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-cutoff-in-energy-for-the-calculation-of-the-coulomb-interaction-ecutsigx" title="4.3 Cutoff in energy for the calculation of the Coulomb interaction ecutsigx" class="md-nav__link">
    4.3 Cutoff in energy for the calculation of the Coulomb interaction ecutsigx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-k-point" title="4.4 k-point" class="md-nav__link">
    4.4 k-point
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-effective-interactions-for-different-models" title="5 Effective interactions for different models" class="md-nav__link">
    5 Effective interactions for different models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-frequency-dependent-interactions" title="6 Frequency dependent interactions" class="md-nav__link">
    6 Frequency dependent interactions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-conclusion" title="7 Conclusion" class="md-nav__link">
    7 Conclusion
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/ucalc_crpa.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="calculation-of-u-and-j-using-crpa">Calculation of U and J using cRPA<a class="headerlink" href="#calculation-of-u-and-j-using-crpa" title="Permanent link">&para;</a></h1>
<h2 id="using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3">Using the constrained RPA to compute the U and J in the case of SrVO<sub>3</sub>.<a class="headerlink" href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to perform a calculation of <em>U</em> and <em>J</em> in
Abinit using cRPA. This method is well adapted in particular to determine <em>U</em>
and <em>J</em> as they can be used in DFT+DMFT. The implementation is described in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>.</p>
<p>It might be useful that you already know how to do PAW calculations using
ABINIT but it is not mandatory (you can follow the two tutorials on PAW in
ABINIT (<a href="../paw1">PAW1</a>, <a href="../paw2">PAW2</a>)).
The DFT+<em>U</em> tutorial in ABINIT (<a href="../dftu">DFT+U</a>) might be useful to know some
basic variables about correlated orbitals.</p>
<p>The first GW tutorial in ABINIT (<a href="../gw1">GW</a>) is useful to learn how
to compute the screening, and how to converge the relevant parameters
(energy cutoffs and number of bands for the polarizability).</p>
<p>This tutorial should take two hours to complete (you should have access to more than 8 processors).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters">1 The cRPA method to compute effective interaction: summary and key parameters<a class="headerlink" href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="Permanent link">&para;</a></h2>
<p>The cRPA method aims at computing the effective interactions among correlated
electrons. Generally, these highly correlated materials contain rare-earth
metals or transition metals, which have partially filled <em>d</em> or <em>f</em> bands and
thus localized electrons. cRPA relies on the fact that screening processes can
be decomposed in two steps: Firstly, the bare Coulomb interaction is screened
by non correlated electrons to produce the effective interaction <em>W<sub>r</sub></em>.</p>
<p>Secondly, correlated electrons screened this interaction to produce the fully
screening interaction <em>W</em> <a class="wikilink citation-wikilink" data-content="Frequency-dependent local interactions and low-energy effective models from electronic structure calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#aryasetiawan2004">[Aryasetiawan2004]</a>). However, the second
screening process is taken into account when one uses a method which describes
accurately the interaction among correlated electrons (such as Quantum Monte
Carlo within the DFT+DMFT method). So, to avoid a double counting of screening
by correlated electrons, the DFT+DMFT methods needs as an input the effective
interaction <em>W<sub>r</sub></em>. The goal of this tutorial is to present the implementation
of this method using Projected Local Orbitals Wannier orbitals in ABINIT (The
implementation of cRPA in ABINIT is described in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> and projected
local orbitals Wannier functions are presented in <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>). The
discussion about the localization of Wannier orbitals has some similarities
with the beginning on the DMFT tutorial (see <a href="../dmft/#1">here</a> and <a href="../dmft/#2">there</a>)</p>
<p>Several parameters (both physical and technical) are important for the cRPA calculation:</p>
<ul>
<li>
<p><strong>The definition of correlated orbitals.</strong> The first part of the tutorial is similar to the DMFT tutorial
    and explains the electronic structure of SrVO<sub>3</sub> and will be used to understand the definition of
    Wannier orbitals with various extensions. Wannier functions are unitarily related to a selected
    set of Kohn Sham (KS) wavefunctions, specified in ABINIT by band index <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>, and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>.
    Thus, as empty bands are necessary to build Wannier functions, it is required in DMFT or cRPA calculations
    that the KS Hamiltonian is correctly diagonalized: use high values for <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>
    for cRPA and DMFT calculations and preceding DFT calculations. Another solution used in the present tutorial
    is to use a specific non self-consistent calculation to diagonalize the hamiltonian, as in <em>GW</em> calculations.
    Concerning the localization or correlated orbitals, generally, the larger <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>-<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a> is,
    the more localized is the radial part of the Wannier orbital. Finally, note that Wannier orbitals
    are used in DMFT and cRPA implementations but this is not the most usual choice of correlated orbitals
    in the DFT+<em>U</em> implementation in particular in ABINIT (see <a class="wikilink citation-wikilink" data-content=" and  cerium: LDA+U calculations of ground-state parameters" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008a">[Amadon2008a]</a>).
    The relation between the two expressions is briefly discussed in <a class="wikilink citation-wikilink" data-content="DFT+$U$ study of self-trapping, trapping, and mobility of oxygen-type hole polarons in barium stannate" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#geneste2017">[Geneste2017]</a>.</p>
</li>
<li>
<p><strong>The constrained polarization calculation.</strong> As we will discuss in section
    2, there are different ways to define the constrained polarizability, by suppressing in the polarization,
    some electronic transitions: As discussed in section I of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>, one can either suppress
    electronic transition inside a given subset of Kohn-Sham bands. In this case, one can use <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa">ucrpa</a>=1,
    and choose the first and last bands defining the subset of bands by using variable <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a>.
    One can also use an energy windows instead of a number of bands by using <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_window">ucrpa_window</a>.
    Another solution is to use a weighting scheme which lowers the contribution of a given transition,
    as a function of the weight of correlated orbitals on the bands involved in the transition
    (see Eq. (5) and (7) in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). In this case, on still use the variable <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a>.
    The variable will in this case be used to define Projected Local Orbitals Wannier functions that will then
    be used to define the weighting function in the polarizability. (see Eq. (5) and (7) in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>).</p>
</li>
<li>
<p><strong>Convergence parameters</strong> are the same as for a polarizability calculation for the screening calculation
    (<a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>) and the same as for the exchange part of <em>GW</em> for the effective interaction,
    ie <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>. It is recommended, as discussed in appendix A of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>, to use <a class="wikilink codevar-wikilink" href="../../variables/paw#pawoptosc">pawoptosc</a>=1.
    If the calculation is carried out with several atoms, use <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1, the calculation is not symmetrized
    over atoms in this case.</p>
</li>
</ul>
<h2 id="2-electronic-structure-of-srvo3-in-lda">2 Electronic Structure of SrVO3 in LDA<a class="headerlink" href="#2-electronic-structure-of-srvo3-in-lda" title="Permanent link">&para;</a></h2>
<p><em>Before continuing, you might consider to work in a different subdirectory as
for the other tutorials. Why not Work_crpa?
In what follows, the name of files are mentioned as if you were in this subdirectory.
All the input files can be found in the <code>$ABI_TESTS/tutoparal/Input</code> directory.</em></p>
<p>Copy the files <em>tucrpa_1.abi</em> from <em>ABI_TESTS/tutoparal/Input</em> to <em>Work_crpa</em> with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$ABI_TESTS</span>/tutoparal/Input
mkdir Work_crpa
<span class="nb">cd</span> Work_crpa
cp ../tucrpa_1.abi .
</code></pre></div>
<p>and run the code with:</p>
<div class="codehilite"><pre><span></span><code>mpirun -n 32 abinit tucrpa_1.abi &gt; log_1  &amp;
</code></pre></div>

<p>This run should take some time. It is recommended that you use at least 10
processors (and 32 should be fast). It calculates the LDA ground state of
SrVO3 and compute the band structure in a second step. The variable
<a class="wikilink codevar-wikilink" href="../../variables/paw#pawfatbnd">pawfatbnd</a> allows to create files with &ldquo;fatbands&rdquo; (see description of the
variable in the list of variables): the width of the line along each k-point
path and for each band is proportional to the contribution of a given atomic
orbital on this particular Kohn Sham Wavefunction. A low cutoff and a small
number of k-points are used in order to speed up the calculation. During this
time you can take a look at the input file.</p>
<p>There are two datasets.
The first one is a ground state calculations with <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a>=3 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>=3 in order
to have well diagonalized eigenfunctions even for empty states. In practice,
you have however to check that the residue of wavefunctions is small at the
end of the calculation. In this calculation, we find 1.E-06, which is large
(1.E-10 would be better, so <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a> and <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a> should be increased, but
it would take more time). When the calculation is finished, you can plot the
fatbands for Vanadium and <em>l=2</em> with</p>
<div class="codehilite"><pre><span></span><code>xmgrace tucrpa_O_DS2_FATBANDS_at0001_V_is1_l0002 -par ../Input/tdmft_fatband.par
</code></pre></div>

<p>The band structure is given in eV.</p>
<p><img alt="FatbandV" src="../ucalc_crpa_assets/fatbandsV.jpeg" /></p>
<p>and the fatbands for all Oxygen atoms and <em>l=1</em> with</p>
<div class="codehilite"><pre><span></span><code>xmgrace tucrpa_O_DS2_FATBANDS_at0003_O_is1_l0001 tucrpa_O_DS2_FATBANDS_at0004_O_is1_l0001 tucrpa_O_DS2_FATBANDS_at0005_O_is1_l0001 -par ../Input/tdmft_fatband.par
</code></pre></div>

<p><img alt="FatbandV" src="../ucalc_crpa_assets/fatbandsO.jpeg" /></p>
<p>In these plots, you recover the band structure of SrVO3 (see for comparison
the band structure of Fig.3 of <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>), and the main character of the
bands. Bands 21 to 25 are mainly <em>d</em> and bands 12 to 20 are mainly oxygen <em>p</em>.
However, we clearly see an important hybridization. The Fermi level (at 0 eV)
is in the middle of bands 21-23.</p>
<p>One can easily check that bands 21-23 are mainly <em>d-t<sub>2g</sub></em> and bands 24-25 are
mainly <em>e<sub>g</sub></em>: just use <a class="wikilink codevar-wikilink" href="../../variables/paw#pawfatbnd">pawfatbnd</a> = 2 in <em>tucrpa_1.abi</em> and relaunch the
calculations. Then the file <em>tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m-2</em>,
<em>tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m-1</em> and
<em>tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m1</em> give you respectively the <em>xy</em>, <em>yz</em> and
<em>xz</em> fatbands (ie <em>d-t<sub>2g</sub></em>) and <em>tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m+0</em> and
<em>tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m+2</em> give the <em>z<sup>2</sup></em> and <em>x<sup>2</sup>-y<sup>2</sup></em> fatbands
(ie <em>e<sub>g</sub></em>).</p>
<p>So in conclusion of this study, the Kohn Sham bands which are mainly <em>t<sub>2g</sub></em>
are the bands 21, 22 and 23.</p>
<p>Of course, it could have been anticipated from classical crystal field theory:
the vanadium is in the center of an octahedron of oxygen atoms, so <em>d</em>
orbitals are split in <em>t<sub>2g</sub></em> and <em>e<sub>g</sub></em>. As <em>t<sub>2g</sub></em> orbitals are not directed
toward oxygen atoms, <em>t<sub>2g</sub></em>-like bands are lower in energy and filled with one
electron, whereas <em>e<sub>g</sub></em>-like bands are higher and empty.</p>
<p>In the next section, we will thus use the <em>d</em> -like bands to built Wannier
functions and compute effective interactions for these orbitals.</p>
<h2 id="3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file">3 Definition of screening and orbitals in cRPA: models, input file and log file<a class="headerlink" href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="Permanent link">&para;</a></h2>
<h3 id="31-the-constrained-polarization-calculation">3.1. The constrained polarization calculation.<a class="headerlink" href="#31-the-constrained-polarization-calculation" title="Permanent link">&para;</a></h3>
<p>As discussed briefly in Appendix A of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> as well as in section III
B of <a class="wikilink citation-wikilink" data-content="HubbardUand Hund exchangeJin transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a> and Section II B of <a class="wikilink citation-wikilink" data-content="First-principles calculations of dynamical screened interactions for the transition metal oxidesMO (M=Mn, Fe, Co, Ni)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#sakuma2013">[Sakuma2013]</a>, one can use different
schemes for the cRPA calculations. Let us discuss these different models
namely the ( <em>d-d</em> ), ( <em>dp-dp</em> ), ( <em>d-dp</em> (a)), and ( <em>d-dp</em> (b)) models.
In the notation (A-B), A and B refers respectively to some bands of A-like and
B-like character. Moreover, A refers to the definition of screening and B
refers to the definition of correlated orbitals. To clarify this definition,
we give below some examples:</p>
<ul>
<li>( <strong><em>t<sub>2g</sub>-t<sub>2g</sub></em></strong>) model (or <em>t<sub>2g</sub></em> model): The correlated orbitals are defined with only <em>t<sub>2g</sub></em>-like bands (bands 21, 22 and 23). The screening inside these bands is not taken into account to built the constrained polarizability. Note that if this case (and in the ( <em>d-d</em> ) and ( <em>dp-dp</em> ) models), using <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa">ucrpa</a>=1 or 2 give the same results, provided one uses <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a> equal to (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a> <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a> ).</li>
<li>( <strong><em>d-d</em></strong> ) model (or d model): The correlated orbitals are defined with only <em>d</em> -like bands (bands 21 to 25). The screening inside these bands is not taken into account.</li>
<li>( <strong><em>dp-dp</em></strong> ) model (or dp model): The correlated orbitals are defined with only <em>d</em> -like and Op-like bands (bands 12 to 23). The screening inside these bands is not taken into account.</li>
<li>( <strong><em>d-dp (a)</em></strong>) model: In this scheme the Wannier orbitals are constructed as in the ( <em>dp-dp</em> ) model. However, in this scheme, one only supresses the screening inside <em>d</em> -like bands (<a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa">ucrpa</a>=1). It is coherent with the fact that the DMFT will only be applied to the d orbitals: so the screening for Op-like bands need to be taken into account.</li>
<li>( <strong><em>d-dp (b)</em></strong>) model: It is the same model as the ( <em>d-dp</em> (a)), nevertheless, in this case, only the weighting scheme is used (<a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa">ucrpa</a>=2 in ABINIT).
Which way of computing interactions is the most relevant depends on the way
the interactions will be used. Some aspects of it are discussed in Ref.
<a class="wikilink citation-wikilink" data-content="HubbardUand Hund exchangeJin transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a>. Also, for Mott insulators, and if self-consistency over
interactions is carried out, the choice of models is discussed in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>.</li>
</ul>
<h3 id="32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier-functions">3.2. The input file for cRPA calculation: correlated orbitals, Wannier functions<a class="headerlink" href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier-functions" title="Permanent link">&para;</a></h3>
<p>In this section, we will present the input variables and discuss how to
extract useful information in the log file in the case of the <em>d-d</em> model. The
input file for a typical cRPA calculation (<em>tucrpa_2.abi</em>) contains four datasets
(as usual <em>GW</em> calculations, see the <a href="../gw1/#1a">GW tutorial</a>): the
first one is a well converged LDA calculation, the second is non self-consistent calculation
to compute accurately full and empty states, the third
computes the constrained non interacting polarizability, and the fourth
computes effective interaction parameters <em>U</em> and <em>J</em>. We discuss these four
datasets in the next four subsections.</p>
<p>Copy the file in your <em>Work_crpa</em> directory with:</p>
<div class="highlight"><pre><span></span><code>cp ../tucrpa_2.abi .
</code></pre></div>
<p>The input file <em>tucrpa_2.abi</em> contains standard data to perform a LDA
calculation on SrVO<sub>3</sub>. We focus in the next subsections on some peculiar input
variables related to the fact that we perform a cRPA calculation. Before
reading the following section, launch the abinit calculation:</p>
<div class="codehilite"><pre><span></span><code>abinit tucrpa_2.abi &gt; log_2
</code></pre></div>

<h5 id="321-the-first-dataset-a-converged-lda-calculation">3.2.1. The first DATASET: A converged LDA calculation<a class="headerlink" href="#321-the-first-dataset-a-converged-lda-calculation" title="Permanent link">&para;</a></h5>
<p>The first dataset is a simple calculation of the density using LDA using 50
bands. We do not use symmetry in this calculation, so <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1. If symmetry
is used (<a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=0), then the calculation of <em>U</em> and <em>J</em> will be valid, but
the full interaction matrix described in section 3.2.4 will not be correct.</p>
<h5 id="322-the-second-dataset-a-converged-lda-calculation-and-definition-of-wannier-functions">3.2.2. The second DATASET: A converged LDA calculation and definition of Wannier functions<a class="headerlink" href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of-wannier-functions" title="Permanent link">&para;</a></h5>
<p>Before presenting the input variables for this dataset, we discuss two
important physical parameters relevant to this dataset.</p>
<ul>
<li>
<p>Diagonalization of Kohn-Sham Hamiltonian: As in the case of DFT+DMFT or <em>GW</em> calculation, a cRPA calculation requires that the LDA is perfectly converged and the Kohn Sham eigenstates are precisely determined, including the empty states. Indeed these empty states are necessary both to build Wannier functions and to compute the polarizability. For this reason we choose a very low value of <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a> in the input file tucrpa_1.abi.</p>
</li>
<li>
<p>Wannier functions: Once the calculation is converged, we compute Wannier functions, as in a DFT+DMFT calculation. To do this, we only precise that we are using the DFT+DMFT implementation (usedmft=0), but only with the Wannier keywords (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>). We emphasize that with respect to the discussion on models on section 3.1, <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a> are used to define the so called A bands. We will see in dataset 2 how B bands are defined. In our case, as we are in the <em>d-d</em> model, we choose only the <em>d</em> -like bands as a starting point and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a> are thus equal to the first and last <em>d</em> -like bands, namely 21 and 25.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>    iscf2          -2    # Perform a non self-consistent calculation
    nbandkss2      -1    # Number of bands in KSS file (-1 means the
                         #   maximum possible)
    kssform         3    # Format of the Wavefunction file (should be 3)
    nbdbuf2         4    # The last four bands will not be perfectly
                         # diagonalized
    tolwfr2   1.0d-18    # The criterion to stop diagonalization

    # Compute Wannier functions
    usedmft2        1    # Mandatory to enable the calculation of Wannier
                         #  functions as in DMFT.
    dmftbandi2     21    # Precise the definition of Wannier functions
    dmftbandf2     25    # Precise the definition of Wannier functions
</code></pre></div>
<h5 id="322-the-third-dataset-compute-the-constrained-polarizability-and-dielectric-function">3.2.2. The third DATASET: Compute the constrained polarizability and dielectric function<a class="headerlink" href="#322-the-third-dataset-compute-the-constrained-polarizability-and-dielectric-function" title="Permanent link">&para;</a></h5>
<p>The third DATASET drives the computation of the constrained polarizability and
the dielectric function. Again, we reproduce below the input variables
peculiar to this dataset.</p>
<p>We add some comments here on three most important topics</p>
<ul>
<li>Definition of constrained polarizability: As in the discussion on models on section 3.1, the constrained polarizability is defined thanks to B-like bands. The keywords related to this definition is <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a>. According to the value of ucrpa, <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a> defined the bands for which the transitions are neglected, or (if ucrpa=2), it defined Wannier functions that are used in the weighting scheme (see Eq. (5) and (7) of section II of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). Alternatively and only if ucrpa=1, an energy windows can be defined (with variable <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_window">ucrpa_window</a>) to exclude the transition. In our case, as we are in the <em>d-d</em> model, we neglect transitions inside the <em>d</em> -like bands, so we choose <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a>= 21 25.</li>
<li>Convergence of the polarizability: <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> are the two main variables that should be converged. Note that one must study the role of these variables directly on the effective interaction parameters to determine their relevant values.</li>
<li>Frequency mesh  of the polarizability: Can be useful if one wants to plot the frequency dependence of the effective interactions (as in e.g. <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>).</li>
</ul>
<div class="highlight"><pre><span></span><code>optdriver3     3     # Keyword to launch the calculation of screening
gwcalctyp3     2     # The screening will be used later with gwcalctyp 2
                     # in the next dataset
getwfk3       -1     # Obtain WFK file from previous dataset
ecuteps3     5.0     # Cut-off energy of the planewave set to represent
                     #   the dielectric matrix.
                     # It is important to converge effective interactions
                     #   as a function of this parameter.

# -- Frequencies for dielectric matrix
nfreqre3       1     # Number of  real frequencies
freqremax3    10 eV  # Maximal value of frequencies
freqremin3     0 eV  # Minimal value of frequencies
nfreqim3       0     # Number of  imaginary frequencies

# -- Ucrpa: screening
ucrpa_bands3  21 25  # Define the bands corresponding to the _d_ contribution

# -- Parallelism
gwpara3        1
</code></pre></div>
<h5 id="323-the-fourth-dataset-compute-the-effective-interactions">3.2.3. The fourth DATASET: Compute the effective interactions<a class="headerlink" href="#323-the-fourth-dataset-compute-the-effective-interactions" title="Permanent link">&para;</a></h5>
<p>The fourth DATASET drives the computation of the effective interactions. It is
similar computationally to the computation of exchange in <em>GW</em> calculations.
Again, we reproduce below the input variables peculiar to this dataset.</p>
<p>We add some comments on convergence properties</p>
<ul>
<li>
<p>Convergence as the number of plane waves:  Eq. (A1) and (A2) in Appendix A of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>
    show the summation over plane waves which is performed. The cutoff on plane wave which is used
    in this summation is <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> because of the similarity of Eq. A2 with the Fock exchange
    (see <a class="wikilink theory-wikilink" href="../../theory/mbt#evaluation_gw_sigma">GW notes</a> when one computes the bare interaction. <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>
    is thus the main convergence parameter for this dataset. Note that as discussed in Appendix A of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>,
    high values of <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> can be necessary because oscillator matrix elements in PAW contains
    the Fourier transform of (a product of) atomic orbitals.</p>
</li>
<li>
<p>The frequency mesh  must be the same as in the DATASET 2.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>     optdriver4  4      # Self-Energy calculation
     gwcalctyp4  2      # activate HF or ucrpa
     getwfk4     1      # Obtain WFK file from dataset 1
     getscr4     2      # Obtain SCR file from previous dataset
     ecutsigx4  30.0    # Dimension of the G sum in Sigma_x.

     # -- Frequencies for effective interactions
     nfreqsp4    1
     freqspmax4 10 eV
     freqspmin4  0 eV
     nkptgw4     0      # number of k-point where to calculate
                        # the GW correction: all BZ is used
     mqgrid4   300      # Reduced but fine at least for SrVO3
     mqgriddg4 300      # Reduced but fine at least for SrVO3

     # -- Parallelism
     gwpara4 2          # do not change if nsppol=2
</code></pre></div>
<h5 id="324-the-crpa-calculation-the-log-file-for-the-d-d-model">3.2.4 The cRPA calculation: the log file (for the <em>d-d</em> model)<a class="headerlink" href="#324-the-crpa-calculation-the-log-file-for-the-d-d-model" title="Permanent link">&para;</a></h5>
<p>We are now going to browse quickly the log file for this calculation.</p>
<ul>
<li>Bare interaction of atomic orbitals.</li>
</ul>
<p>First, at the beginning of the log file, you will find the calculation of the
bare interaction for the atomic wavefunction corresponding the angular
momentum specified by <a class="wikilink codevar-wikilink" href="../../variables/paw#lpawu">lpawu</a>, in the input file (here <a class="wikilink codevar-wikilink" href="../../variables/paw#lpawu">lpawu</a> =2). It is
a simple fast direct integration. Note that this information is complete only
if you use XML PAW atomic data (as the one available on the JTH table
available on the ABINIT website).</p>
<div class="highlight"><pre><span></span><code>      =======================================================================
      == Calculation of diagonal bare Coulomb interaction on ATOMIC orbitals
         (it is assumed that the wavefunction for the first reference
                 energy in PAW atomic data is an atomic eigenvalue)

     Max value of the radius in atomic data file   =    201.3994
     Max value of the mesh   in atomic data file   =    910
     PAW radius is                                 =      2.2000
     PAW value of the mesh for integration is      =    587
     Integral of atomic wavefunction until rpaw    =      0.8418

     For an atomic wfn truncated at rmax =    201.3994
         The norm of the wfn is                    =      1.0000
         The bare interaction (no renormalization) =     17.7996 eV
         The bare interaction (for a renorm. wfn ) =     17.7996 eV

     For an atomic wfn truncated at rmax =      2.2000
         The norm of the wfn is                    =      0.8418
         The bare interaction (no renormalization) =     16.0038 eV
         The bare interaction (for a renorm. wfn ) =     22.5848 eV
     =======================================================================
</code></pre></div>
<p>Various quantities are computed, the one which is interesting to see here, is
the bare interaction computed for a wavefunction truncated at a very large
radius (here 201.3994 au ), ie virtually infinite. We find that this bare
interaction is 17.8 eV. We will compare below this value to the bare
interaction computed on Wannier orbitals.</p>
<ul>
<li>Bare Coulomb direct interaction of Wannier orbitals. In the third dataset, the code writes the Coulomb interaction matrix as:</li>
</ul>
<div class="highlight"><pre><span></span><code>          U&#39;=U(m1,m2,m1,m2) for the bare interaction
     -      1      2      3      4      5
       1 16.041 14.898 14.885 14.898 15.715
       2 14.898 16.041 15.508 14.898 15.092
       3 14.885 15.508 16.567 15.508 15.114
       4 14.898 14.898 15.508 16.041 15.092
       5 15.715 15.092 15.114 15.092 16.567
</code></pre></div>
<ul>
<li>First we see that diagonal interactions are larger than off-diagonal terms,
   which is logical, because electron interaction is larger if electrons are located in the same orbital.</li>
<li>We recover in these interaction matrix the degeneracy of <em>d</em> orbitals in the cubic symmetry
   (we remind, as listed in <a class="wikilink codevar-wikilink" href="../../variables/paw#dmatpawu">dmatpawu</a>, that the order of orbitals in ABINIT are <em>xy</em>, <em>yz</em>,
   <em>z<sup>2&lt;\sup&gt;</em>, <em>xy</em>, <em>x<sup>2</sup>-y<sup>2</sup></em>).</li>
<li>We note also that the interaction for <em>t<sub>2g</sub></em> and <em>e<sub>g</sub></em> orbitals are not the same.
   This effect is compared in e.g. Appendix C.1 of <a class="wikilink citation-wikilink" data-content="HubbardUand Hund exchangeJin transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a> to the usual
   Slater parametrization of interaction matrices.</li>
<li>Diagonal bare interactions are smaller to the bare interaction on atomic orbitals
   (17.8 eV, as discussed above). It shows that the Wannier functions (obtained within the <em>d-d</em> model)
   are less localized than atomic orbitals. It is logical because these Wannier functions contain indeed
   a weight on O- <em>p</em> orbitals.</li>
<li>From this interaction matrix, one can compute the average of all elements (the famous <em>U</em> ),
   as well as the average of diagonal elements, which is sometimes used as another definition of <em>U</em>
   (see Eq. (8) and (9) of <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>. The two quantities are written in the log file:</li>
</ul>
<div class="highlight"><pre><span></span><code>    Hubbard bare interaction U=1/(2l+1)**2 \sum U(m1,m2,m1,m2)=   15.3789    0.0000

(Hubbard bare interaction U=1/(2l+1) \sum U(m1,m1,m1,m1)=   16.2514    0.0000)
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To speed up the calculation and if one needs only these average values of <em>U</em>
and <em>J</em>, one can use <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a> = 0 in the input file, but in this case, the
interaction matrix does not anymore reproduce the correct symmetry. For
several correlated atoms, the implementation is under test and it is mandatory to use <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1.]</p>
</div>
<ul>
<li>Bare exchange interaction. The exchange interaction matrix is also written as well
    as the average of off-diagonal elements, which is <em>J</em>.</li>
</ul>
<div class="highlight"><pre><span></span><code>       Hund coupling J=U(m1,m1,m2,m2) for the bare interaction
         1      2      3      4      5
    1 16.041  0.482  0.555  0.478  0.249
    2  0.482 16.041  0.329  0.478  0.478
    3  0.555  0.329 16.567  0.400  0.555
    4  0.478  0.478  0.400 16.041  0.482
    5  0.249  0.478  0.555  0.482 16.567

    bare interaction value of J=U-1/((2l+1)(2l)) \sum_{m1,m2} (U(m1,m2,m1,m2)-U(m1,m1,m2,m2))=    0.6667    0.0000
</code></pre></div>
<ul>
<li>Then, the cRPA effective interactions are given for all frequency.
     The first frequency is zero and the cRPA interactions are:</li>
</ul>
<div class="highlight"><pre><span></span><code>     U&#39;=U(m1,m2,m1,m2) for the cRPA interaction
       1      2      3      4      5
  1  3.434  2.432  2.338  2.432  2.966
  2  2.432  3.434  2.809  2.432  2.495
  3  2.338  2.809  3.641  2.809  2.430
  4  2.432  2.432  2.809  3.434  2.495
  5  2.966  2.495  2.430  2.495  3.641

 Hubbard cRPA interaction for w =  1, U=1/(2l+1)**2 \sum U(m1,m2,m1,m2)=    2.7546   -0.0000

 (Hubbard cRPA interaction for w =   1, U=1/(2l+1) \sum U(m1,m1,m1,m1)=    3.5167   -0.0000)

 Hund coupling J=U(m1,m1,m2,m2) for the cRPA interaction
       1      2      3      4      5
  1  3.434  0.440  0.508  0.435  0.247
  2  0.440  3.434  0.315  0.436  0.442
  3  0.508  0.315  3.641  0.378  0.444
  4  0.435  0.436  0.378  3.434  0.446
  5  0.247  0.442  0.444  0.446  3.641

  cRPA interaction value of J=U-1/((2l+1)(2l)) \sum_{m1,m2} (U(m1,m2,m1,m2)-U(m1,m2,m2,m1))=    0.5997    0.0000
</code></pre></div>
<ul>
<li>At the end of the calculation, the value of <em>U</em> and <em>J</em> as a function of frequency are gathered.</li>
</ul>
<div class="highlight"><pre><span></span><code>       -------------------------------------------------------------
                Average U and J as a function of frequency
       -------------------------------------------------------------
             omega           U(omega)            J(omega)
            0.000      2.7546   -0.0000      0.5997    0.0000
       -------------------------------------------------------------
</code></pre></div>
<h2 id="4-convergence-studies">4 Convergence studies<a class="headerlink" href="#4-convergence-studies" title="Permanent link">&para;</a></h2>
<p>We give here the results of some convergence studies, than can be made by the
readers. Some are computationally expensive. It is recommanded to use at least
32 processors. Input file is provided in <em>tucrpa_3.abi</em> for the first case.</p>
<h3 id="41-cutoff-in-energy-for-the-polarisability-ecuteps">4.1 Cutoff in energy for the polarisability <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a><a class="headerlink" href="#41-cutoff-in-energy-for-the-polarisability-ecuteps" title="Permanent link">&para;</a></h3>
<p>The number of plane waves used in the calculation of the cRPA polarizability
is determined by <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> (see <a class="wikilink theory-wikilink" href="../../theory/mbt#RPA_Fourier_space">Notes on RPA calculations</a>).
The convergence can be studied simply by increasing the values of <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> and gives:</p>
<p><center></p>
<table>
<thead>
<tr>
<th><a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> (Ha)</th>
<th><em>U</em> (eV)</th>
<th><em>J</em> (eV)</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>3.22</td>
<td>0.63</td>
</tr>
<tr>
<td>5</td>
<td>3.01</td>
<td>0.60</td>
</tr>
<tr>
<td>7</td>
<td>2.99</td>
<td>0.59</td>
</tr>
<tr>
<td>9</td>
<td>2.99</td>
<td>0.58</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>So, for <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=30, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30 and a 4x4x4 k-point grid, the effective
interactions are converged with a precision of 0.02 eV for <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=5.</p>
<h3 id="42-number-of-bands-nband">4.2 Number of bands <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a><a class="headerlink" href="#42-number-of-bands-nband" title="Permanent link">&para;</a></h3>
<p>The RPA polarizability depends also of the number of Kohn-Sham bands as also
discussed in the <a class="wikilink theory-wikilink" href="../../theory/mbt#RPA_Fourier_space">Notes on RPA calculations</a>)</p>
<p><center></p>
<table>
<thead>
<tr>
<th><a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a></th>
<th><em>U</em> (eV)</th>
<th><em>J</em> (eV)</th>
</tr>
</thead>
<tbody>
<tr>
<td>30</td>
<td>3.01</td>
<td>0.61</td>
</tr>
<tr>
<td>50</td>
<td>2.75</td>
<td>0.60</td>
</tr>
<tr>
<td>70</td>
<td>2.71</td>
<td>0.59</td>
</tr>
<tr>
<td>90</td>
<td>2.70</td>
<td>0.59</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>So, for <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=5, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30 and a 4x4x4 k-point grid, the effective
interactions are converged with a precision of 0.05 eV for <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=50.</p>
<h3 id="43-cutoff-in-energy-for-the-calculation-of-the-coulomb-interaction-ecutsigx">4.3 Cutoff in energy for the calculation of the Coulomb interaction <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a><a class="headerlink" href="#43-cutoff-in-energy-for-the-calculation-of-the-coulomb-interaction-ecutsigx" title="Permanent link">&para;</a></h3>
<p><a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> is the input variable determining the number of plane waves used
in the calculation of the exchange part of the self-energy. The same variable
is used here to determine the number of plane waves used in the calculation of
the effective interaction. The study of the convergence gives:</p>
<p><center></p>
<table>
<thead>
<tr>
<th><a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> (Ha)</th>
<th><em>U</em><sub>bare</sub> (eV)</th>
<th><em>J</em><sub>bare</sub> (eV)</th>
<th><em>U</em> (eV)</th>
<th><em>J</em> (eV)</th>
</tr>
</thead>
<tbody>
<tr>
<td>30</td>
<td>15.38</td>
<td>0.67</td>
<td>3.22</td>
<td>0.63</td>
</tr>
<tr>
<td>50</td>
<td>15.38</td>
<td>0.68</td>
<td>3.22</td>
<td>0.65</td>
</tr>
<tr>
<td>70</td>
<td>15.38</td>
<td>0.69</td>
<td>3.22</td>
<td>0.66</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>For <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=3, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=30 and a 4 4 4 k-point grid, effective
interactions are converged with a precision of 0.02 eV for <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30 Ha.</p>
<h3 id="44-k-point">4.4 k-point<a class="headerlink" href="#44-k-point" title="Permanent link">&para;</a></h3>
<p>The dependence of effective interactions with the k-point grid is also important to check.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>kpoint grid</th>
<th><em>U</em><sub>bare</sub> (eV)</th>
<th><em>J</em><sub>bare</sub> (eV)</th>
<th><em>U</em> (eV)</th>
<th><em>J</em> (eV)</th>
</tr>
</thead>
<tbody>
<tr>
<td>4 4 4</td>
<td>15.38</td>
<td>0.65</td>
<td>3.22</td>
<td>0.63</td>
</tr>
<tr>
<td>6 6 6</td>
<td>15.36</td>
<td>0.66</td>
<td>3.18</td>
<td>0.62</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>For <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=3, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=30 and <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30, effective interactions
are converged to 0.01 eV for a k-point grid of 6 6 6. The converged parameters
are thus <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=5,<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30,ngkpt=6 6 6, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=50 with an
expected precision of 0.1 eV. We will use instead
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=5,<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=30,ngkpt=4 4 4, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=50 to lower the
computational cost. In this case, we find values of <em>U</em> and <em>J</em> of 2.75 eV and
0.41 eV and <em>U</em> is probably underestimated by 0.1 eV.</p>
<h2 id="5-effective-interactions-for-different-models">5 Effective interactions for different models<a class="headerlink" href="#5-effective-interactions-for-different-models" title="Permanent link">&para;</a></h2>
<p>In this section, we compute, using the converged values of parameters, the
value of effective interactions for the models discussed in section and 3.1.
The table below gives for each model, the values of <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>,
<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a> and <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a> that must be used, and it sums up the value
of bare and effective interactions.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>model</th>
<th><em>d - d</em></th>
<th><em>t<sub>2g</sub>-t<sub>2g</sub></em></th>
<th><em>dp-dp</em></th>
<th><em>d -dp</em> (a)</th>
<th><em>d -dp</em> (b)</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa">ucrpa</a></td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>/<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a></td>
<td>21/25</td>
<td>23/25</td>
<td>12/25</td>
<td>12/25</td>
<td>12/25</td>
</tr>
<tr>
<td><a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a></td>
<td>21 25</td>
<td>23 25</td>
<td>12 25</td>
<td>21 25</td>
<td>12 25</td>
</tr>
<tr>
<td><em>U</em><sub>bare</sub> (eV)</td>
<td>15.4</td>
<td>15.3</td>
<td>19.4</td>
<td>19.4</td>
<td>19.4</td>
</tr>
<tr>
<td><em>U</em><sub>bare diag</sub> (eV)</td>
<td>16.3</td>
<td>16.0</td>
<td>20.6</td>
<td>20.6</td>
<td>20.6</td>
</tr>
<tr>
<td><em>J</em><sub>bare</sub> (eV)</td>
<td>0.66</td>
<td>0.86</td>
<td>0.96</td>
<td>0.96</td>
<td>0.96</td>
</tr>
<tr>
<td><em>U</em> (eV)</td>
<td>2.8</td>
<td>2.8</td>
<td>10.8</td>
<td>3.4</td>
<td>1.6</td>
</tr>
<tr>
<td><em>U</em><sub>diag</sub> (eV)</td>
<td>3.5</td>
<td>3.4</td>
<td>12.0</td>
<td>4.4</td>
<td>2.6</td>
</tr>
<tr>
<td><em>J</em> (eV)</td>
<td>0.60</td>
<td>0.76</td>
<td>0.91</td>
<td>0.87</td>
<td>0.86</td>
</tr>
</tbody>
</table>
<p></center></p>
<p>Even if our calculation is not perfectly converged with respect to k-points,
the results obtained for the <em>d-d</em>, <em>dp-dp</em>, and <em>d-dp</em> (a) models are in
agreement (within 0.1 or 0.2 eV) with results obtained in Table V of
<a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> and references cited in this table.</p>
<p>To obtain the results with only the <em>t<sub>2g</sub></em> orbitals, one must use a specific
input file, which is tucrpa_4.abi, which uses specific keywords, peculiar to
this case (compare it with tucrpa_2.abi). In this peculiar case, the most
common definition of J has to be deduced by direct calculation from the
interaction matrices using the Slater Kanamori expression (see e.g.
<a class="wikilink citation-wikilink" data-content="Dynamical mean-field theory using Wannier functions: A flexible route to electronic structure calculations of strongly correlated materials" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lechermann2006">[Lechermann2006]</a> or <a class="wikilink citation-wikilink" data-content="HubbardUand Hund exchangeJin transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a>) and not using the value of <em>J</em> computed in the code).</p>
<p>We now briefly comment the physics of the results.</p>
<ul>
<li>
<p>Bare interactions. When the number of bands used is larger, the Wannier orbitals extension is smaller.
  Thus, the interaction obtained with Wannier functions obtained from <em>dp</em> bands are larger
  than interactions obtained with Wannier functions obtained with <em>d</em> bands and also larger
  than interaction obtained on atomic orbitals.</p>
</li>
<li>
<p>For the same Wannier functions ( <em>dp-dp, d-dp</em> (a), <em>d-dp</em> (b)), one can see the role of
  the screening on cRPA interactions:</p>
<ul>
<li>When one supresses all transitions inside the <em>d</em> -like and <em>p</em> -like bands ( <em>dp-dp</em> model), <em>U</em> is large.</li>
<li>When only the transitions inside the <em>d</em> -like bands are suppressed, <em>U</em> is smaller ( <em>d-dp</em> (a) model)
    in comparison to the <em>dp-dp</em> model, because the screening is more efficient.</li>
<li>Lastly, when one uses the weighting scheme to compute the polarizability, <em>U</em> is very small.
    Indeed, in this case, one can show that there are some residual transitions near the Fermi level
    (due to the hybridization between <em>d</em> orbitals and O <em>p</em> orbitals) which are very efficient
    to screen the interaction (A similar effect is discussed in <a class="wikilink citation-wikilink" data-content="Screened Coulomb interaction calculations: Crpa implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> for UO 2 or
    <a class="wikilink citation-wikilink" data-content="First-principles calculations of dynamical screened interactions for the transition metal oxidesMO (M=Mn, Fe, Co, Ni)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#sakuma2013">[Sakuma2013]</a> for transition metal oxydes).</li>
</ul>
</li>
</ul>
<p>Finally, fully screened interactions (not discussed here) could also be
computed for each definition of correlated orbitals by using the default
values of <a class="wikilink codevar-wikilink" href="../../variables/gw#ucrpa_bands">ucrpa_bands</a>.</p>
<h2 id="6-frequency-dependent-interactions">6 Frequency dependent interactions<a class="headerlink" href="#6-frequency-dependent-interactions" title="Permanent link">&para;</a></h2>
<p>In this section, we are going to compute frequency dependent effective
interactions. Just change the following input variables in order to compute
effective interaction between 0 and 30 eV. We use <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a> = 0 in order to
decrease the computational cost.</p>
<div class="codehilite"><pre><span></span><code> # <span class="o">--</span> <span class="nv">Frequencies</span> <span class="k">for</span> <span class="nv">effective</span> <span class="nv">interactions</span>
 <span class="nv">nsym</span>        <span class="mi">0</span>
 <span class="nv">nfreqsp3</span>   <span class="mi">60</span>
 <span class="nv">freqspmax3</span> <span class="mi">30</span> <span class="nv">eV</span>
 <span class="nv">freqspmin3</span>  <span class="mi">0</span> <span class="nv">eV</span>
 <span class="nv">nfreqsp4</span>   <span class="mi">60</span>
 <span class="nv">freqspmax4</span> <span class="mi">30</span> <span class="nv">eV</span>
 <span class="nv">freqspmin4</span>  <span class="mi">0</span> <span class="nv">eV</span>
</code></pre></div>

<p>An example of input file can be found in <em>tucrpa_5.abi</em>. Note that we have
decreased some parameters to speed-up the calculations. Importantly, however,
we have increased the number of Kohn Sham bands, because calculation of
screening at high frequency involves high energy transitions which requires
high energy states (as well as semicore states). If the calculation is too
time consuming, you can reduce the number of frequencies. The following figure
has been plotted with 300 frequencies, but using 30 or 60 frequencies is
sufficient to see the main tendencies. Extract the value of <em>U</em> for the 60 frequencies using:</p>
<div class="codehilite"><pre><span></span><code>grep &quot;U(omega)&quot; -A 60 tucrpa_5.out &gt; Ufreq.dat
</code></pre></div>

<p>Remove the first line, and plot the data:</p>
<p><img alt="dynamical" src="../ucalc_crpa_assets/dynamical.jpeg" /></p>
<p>We recover in the picture the main results found in the Fig. 3 of <a class="wikilink citation-wikilink" data-content="Calculations of Hubbard U from first-principles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#aryasetiawan2006">[Aryasetiawan2006]</a>.
Indeed, the frequency dependent effective interactions exhibits a plasmon excitation.</p>
<h2 id="7-conclusion">7 Conclusion<a class="headerlink" href="#7-conclusion" title="Permanent link">&para;</a></h2>
<p>This tutorial showed how to compute effective interactions for SrVO3. It
emphasized the importance of the definition of correlated orbitals and the
definition of constrained polarizability.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../udet/" title="Udet" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Udet
              </span>
            </div>
          </a>
        
        
          <a href="../rf1/" title="RF1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                RF1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (BAmadon)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>