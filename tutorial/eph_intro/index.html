



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/eph_intro/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Eph intro - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#an-overview-of-the-eph-code" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  EPH
                </span>
              
            
            Eph intro
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8" checked>
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Eph intro
      </label>
    
    <a href="./" title="Eph intro" class="md-nav__link md-nav__link--active">
      Eph intro
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-a-new-eph-code" title="Why a new EPH code?" class="md-nav__link">
    Why a new EPH code?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph-workflow" title="EPH workflow" class="md-nav__link">
    EPH workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phonon-bands-and-dos-with-eph" title="Phonon bands and DOS with EPH" class="md-nav__link">
    Phonon bands and DOS with EPH
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variables-for-phonon-dos" title="Variables for phonon DOS" class="md-nav__link">
    Variables for phonon DOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-for-phonon-band-structures" title="Variables for phonon band structures" class="md-nav__link">
    Variables for phonon band structures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#electron-phonon-matrix-elements" title="Electron-phonon matrix elements" class="md-nav__link">
    Electron-phonon matrix elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fourier-interpolation-of-the-dfpt-potentials" title="Fourier interpolation of the DFPT potentials" class="md-nav__link">
    Fourier interpolation of the DFPT potentials
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-the-importance-of-the-initial-dfpt-mesh" title="On the importance of the initial DFPT mesh" class="md-nav__link">
    On the importance of the initial DFPT mesh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tricks-to-accelerate-the-computation-and-reduce-the-memory-requirements" title="Tricks to accelerate the computation and reduce the memory requirements" class="md-nav__link">
    Tricks to accelerate the computation and reduce the memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#star-function-interpolation-of-the-ks-eigenvalues" title="Star-function interpolation of the KS eigenvalues" class="md-nav__link">
    Star-function interpolation of the KS eigenvalues
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-a-new-eph-code" title="Why a new EPH code?" class="md-nav__link">
    Why a new EPH code?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph-workflow" title="EPH workflow" class="md-nav__link">
    EPH workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phonon-bands-and-dos-with-eph" title="Phonon bands and DOS with EPH" class="md-nav__link">
    Phonon bands and DOS with EPH
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variables-for-phonon-dos" title="Variables for phonon DOS" class="md-nav__link">
    Variables for phonon DOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-for-phonon-band-structures" title="Variables for phonon band structures" class="md-nav__link">
    Variables for phonon band structures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#electron-phonon-matrix-elements" title="Electron-phonon matrix elements" class="md-nav__link">
    Electron-phonon matrix elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fourier-interpolation-of-the-dfpt-potentials" title="Fourier interpolation of the DFPT potentials" class="md-nav__link">
    Fourier interpolation of the DFPT potentials
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-the-importance-of-the-initial-dfpt-mesh" title="On the importance of the initial DFPT mesh" class="md-nav__link">
    On the importance of the initial DFPT mesh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tricks-to-accelerate-the-computation-and-reduce-the-memory-requirements" title="Tricks to accelerate the computation and reduce the memory requirements" class="md-nav__link">
    Tricks to accelerate the computation and reduce the memory requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#star-function-interpolation-of-the-ks-eigenvalues" title="Star-function interpolation of the KS eigenvalues" class="md-nav__link">
    Star-function interpolation of the KS eigenvalues
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/eph_intro.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="an-overview-of-the-eph-code">An overview of the EPH code<a class="headerlink" href="#an-overview-of-the-eph-code" title="Permanent link">&para;</a></h1>
<p>This page provides a quick introduction to the new electron-phonon driver integrated with the ABINIT executable.
We discuss important technical details related to the implementation and the associated input variables.
The drawbacks/advantages with respect to the implementation available in ANADDB are also discussed.</p>
<h2 id="why-a-new-eph-code">Why a new EPH code?<a class="headerlink" href="#why-a-new-eph-code" title="Permanent link">&para;</a></h2>
<p>First of all, let&rsquo;s try to answer the question:
<em>why did you decide to implement a new code for electron-phonon calculations?</em></p>
<p>As you may know, e-ph calculations have been available through the ANADDB executable for a long time.
This ANADDB-based implementation is essentially a post-processing of the e-ph matrix elements
computed by the DFPT code. This approach presents advantages as well as drawbacks.
On the one hand, most of the work required to compute e-ph matrix elements is implemented directly by the DFPT routines.
This means that e-ph calculations with advanced features such as PAW, SOC, non-collinear magnetism <em>etc</em>
are readily available in the ANADDB version once support in the DFPT part is implemented.</p>
<p>On the other hand, this post-processing approach implies that the number of <span><span class="MathJax_Preview">\kk/\qq</span><script type="math/tex">\kk/\qq</script></span>-points in the e-ph matrix elements
is <strong>automatically fixed at the level of the DFPT run</strong>.
In other words, if you want to compute phonon-limited mobilities with e.g. a 909090 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh,
you need to perform DFPT calculations with the same sampling thus rendering the computation almost impossible.
In principle, it is possible to use tricks such as a linear interpolation of the e-ph matrix elements
to densify the sampling, but in order to get a decent interpolation one usually needs initial BZ meshes
that are significantly denser than the ones needed to converge the DFPT part alone.</p>
<p>As a matter of fact, electrons, phonons and e-ph properties <strong>present completely different convergence rates</strong>.
In silicon, for instance, a 999 mesh both for phonons and electrons is enough to converge
the electron density and the vibrational spectrum <a class="wikilink citation-wikilink" data-content="Convergence and pitfalls of density functional perturbation theory phonons calculations from a high-throughput perspective" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#petretto2018">[Petretto2018]</a>.
On the contrary, the phonon-limited mobility of Si requires a 454545 <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-grid and a 909090 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-grid
to reach a 5% relative error <a class="wikilink citation-wikilink" data-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#brunin2020b">[Brunin2020b]</a>.
Roughly speaking, an explicit computation of phonons in Si with a 909090 <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh
requires around 20000  3  <a class="wikilink codevar-wikilink" href="../../variables/basic#natom">natom</a> DFPT calculations
so you can easily get an idea of the cost of a fully ab-initio evaluation of the e-ph matrix elements
for all these <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points.</p>
<p>The EPH code bypasses this bottleneck by <strong>interpolating the DFPT potentials</strong> in <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-space
while Bloch states are computed non-self-consistently on arbitrarily dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-meshes.
As a net result, the three problems (electrons, phonons and electron-phonon) are now
<strong>partly decoupled</strong> and can be converged separately.
Keep in mind, however, that the fact that one can easily densify the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-sampling in the EPH code does not
mean that one can use under-converged values for the ground-state (GS) and DFPT parts.
Indeed, the quality of the interpolation depends on the initial <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes.
The take-home message is that one should always converge carefully both electronic and vibrational properties
before moving to EPH computations.</p>
<p>For further information about the difference between EPH and ANADDB, see also <a class="wikilink citation-wikilink" data-content="The Abinit project: Impact, environment and recent developments" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze2019">[Gonze2019]</a>.
Further details about the EPH implementation are available in <a class="wikilink citation-wikilink" data-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#brunin2020b">[Brunin2020b]</a>.</p>
<h2 id="eph-workflow">EPH workflow<a class="headerlink" href="#eph-workflow" title="Permanent link">&para;</a></h2>
<p>A typical EPH workflow with arrows denoting dependencies between the different steps
is schematically represented in the figure below:</p>
<p><img alt="" src="../eph_intro_assets/eph_workflow.png" style="height:400px;width:400px" /></p>
<p>The brown boxes are standard DFPT calculations done with relatively coarse <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>- and <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-meshes (for instance, 999 in Si).
Each DFPT run produces a (partial) DDB file with a portion of the full dynamical matrix
as well as POT files with the first-order derivative of the KS potential (referred to as the DFPT potential below).
The partial POT files are merged with the <strong>mrgdv</strong> utility to produce a
single <strong>DVDB file</strong> (Derivatives of V(<span><span class="MathJax_Preview">\rr</span><script type="math/tex">\rr</script></span>) DataBase).
As usual, the partial DDB files are merged with <strong>mrgddb</strong> (see <a href="../rf2">the second tutorial on DFPT</a>).</p>
<p>The EPH driver (blue box) receives in input the total DDB and the DVDB as well as a GS WFK file that is usually
produced with a different <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh (in some cases, even with a different number of bands
when high-energy empty states are needed).
These ingredients are then used to compute (interpolate) e-ph matrix elements and the associated physical properties.</p>
<!--
The $\kk$-mesh in the WFK file must be commensurate with the $\qq$-mesh in the DVDB file
-->

<p>The EPH calculation is activated by using <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a> = 7 while <a class="wikilink codevar-wikilink" href="../../variables/eph#eph_task">eph_task</a> defines the physical properties to be computed.
To read the external files, one specifies the filepath with the three variables:
<a class="wikilink codevar-wikilink" href="../../variables/files#getwfk_filepath">getwfk_filepath</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#getddb_filepath">getddb_filepath</a> and <a class="wikilink codevar-wikilink" href="../../variables/files#getdvdb_filepath">getdvdb_filepath</a>.</p>
<p>Internally, the code starts by reading the DDB file to construct the interatomic
force constants (IFCs) in the real-space supercell (<span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span>-space).</p>
<!-- Other external files (WFK, DVDB) may be read depending on the value of [[eph_task]]. -->
<p>Then, the EPH code computes phonon bands and DOS.
Finally a specialized routine is invoked depending on the value of <a class="wikilink codevar-wikilink" href="../../variables/eph#eph_task">eph_task</a>.</p>
<p>The following physical properties can be computed:</p>
<ul>
<li>
<p>Imaginary part of ph-e self-energy in metals (<strong>eph_task 1</strong>) that gives access to:</p>
<ul>
<li>Phonon linewidths induced by e-ph coupling</li>
<li>Eliashberg function</li>
<li>Superconducting properties within the isotropic Migdal-Eliashberg formalism</li>
</ul>
</li>
</ul>
<!--
    * transport properties in metals with the LOVA approximation.
-->

<ul>
<li>
<p>Real and imaginary parts of the e-ph self-energy (<strong>eph_task 4</strong>) that gives access to:</p>
<ul>
<li>Zero-point renormalization of the band gap</li>
<li>QP corrections due to e-ph scattering as a function of T</li>
<li>Spectral function <span><span class="MathJax_Preview">A(\ww)</span><script type="math/tex">A(\ww)</script></span> and Eliashberg functions</li>
</ul>
</li>
<li>
<p>Imaginary part of the e-ph self-energy at the KS energy (<strong>eph_task -4</strong>) that gives access to:</p>
<ul>
<li>Phonon-limited carrier mobility, electrical conductivity and Seebeck coefficient</li>
<li>Phonon-limited carrier mean free path and relaxation times (or scattering rates)</li>
<li>All the calculations above can be done as a function of temperature and doping, for nonpolar and polar materials.</li>
</ul>
</li>
</ul>
<!--
Other more advanced options are available...

Crystalline symmetries are used throughout the code in order to reduce the number
of $\kk$- and $\qq$-points that must be explicitly treated.
To achieve good parallel efficiently, the most CPU demanding parts are parallelized with MPI employing
a distribution schemes over $\qq$-points, perturbations
and bands (the band level is available only when computing the full self-energy).
[[istwfk]] [[kptopt]]
Features available in ANADDB that are not yet supported by EPH
-->

<p>At the time of writing (December 24, 2025), the following features are <strong>not yet supported</strong> by EPH:</p>
<ul>
<li>PAW calculations</li>
<li>Spin-orbit coupling</li>
<li>Non-collinear magnetism (<a class="wikilink codevar-wikilink" href="../../variables/gstate#nspinor">nspinor</a> = 2 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspden">nspden</a> = 4)</li>
<li>Non-local part of the pseudopotential applied with <a class="wikilink codevar-wikilink" href="../../variables/dev#useylm">useylm</a> = 1</li>
</ul>
<p>In this introduction, we focus on the parts that are common to the different sub-drivers i.e.:</p>
<ol>
<li>Computation of vibrational properties via Fourier interpolation of the dynamical matrix.</li>
<li>Fourier interpolation of the DFPT potentials.</li>
</ol>
<p>The use of the different sub-drivers is discussed in more detail in the specialized lessons:</p>
<ul>
<li><a href="../eph4mob">Phonon-limited mobilities</a></li>
<li><a href="../eph4zpr">ZPR and T-dependent band structures</a></li>
</ul>
<!--
* [Isotropic superconductivity in metals](eph4isotc)
-->

<h2 id="phonon-bands-and-dos-with-eph">Phonon bands and DOS with EPH<a class="headerlink" href="#phonon-bands-and-dos-with-eph" title="Permanent link">&para;</a></h2>
<p>Since phonon frequencies and displacements are needed for e-ph calculations, it is not surprising
that some of the ANADDB features related to the treatment of the dynamical matrix
are integrated in the EPH code as well.
In many cases, the variables names are the same in EPH and ANADDB especially for important variables
such as <a class="wikilink codevar-wikilink" href="../../variables/eph#dipdip">dipdip</a>, <a class="wikilink codevar-wikilink" href="../../variables/eph#asr">asr</a>, and <a class="wikilink codevar-wikilink" href="../../variables/eph#chneut">chneut</a>.
There are however important differences with respect to the ANADDB input file.
More specifically, in EPH the name of the DDB file is specified by
<a class="wikilink codevar-wikilink" href="../../variables/files#getddb_filepath">getddb_filepath</a> whereas the DFPT <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh associated to the DDB file is given by <a class="wikilink codevar-wikilink" href="../../variables/eph#ddb_ngqpt">ddb_ngqpt</a>.
<strong>These two variables are mandatory</strong> when performing EPH calculations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In Abinit9 the default values of <a class="wikilink codevar-wikilink" href="../../variables/eph#dipdip">dipdip</a>, <a class="wikilink codevar-wikilink" href="../../variables/eph#asr">asr</a>, and <a class="wikilink codevar-wikilink" href="../../variables/eph#chneut">chneut</a> have been changed.
In particular, the acoustic sum rule and the charge neutrality of the Born effecive charges
are enforced by default.
It is responsability of the user to check whether the breaking of these sum rules (always
present due to numerical inaccuracies) is reasonable.
By the same token, make sure that no vibrational instabilty is present before
embarking on big EPH calculations.
If the spectrum presents instabilities around <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> due to a Fourier interpolation
done with coarse <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-sampling, you may try to use <a class="wikilink codevar-wikilink" href="../../variables/eph#rifcsph">rifcsph</a>.</p>
</div>
<h3 id="variables-for-phonon-dos">Variables for phonon DOS<a class="headerlink" href="#variables-for-phonon-dos" title="Permanent link">&para;</a></h3>
<p>By default, the EPH code computes the phonon DOS and the atom-projected PHDOS by interpolating
the IFCs on the <em>dense</em> <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh specified by <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_ngqpt">ph_ngqpt</a>.
The default <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-grid is 202020. You may want to increase this value for more accurate results.
The step of the (linear) frequency mesh is governed by <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_wstep">ph_wstep</a>.
The linear tetrahedron method by <a class="wikilink citation-wikilink" data-content="Projector augmented-wave method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bloechl1994">[Bloechl1994]</a> is used by default.
The Gaussian method can be activated via <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_intmeth">ph_intmeth</a> with <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_smear">ph_smear</a> defining
the Gaussian smearing (in Hartree units by default).
The final results are stored in the <strong>PHDOS.nc</strong> file (same format at the one produced by ANADDB).
The computation of the PHDOS can be disabled by setting <a class="wikilink codevar-wikilink" href="../../variables/eph#prtphdos">prtphdos</a> = 0 to make the calculation a bit faster.</p>
<p>To summarize: to compute the PHDOS with the tetrahedron method and a 40x40x40 <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>-centered <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh,
one should use</p>
<div class="highlight"><pre><span></span><code>prtphdos <span class="m">1</span>  <span class="c1"># 0 to disable this part.</span>
ph_ngqpt <span class="m">40</span> <span class="m">40</span> <span class="m">40</span>
</code></pre></div>
<p>To visualize the results with <a href="https://github.com/abinit/abipy">AbiPy</a> , execute</p>
<div class="highlight"><pre><span></span><code>abiopen.py out_PHDOS.nc -e
</code></pre></div>
<h3 id="variables-for-phonon-band-structures">Variables for phonon band structures<a class="headerlink" href="#variables-for-phonon-band-structures" title="Permanent link">&para;</a></h3>
<p>The computation of the phonon band structure is activated automatically provided the input file
defines the high-symmetry <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-path in terms of <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_nqpath">ph_nqpath</a> vertices listed in the <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_qpath">ph_qpath</a> array.
The <a class="wikilink codevar-wikilink" href="../../variables/eph#ph_ndivsm">ph_ndivsm</a> variable defines the number of divisions used to sample the smallest segment of the path
so that the number of points in each segment is proportional to the length of the segment.
The computation of the phonon band structure can be deactivated by setting <a class="wikilink codevar-wikilink" href="../../variables/eph#prtphbands">prtphbands</a> = 0.
The final results are stored in the <strong>PHBST.nc</strong> file (same format at the one produced by ANADDB).</p>
<p>For instance, the section for the phonon band structure could look like</p>
<div class="highlight"><pre><span></span><code>prtphbands <span class="m">1</span>
ph_nqpath <span class="m">5</span>
ph_qpath <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="c1"># Gamma</span>
         <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2  <span class="c1"># X</span>
         <span class="m">1</span>/2 <span class="m">1</span>/4 <span class="m">3</span>/4  <span class="c1"># W</span>
         <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
         <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>
</code></pre></div>
<p>To obtain the list of high-symmetry q-points, one can use the <a href="http://abinit.github.io/abipy/scripts/abistruct.html">abistruct</a>  script provided by <a href="https://github.com/abinit/abipy">AbiPy</a> :</p>
<div class="highlight"><pre><span></span><code>abistruct.py kpath in_DDB
</code></pre></div>
<p>and the phonon bands can be visualized using</p>
<div class="highlight"><pre><span></span><code>abiopen.py out_PHBST.nc -e
</code></pre></div>
<h2 id="electron-phonon-matrix-elements">Electron-phonon matrix elements<a class="headerlink" href="#electron-phonon-matrix-elements" title="Permanent link">&para;</a></h2>
<p>The e-ph matrix elements <span><span class="MathJax_Preview">\gkq</span><script type="math/tex">\gkq</script></span> are defined by</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\gkq = \langle \psi_{m\kk+\qq}|\Delta_\qnu V^\KS|\psi_{n\kk} \rangle,
\label{eq:elphon_mel}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\gkq = \langle \psi_{m\kk+\qq}|\Delta_\qnu V^\KS|\psi_{n\kk} \rangle,
\label{eq:elphon_mel}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">\psi_{n\kk}</span><script type="math/tex">\psi_{n\kk}</script></span> is the KS Bloch state and <span><span class="MathJax_Preview">\Delta_\qnu V^\KS</span><script type="math/tex">\Delta_\qnu V^\KS</script></span> is the first-order variation of the
self-consistent KS potential induced by the phonon mode <span><span class="MathJax_Preview">\qnu</span><script type="math/tex">\qnu</script></span>.
The scattering potential can be expressed as:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \Delta_{\qq\nu} V^\KS(\rr) = e^{i\qq\cdot\rr} \Delta_{\qq\nu} v^\KS(\rr).
\label{eq:delta_vks}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \Delta_{\qq\nu} V^\KS(\rr) = e^{i\qq\cdot\rr} \Delta_{\qq\nu} v^\KS(\rr).
\label{eq:delta_vks}
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">\Delta_{\qq\nu} v^\KS(\rr)</span><script type="math/tex">\Delta_{\qq\nu} v^\KS(\rr)</script></span> is a lattice periodic function <a class="wikilink citation-wikilink" data-content="Electron-phonon interactions from first principles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#giustino2017">[Giustino2017]</a>.
Note that ABINIT computes the response to the <strong>atomic perturbation</strong> defined by
the three variables <a class="wikilink codevar-wikilink" href="../../variables/gstate#qpt">qpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a> and <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a> when <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a> is set to 1.
The connection between the phonon representation and the atomic perturbation employed by the DFPT code
is given by:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \Delta_{\qq\nu} v^\KS(\rr) =
    \dfrac{1}{\sqrt{2\wqnu}} \sum_{\kappa\alpha}
    \dfrac{{e}_{\kappa\alpha,\nu}(\qq)}{\sqrt{M_\kappa}}\,\partial_{\kappa\alpha,\qq} v^\KS(\rr),
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \Delta_{\qq\nu} v^\KS(\rr) =
    \dfrac{1}{\sqrt{2\wqnu}} \sum_{\kappa\alpha}
    \dfrac{{e}_{\kappa\alpha,\nu}(\qq)}{\sqrt{M_\kappa}}\,\partial_{\kappa\alpha,\qq} v^\KS(\rr),
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">{e}_{\kappa\alpha,\nu}(\qq)</span><script type="math/tex">{e}_{\kappa\alpha,\nu}(\qq)</script></span> is the <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>-th Cartesian component of the phonon eigenvector
for the atom <span><span class="MathJax_Preview">\kappa</span><script type="math/tex">\kappa</script></span> in the unit cell, <span><span class="MathJax_Preview">M_\kappa</span><script type="math/tex">M_\kappa</script></span> its atomic mass and
<span><span class="MathJax_Preview">\partial_{\kappa\alpha,\qq} v^\KS(\rr)</span><script type="math/tex">\partial_{\kappa\alpha,\qq} v^\KS(\rr)</script></span> is the first-order derivative of the KS potential
that can be obtained with DFPT by solving self-consistently a system of Sternheimer equations for a given
<span><span class="MathJax_Preview">(\kappa\alpha, \qq)</span><script type="math/tex">(\kappa\alpha, \qq)</script></span> perturbation <a class="wikilink citation-wikilink" data-content="First-principles responses of solids to atomic displacements and homogeneous electric fields: Implementation of a conjugate-gradient algorithm" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1997">[Gonze1997]</a> <a class="wikilink citation-wikilink" data-content="Phonons and related crystal properties from density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#baroni2001">[Baroni2001]</a>.</p>
<p>The DVDB file stores <span><span class="MathJax_Preview">\partial_{\kappa\alpha,\qq} v^\KS(\rr)</span><script type="math/tex">\partial_{\kappa\alpha,\qq} v^\KS(\rr)</script></span>
for all the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points in the IBZ and all the irreducible atomic perturbations.
More rigorously, we should say that the DVDB file stores the local part of the DFPT potential
(variation of the Hartree + XC + local part of the pseudo)
but this is a rather technical point discussed in more detail in <a class="wikilink citation-wikilink" data-content="Phonon-limited electron mobility in Si, GaAs, and GaP with exact treatment of dynamical quadrupoles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#brunin2020b">[Brunin2020b]</a> that is not relevant
for the present discussion so we do not elaborate more on this.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The number of irreducible atomic perturbations depends on the <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-point and the symmetries of the system.
Actually only a particular subset of the point group of the unperturbed crystal can be
exploited at the DFPT level.
Fortunately, you don&rsquo;t have to worry about these technical details as symmetries are fully supported in EPH.
Just run the DFPT calculation for the irreducible perturbations in the IBZ as usual.
Also the computation of the WFK can be limited to the IBZ.
The EPH code will employ symmetries to reconstruct the different quantities at runtime.</p>
</div>
<h2 id="fourier-interpolation-of-the-dfpt-potentials">Fourier interpolation of the DFPT potentials<a class="headerlink" href="#fourier-interpolation-of-the-dfpt-potentials" title="Permanent link">&para;</a></h2>
<p>The EPH code employs the Fourier interpolation proposed in <a class="wikilink citation-wikilink" data-content="Wannier interpolation scheme for phonon-induced potentials: Application to bulk $\textMgB_2$, W, and the $(1\ifmmode\times\else\texttimes\fi1)$ H-covered W(110) surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#eiguren2008">[Eiguren2008]</a>
to obtain the scattering potentials at arbitrary <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points.
In this interpolation technique, one uses the DFPT potential stored in the DVDB file
to compute the <span><span class="MathJax_Preview">\qq \rightarrow \RR</span><script type="math/tex">\qq \rightarrow \RR</script></span> Fourier transform</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \label{eq:dfpt_pot_realspace}
    W_{\kappa\alpha}(\rr,\RR) = \dfrac{1}{N_\qq} \sum_\qq e^{-i\qq\cdot(\RR - \rr)}\,
    \partial_{\kappa\alpha\qq}{v^{\text{scf}}}(\rr),
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \label{eq:dfpt_pot_realspace}
    W_{\kappa\alpha}(\rr,\RR) = \dfrac{1}{N_\qq} \sum_\qq e^{-i\qq\cdot(\RR - \rr)}\,
    \partial_{\kappa\alpha\qq}{v^{\text{scf}}}(\rr),
\end{equation}</script>
</div>
<p>where the sum is over the <span><span class="MathJax_Preview">N_\qq</span><script type="math/tex">N_\qq</script></span> BZ <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points belonging to the ab-initio <a class="wikilink codevar-wikilink" href="../../variables/eph#ddb_ngqpt">ddb_ngqpt</a> grid.</p>
<!--
and $\partial_{\kappa\alpha\qq}{v^{\text{scf}}}$ represents the (lattice-periodic) first order derivative
of the local part of the KS potential associated to atom $\kappa$ along the Cartesian direction $\alpha$.
-->
<p>Once <span><span class="MathJax_Preview">W_{\kappa\alpha}(\rr,\RR)</span><script type="math/tex">W_{\kappa\alpha}(\rr,\RR)</script></span> is known, it is possible to interpolate the potential
at an arbitrary point <span><span class="MathJax_Preview">\tilde{\qq}</span><script type="math/tex">\tilde{\qq}</script></span> using the inverse transform</p>
<div>
<div class="MathJax_Preview">\begin{equation}
    \label{eq:dfpt_pot_interpolation}
    \partial v^{scf}_{\tilde\qq\kappa\alpha}(\rr) \approx \sum_\RR e^{i\tilde{\qq}\cdot(\RR - \rr)} W_{\kappa\alpha}(\rr,\RR).
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    \label{eq:dfpt_pot_interpolation}
    \partial v^{scf}_{\tilde\qq\kappa\alpha}(\rr) \approx \sum_\RR e^{i\tilde{\qq}\cdot(\RR - \rr)} W_{\kappa\alpha}(\rr,\RR).
\end{equation}</script>
</div>
<p>where the sum is over the lattice vectors inside the Born-von Karman supercell.
The algorithm used to define the <span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span> points of the supercell with the
corresponding weights is specified by <a class="wikilink codevar-wikilink" href="../../variables/eph#dvdb_rspace_cell">dvdb_rspace_cell</a>.</p>
<p>The accuracy of the interpolation depends on the localization of <span><span class="MathJax_Preview">W_{\kappa\alpha}</span><script type="math/tex">W_{\kappa\alpha}</script></span> in <span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span>-space.
This means that the Born-von Karman supercell corresponding to the <a class="wikilink codevar-wikilink" href="../../variables/eph#ddb_ngqpt">ddb_ngqpt</a> grid should be large
enough to capture the spatial decay of <span><span class="MathJax_Preview">W_{\kappa\alpha}(\rr,\RR)</span><script type="math/tex">W_{\kappa\alpha}(\rr,\RR)</script></span> as a function of <span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span>.
As a consequence, <a class="wikilink codevar-wikilink" href="../../variables/eph#ddb_ngqpt">ddb_ngqpt</a> should be subject to convergence studies.</p>
<p>In metals, <span><span class="MathJax_Preview">W_{\kappa\alpha}</span><script type="math/tex">W_{\kappa\alpha}</script></span> is expected to be short-ranged provided one ignores possible Kohn anomalies.
On the contrary, a special numerical treatment is needed in semiconductors and insulators due to the presence of
long-ranged (LR) <strong>dipolar</strong> and <strong>quadrupolar</strong> fields in <span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span>-space.
These LR terms determine a non-analytic behaviour of the scattering potentials
in the long-wavelength limit <span><span class="MathJax_Preview">\qq \rightarrow 0</span><script type="math/tex">\qq \rightarrow 0</script></span> <a class="wikilink citation-wikilink" data-content="Microscopic theory of electron-phonon interaction in insulators or semiconductors" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vogl1976">[Vogl1976]</a>.
To handle the LR part, the EPH code uses an approach that is similar in spirit to the one employed
for the Fourier interpolation of the dynamical matrix <a class="wikilink citation-wikilink" data-content="First-principles responses of solids to atomic displacements and homogeneous electric fields: Implementation of a conjugate-gradient algorithm" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1997">[Gonze1997]</a>.</p>
<p>The idea is relatively simple.
One subtracts the LR part from the DFPT potentials before computing Eq. \eqref{eq:dfpt_pot_realspace}
thus making the real-space representation amenable to Fourier interpolation.
The non-analytical part</p>
<!-- (Eq.\eqref{eq:v1_long_range}) -->
<p>is then restored back to Eq. \eqref{eq:dfpt_pot_interpolation} when interpolating the potential at <span><span class="MathJax_Preview">\tilde{\qq}</span><script type="math/tex">\tilde{\qq}</script></span>.</p>
<!--
the long-range part associated to the displacement of atom $\kappa$ along the cartesian direction $\alpha$ can be modeled with
-->
<p>In polar materials, the leading term is given by the dipolar field <a class="wikilink citation-wikilink" data-content="Fr\&quot;ohlich Electron-Phonon Vertex from First Principles" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#verdi2015">[Verdi2015]</a>, <a class="wikilink citation-wikilink" data-content="Wannier interpolation of the electron-phonon matrix elements in polar semiconductors: Polar-optical coupling in GaAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#sjakste2015">[Sjakste2015]</a>:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
   \label{eq:v1_long_range}
    V^{\mathcal{L}}_{\kappa\alpha\qq}(\rr) = i \dfrac{4\pi}{\Omega} \sum_{\GG \neq -\qq}
    \dfrac{(\qG)_\beta\cdot {\bm Z}^*_{\kappa\alpha,\beta}\,
    e^{i (\qG) \cdot (\rr - {\bm{\tau}}_{\kappa})}} {(\qG) \cdot {\bm{\varepsilon}}^\infty \cdot (\qG)},
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
   \label{eq:v1_long_range}
    V^{\mathcal{L}}_{\kappa\alpha\qq}(\rr) = i \dfrac{4\pi}{\Omega} \sum_{\GG \neq -\qq}
    \dfrac{(\qG)_\beta\cdot {\bm Z}^*_{\kappa\alpha,\beta}\,
    e^{i (\qG) \cdot (\rr - {\bm{\tau}}_{\kappa})}} {(\qG) \cdot {\bm{\varepsilon}}^\infty \cdot (\qG)},
\end{equation}</script>
</div>
<p>where <span><span class="MathJax_Preview">{\bm{\tau}}_\kappa</span><script type="math/tex">{\bm{\tau}}_\kappa</script></span> is the atom position, <span><span class="MathJax_Preview">\Omega</span><script type="math/tex">\Omega</script></span> is the volume of the unit cell,
<span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span> and <span><span class="MathJax_Preview">{\bm{\varepsilon}}^\infty</span><script type="math/tex">{\bm{\varepsilon}}^\infty</script></span> are the Born effective charge tensor
and the dielectric tensor, respectively, and summation over the Cartesian directions <span><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span> is implied.
This term is present in polar materials (non-zero <span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span>) and
diverges as <span><span class="MathJax_Preview">1/q</span><script type="math/tex">1/q</script></span> for <span><span class="MathJax_Preview">\qq \rightarrow 0</span><script type="math/tex">\qq \rightarrow 0</script></span> hence the singularity is integrable in 3D systems.
<span><span class="MathJax_Preview">\bm{Z}^*</span><script type="math/tex">\bm{Z}^*</script></span> and <span><span class="MathJax_Preview">{\bm{\varepsilon}}^\infty</span><script type="math/tex">{\bm{\varepsilon}}^\infty</script></span> are read automatically from the DDB file (if present) so we
<strong>strongly recommend</strong> to compute these quantities with DFPT in order to prepare an EPH calculation
in semiconductors.</p>
<p>In non-polar materials, the Born effective charges are zero but the scattering potentials are still non-analytic
due to presence of jump discontinuities.
As discussed in <a class="wikilink citation-wikilink" data-content="Electron-Phonon beyond Fr\&quot;ohlich: Dynamical Quadrupoles in Polar and Covalent Solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#brunin2020">[Brunin2020]</a>, the non-analytic behaviour can be fully captured by using the more general expression:</p>
<!--
In this case the leading term is associated to the dynamical quadrupoles [[cite:Royo2019]].
The expression for the LR model including both dipole and quadrupole terms reads:
-->

<div>
<div class="MathJax_Preview">\begin{equation}
    V^{\mathcal{L}}_{\kappa\alpha,\qq}(\rr) =
    %\partial_{\kappa\alpha,\qq} v^{\Lc}(\rr) =
    \frac{4\pi}{\Omega} \sum_{\GG\neq\mathbf{-q}}
    \frac{ i(\qG)_\beta
    Z^*_{\kappa\alpha,\beta}
    -
    (\qG)_\beta
    ({Z^*_{\kappa\alpha,\beta}\cal{Q}}v^{\text{Hxc},\cal{E}_{\gamma}}(\rr)- \frac{1}{2}Q_{\kappa\alpha}^{\beta\gamma})(\qG)_\gamma
    }
    {(\qG) \cdot {\bm{\varepsilon}}^\infty \cdot (\qG)}
    e^{i (\qG) \cdot (\rr - {\bm{\tau}}_{\kappa})}
\label{eq:LRpot}
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
    V^{\mathcal{L}}_{\kappa\alpha,\qq}(\rr) =
    %\partial_{\kappa\alpha,\qq} v^{\Lc}(\rr) =
    \frac{4\pi}{\Omega} \sum_{\GG\neq\mathbf{-q}}
    \frac{ i(\qG)_\beta
    Z^*_{\kappa\alpha,\beta}
    -
    (\qG)_\beta
    ({Z^*_{\kappa\alpha,\beta}\cal{Q}}v^{\text{Hxc},\cal{E}_{\gamma}}(\rr)- \frac{1}{2}Q_{\kappa\alpha}^{\beta\gamma})(\qG)_\gamma
    }
    {(\qG) \cdot {\bm{\varepsilon}}^\infty \cdot (\qG)}
    e^{i (\qG) \cdot (\rr - {\bm{\tau}}_{\kappa})}
\label{eq:LRpot}
\end{equation}</script>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The computation of the dynamical quadrupoles tensor within the DFPT framework will be made available in a future release,
together with a specific tutorial. Once it is computed and stored in the DDB,
the EPH code reads it automatically and uses it for the LR model.</p>
</div>
<!--
TODO: Discuss more the integration with the DFPT part.
-->

<p>In the implementation, each Fourier component is multiplied by the
Gaussian filter <span><span class="MathJax_Preview">e^{-\frac{|\qG|^2}{4\alpha}}</span><script type="math/tex">e^{-\frac{|\qG|^2}{4\alpha}}</script></span>
in order to damp the short range components that are not relevant for the definition of the LR model.
The <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> parameter can be specified via the <a class="wikilink codevar-wikilink" href="../../variables/eph#dvdb_qdamp">dvdb_qdamp</a> input variable.
The default value worked well in the majority of the systems investigated so far yet
this parameter should be subject to convergence tests.
For testing purposes, it is possible to deactivate the treatment of the LR part by setting <a class="wikilink codevar-wikilink" href="../../variables/eph#dvdb_add_lr">dvdb_add_lr</a> to 0.</p>
<!--
It can also be set to -1 if one is interested only in the short-range part of the e-ph scattering potentials.
-->

<h3 id="on-the-importance-of-the-initial-dfpt-mesh">On the importance of the initial DFPT mesh<a class="headerlink" href="#on-the-importance-of-the-initial-dfpt-mesh" title="Permanent link">&para;</a></h3>
<p>At this point it is worth commenting about the importance of the initial DFPT <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh.
The Fourier interpolation implicitly assumes that the signal in <span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span>-space decays quickly hence
the quality of the <em>interpolated</em> phonon frequencies and of the <em>interpolated</em> DFPT potentials
between the ab-initio points depends on the spacing of the initial <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh that
in turns defines the size of the Born-von-Karman supercell.
In other words, the denser the DFPT mesh, the larger the real-space supercell and the better the interpolation,
especially for <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points close to <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>.</p>
<!--
In semiconductors the atomic displacement induces dynamical dipoles and quadrupoles at the level of the density
that will generate long-range scattering potentials.
These potentials affect the behaviour of the e-ph matrix elements for $\qq \rightarrow 0$ and the
$\qq$-mesh must be dense enough to capture the full strenght of the coupling.
A more detailed discussion can be found in [[cite:Brunin2020]], [[cite:Verdi2015]] and [[cite:Sjakste2015]].
-->

<p>From a more practical point of view, this implies that one should always <strong>monitor the convergence of the
physical properties with respect to the initial DFPT <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-mesh</strong>.
The LR model implemented in ABINIT facilitates the convergence as the non-analytic behaviour for
<span><span class="MathJax_Preview">\qq \rightarrow 0</span><script type="math/tex">\qq \rightarrow 0</script></span> is properly described yet the Fourier interpolation can introduce oscillations
between the <em>ab-initio</em> <span><span class="MathJax_Preview">\qq</span><script type="math/tex">\qq</script></span>-points and these oscillations may affect the quality of the
physical results <a class="wikilink citation-wikilink" data-content="Electron-Phonon beyond Fr\&quot;ohlich: Dynamical Quadrupoles in Polar and Covalent Solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#brunin2020">[Brunin2020]</a>.</p>
<h2 id="tricks-to-accelerate-the-computation-and-reduce-the-memory-requirements">Tricks to accelerate the computation and reduce the memory requirements<a class="headerlink" href="#tricks-to-accelerate-the-computation-and-reduce-the-memory-requirements" title="Permanent link">&para;</a></h2>
<p>Each sub-driver implements specialized techniques to accelerate the calculation and reduce the memory requirements.
Here we focus on the techniques that are common to the different EPH sub-drivers.
Additional tricks specific to the particular value of <a class="wikilink codevar-wikilink" href="../../variables/eph#eph_task">eph_task</a> are discussed in more detail in the associated lessons.</p>
<p>First of all, note that the memory requirements for the <span><span class="MathJax_Preview">W_{\kappa\alpha}(\rr,\RR)</span><script type="math/tex">W_{\kappa\alpha}(\rr,\RR)</script></span> array
scales as <a class="wikilink codevar-wikilink" href="../../variables/internal#nfft">%nfft</a>  product(<a class="wikilink codevar-wikilink" href="../../variables/eph#ddb_ngqpt">ddb_ngqpt</a>).
This quantity should be multiplied by 3 * <a class="wikilink codevar-wikilink" href="../../variables/basic#natom">natom</a> if each MPI process stores all the perturbations in memory.
The MPI parallelism over perturbations (see <a class="wikilink codevar-wikilink" href="../../variables/eph#eph_np_pqbks">eph_np_pqbks</a>) allows one to decrease this prefactor from
<em>3  natom</em> to <em>3  natom / nprocs_pert</em>.</p>
<p>Also, the total number of <span><span class="MathJax_Preview">\rr</span><script type="math/tex">\rr</script></span>-points (<a class="wikilink codevar-wikilink" href="../../variables/internal#nfft">%nfft</a>) plays an important role both at the level of memory
as well as the level of the wall-time.
To optimize this part, one can decrease the value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcutmin">boxcutmin</a>
to a value smaller than 2 e.g. 1.5 or the more aggressive 1.1.
Note that one is not obliged to run the GS/DFPT part with the same <a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcutmin">boxcutmin</a>.
The EPH code will automatically interpolate the DFPT potentials if the input FFT mesh computed from
<a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> and <a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcutmin">boxcutmin</a> differs from the one found in the DVDB file.
Just to clarify, you can change the value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcutmin">boxcutmin</a> in the EPH part but not <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>.</p>
<!--
An exact representation of densities/potentials in $\GG$-space is obtained with [[boxcutmin]] = 2,
but we found that using a value of 1.1 does not significantly affect the result
while allowing one to decrease the cost of the calculation and the memory by a factor ~8.
-->

<p>A significant fraction of the wall-time in EPH is spent for performing the FFTs required
to apply the first-order Hamiltonian <span><span class="MathJax_Preview">H^1</span><script type="math/tex">H^1</script></span>.
The use of single precision in the FFT routines allows one to decrease the computational cost without loosing precision.
This trick is activated by setting <a class="wikilink codevar-wikilink" href="../../variables/dev#mixprec">mixprec</a> = 1.
Note that this feature is available only if the code is linked with FFTW3 or intel-MKL.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcutmin">boxcutmin</a> and <a class="wikilink codevar-wikilink" href="../../variables/dev#mixprec">mixprec</a> tricks <strong>are not activated by default</strong>
because users are supposed to perform preliminary tests
to make sure the quality of the results is not affected by these options.</p>
</div>
<p>By default, the EPH code stores the KS wavefunctions in a single precision array although
the majority of the calculations are done with double precision arithmetic (except for the FFT when <a class="wikilink codevar-wikilink" href="../../variables/dev#mixprec">mixprec</a> is used).
The precision used for the internal buffer can be specified at configure time with:</p>
<div class="highlight"><pre><span></span><code><span class="nv">enable_gw_dpc</span><span class="o">=</span>yes      <span class="c1"># Store wavefunctions in double precision buffers.</span>
</code></pre></div>
<p>The default value if &ldquo;no&rdquo; i.e. single precision and we suggest not to change this option unless you have a good reason to do so.</p>
<p>We terminate the discussion with another trick that is not directly related to the EPH code but
to the DFPT computation.
Since the EPH code does not need the first order change of the wavefunctions (1WF files)
we suggest to avoid the output of these files by using <a class="wikilink codevar-wikilink" href="../../variables/files#prtwf">prtwf</a> = -1 in the DFPT part
as these files are quite large and the overall space on disk scales as <strong>nqpt  3  natom</strong>.
When <a class="wikilink codevar-wikilink" href="../../variables/files#prtwf">prtwf</a> is set to -1, the DFPT code writes the 1WF file only if the DFPT SCF cycle is not converged
so that one can still restart from these wavefunctions if needed
(restarting a DFPT run from the first order wavefunctions is more effective than restarting from the first order density).</p>
<h2 id="star-function-interpolation-of-the-ks-eigenvalues">Star-function interpolation of the KS eigenvalues<a class="headerlink" href="#star-function-interpolation-of-the-ks-eigenvalues" title="Permanent link">&para;</a></h2>
<p>As mentioned in the introduction, in the EPH implementation Bloch states are computed
non-self-consistently on arbitrarily dense <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-meshes without having to resort to interpolation schemes.
The advantage of such approach is that calculations can be easily automated.
The drawback is that the computational cost of the NSCF quickly increases with the density
of the <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-mesh and <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> hence for &ldquo;big calculations&rdquo; the cost
of the NSCF part may be even greater than the e-ph computation itself.</p>
<p>There are however physical properties whose computation does not require the knowledge
of the KS states for each <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point in the IBZ.
For instance, the computation of mobilities in semiconductors require the knowledge of the KS states whose energy
is slight above (below) the CMB (VBM), let&rsquo;s say ~0.2 eV.
In metals, only states close to the Fermi level are needed to compute superconducting properties with the standard formalism.
In other words, several e-ph calculations in which delta functions are involved require extremely dense BZ meshes
to converge but as a matter of fact only a <strong>relatively small fraction of the BZ compatible with energy and crystalline-momentum
conservation is nededed</strong>.</p>
<p>At this point a question naturally arises: can we avoid the NSCF computation of <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points that
are supposed to give negligible contribution to the final physical results?
The answer is yes provided we are able to predict in some easy way and with reasonable accuracy the
KS eigenvalues <span><span class="MathJax_Preview">\ee_\nk</span><script type="math/tex">\ee_\nk</script></span> <strong>without actually solving the KS equations</strong>.</p>
<p>The aproach used in the EPH code is based on the star-function interpolation by Shankland-Koelling-Wood (SKW)
with the improvements described in <a class="wikilink citation-wikilink" data-content="Smooth Fourier interpolation of periodic functions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#pickett1988">[Pickett1988]</a>.
In this method, the single-particle energies are expressed in terms of the (symmetrized) Fourier sum</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\label{eq:skw_expansion}
  \enk = \sum_\RR c_{n\RR} S_\RR(\kk).
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\label{eq:skw_expansion}
  \enk = \sum_\RR c_{n\RR} S_\RR(\kk).
\end{equation}</script>
</div>
<p>where the star function, <span><span class="MathJax_Preview">S_\RR(\kk)</span><script type="math/tex">S_\RR(\kk)</script></span>, is defined by</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\label{eq:star_function}
S_\RR(\kk) = \dfrac{1}{N}\sum_\mcO e^{i\kk\cdot \mcO \RR},
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\label{eq:star_function}
S_\RR(\kk) = \dfrac{1}{N}\sum_\mcO e^{i\kk\cdot \mcO \RR},
\end{equation}</script>
</div>
<p><span><span class="MathJax_Preview">\RR</span><script type="math/tex">\RR</script></span> is a lattice vector and the sum is over the <span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> rotations of the crystallographic point group.
By construction, the expansion in Eq.\eqref{eq:skw_expansion} fulfills the basic symmetry properties
of the single-particle energies:</p>
<div>
<div class="MathJax_Preview">\begin{align}
\label{eq:eigen_properties}
  \enk = \epsilon_{n\kG}, \\
  \enk = \epsilon_{n\mcO\kk}.
\end{align}</div>
<script type="math/tex; mode=display">\begin{align}
\label{eq:eigen_properties}
  \enk = \epsilon_{n\kG}, \\
  \enk = \epsilon_{n\mcO\kk}.
\end{align}</script>
</div>
<p>In principle, the expansion coefficients in Eq.\eqref{eq:skw_expansion} can be uniquely determined
by using a number of star functions equal to the number of <em>ab initio</em> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points
but this usually leads to sharp oscillations between the input eigenvalues.
To avoid this problem, one uses more star functions than <em>ab initio</em> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points and constrains the
fit so that the interpolant function passes through the input energies and a roughness function is minimized <a class="wikilink citation-wikilink" data-content="Smooth Fourier interpolation of periodic functions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#pickett1988">[Pickett1988]</a>.</p>
<p>This <a class="wikilink codevar-wikilink" href="../../variables/basic#einterp">einterp</a> variable activates the interpolation of the electronic eigenvalues.
The user can specify the number of star functions per
<em>ab initio</em> <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-point and an optional Fourier filtering as proposed in <a class="wikilink citation-wikilink" data-content="Calculations of transport properties with the linearized augmented plane-wave method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#uehara2000">[Uehara2000]</a>.</p>
<!--
%In this case, rcut is given by einterp(2) * Rmax where Rmax is the maximum length of the lattice vectors included in the star expansion
 [[einterp]] can be used to interpolate KS eigenvalues at
 the end of the ground state calculation (\href{https://docs.abinit.org/tests/v8/Input/t04.in}{{\texttt{v8\#42}}})
 or to interpolate GW energies (\href{https://docs.abinit.org/tests/libxc/Input/t42.in}{{\texttt{libxc\#42}}}) when {\bf optdriver} = 4.

In this case, one can employ the Python interface provided by \ABIPY to
automate the procedure.
An example can be found in this
\href{https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/g0w0/lesson_g0w0.ipynb}{jupyter notebook}.

%einterp consists of 4 entries. The first element specificies the interpolation method.
%
%1  Star-function interpolation (Shankland-Koelling-Wood Fourier interpolation scheme, see [Pickett1988]
%2  B-spline interpolation.
%The meaning of the other entries depend on the interpolation technique selected.
%In the case of star-function interpolation:
%
%einterp(2): Number of star-functions per {\it ab initio} k-point
%einterp(3): If non-zero, activate Fourier filtering according to Eq 9 of [Uehara2000]. In this case, rcut is given by einterp(2) * Rmax where Rmax is the maximum length of the lattice vectors included in the star expansion
%einterp(4): Used if einterp(2) /= 0. It defines rsigma in Eq 9

%It is worth noting that the QP energies must fulfill the symmetry properties of the point group of the crystal:
%and
%where G is a reciprocal lattice vector and is an operation of the point group.
%Therefore it is possible to employ the star-function interpolation by Shankland, Koelling and Wood in the improved version proposed by Pickett to fit the {\it ab initio} results. This interpolation technique, by construction, passes through the initial points and satisfies the basic symmetry property of the band energies.
%It should be stressed, however, that this Fourier-based method can have problems in the presence of band crossings that may cause unphysical oscillations between the {\it ab initio} points.
-->
<p>Without entering into details that will be discussed in the other specialized lessons,
one can use the SKW algorithm to find the relevant <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points, perform an <em>ab-initio</em> NSCF run
for these wavevectors only in order to produce a WFK file that can be used by the EPH code.
The entire procedure is performed in an automatic way inside ABINIT but before running big EPH calculations,
we strongly recommend to check whether the SKW interpolation gives reasonable results.
A typical test would be:</p>
<ol>
<li>
<p>Compute a WFK file on a reasonably dense IBZ (let&rsquo;s call the file <strong>IBZ_WFK</strong>)</p>
</li>
<li>
<p>Perform a NSCF band structure calculation along a high-symmetry <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-path covering the most important
   regions of the BZ (e.g. band edges in semiconductors).
   This step produces another WFK file that will be used as reference to check the interpolation
   (let&rsquo;s call it <strong>KPATH_WKF</strong>)</p>
</li>
<li>
<p>Use the <em>abitk</em> executable in <em>src/98_main</em> to interpolate the KS energies using the eigenvalues
   in <strong>IBZ_WFK</strong> and compare the results with the ab-initio band structure stored in <strong>KPATH_WFK</strong>.</p>
</li>
</ol>
<p>The syntax is:</p>
<div class="highlight"><pre><span></span><code>abitk skw_compare IBZ_WFK KPATH_WFK <span class="o">[</span>--lpratio <span class="m">5</span><span class="o">]</span> <span class="o">[</span>--rcut <span class="m">0</span>.0<span class="o">]</span> <span class="o">[</span>--rsigma <span class="m">0</span><span class="o">]</span>
</code></pre></div>
<p>where optional arguments are placed between square brackets and the default value is indicated.
If you prefer, it is possible to replace WFK files with GSR.nc file as in</p>
<div class="highlight"><pre><span></span><code>abitk skw_compare IBZ_GSR.nc KPATH_GSR.nc
</code></pre></div>
<p>as only KS energies are needed for the SKW interpolation.</p>
<p>To compare the bands with AbiPy, use the <a href="http://abinit.github.io/abipy/scripts/abicomp.html">abicomp</a>  script with the <code>ebands</code> command:</p>
<div class="highlight"><pre><span></span><code>abicomp.py ebands abinitio_EBANDS.nc skw_EBANDS.nc -p combiplot
</code></pre></div>
<p>If the fit is not satisfactory, you may want to try one of the following options (in order of importance):</p>
<ol>
<li>Increase the ab-initio mesh in <strong>IBZ_WFK</strong>.</li>
<li>Increase the value of <em>lpratio</em></li>
<li>Play with <em>rcut</em> and <em>rsigma</em> to damp the oscillations in the interpolant</li>
</ol>
<p>Note that it is sometimes difficult to get completely rid of spurious oscillations
or artifacts in the SKW interpolation
especially in the presence of <strong>degeneracies or band crossing/anti-crossing</strong>,
Remember, however, that achieving perfect agreement between the SKW interpolation and the ab-initio results
is not crucial since the SKW bands are only used to find those <span><span class="MathJax_Preview">\kk</span><script type="math/tex">\kk</script></span>-points that are sufficiently
close to the band edges (Fermi level).
All these wavevectors will be recomputed afterwards with KS-DFT and possible oscillations
or artifacts will disappear in the ab-initio results.</p>
<p>In a nutshell, you need to <strong>make sure that the SKW bands are reasonably close</strong> to the ab-initio results
especially in the region around the band edges for semiconductors or around the Fermi level for metals.
Small deviations between SKW and ab-initio bands can always be accounted for by increasing the value
of <a class="wikilink codevar-wikilink" href="../../variables/eph#sigma_erange">sigma_erange</a> used for generating the KERANGE.nc file.</p>
<p>Examples of input files to compute WFK files with the KERANGE are given in the last section of
the <a href="../eph4mob#how-to-compute-only-the-k-points-close-to-the-band-edges">mobility tutorial</a>.</p>
<!--
TODO: Recheck the code, perhaps I can use the ab-initio band edge if its greater/smaller than the SKW one.
The most important thing is that SKW reproduces the position of the band edges as these values are then used
that the position of the SKW band edge is consistent
-->
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dmft/" title="DMFT" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                DMFT
              </span>
            </div>
          </a>
        
        
          <a href="../eph4mob/" title="Eph4mob" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Eph4mob
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (MG, GB)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>