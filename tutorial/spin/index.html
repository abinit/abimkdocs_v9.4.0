



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/spin/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Spin - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#tutorial-about-the-spin" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  Base Tutorials
                </span>
              
            
            Spin
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" checked>
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Spin
      </label>
    
    <a href="./" title="Spin" class="md-nav__link md-nav__link--active">
      Spin
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling)." class="md-nav__link">
    Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-ferromagnetic-material-bcc-fe" title="1 A ferromagnetic material: bcc Fe" class="md-nav__link">
    1 A ferromagnetic material: bcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-antiferromagnetic-example-fcc-fe" title="2 An antiferromagnetic example: fcc Fe" class="md-nav__link">
    2 An antiferromagnetic example: fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-another-look-at-fcc-fe" title="3 Another look at fcc Fe" class="md-nav__link">
    3 Another look at fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ferrimagnetic-not-yet" title="4 Ferrimagnetic (not yet)" class="md-nav__link">
    4 Ferrimagnetic (not yet)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-spin-orbit-coupling-soc" title="5 The spin-orbit coupling (SOC)" class="md-nav__link">
    5 The spin-orbit coupling (SOC)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-norm-conserving-pseudo-potentials" title="5.1 Norm-conserving pseudo-potentials" class="md-nav__link">
    5.1 Norm-conserving pseudo-potentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-projector-augmented-wave" title="5.2 Projector Augmented-Wave" class="md-nav__link">
    5.2 Projector Augmented-Wave
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-rotation-of-the-magnetization-and-spin-orbit-coupling-coming-soon" title="6 Rotation of the magnetization and spin-orbit coupling (coming soon)" class="md-nav__link">
    6 Rotation of the magnetization and spin-orbit coupling (coming soon)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-summary" title="7 Summary" class="md-nav__link">
    7 Summary
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling)." class="md-nav__link">
    Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-ferromagnetic-material-bcc-fe" title="1 A ferromagnetic material: bcc Fe" class="md-nav__link">
    1 A ferromagnetic material: bcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-antiferromagnetic-example-fcc-fe" title="2 An antiferromagnetic example: fcc Fe" class="md-nav__link">
    2 An antiferromagnetic example: fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-another-look-at-fcc-fe" title="3 Another look at fcc Fe" class="md-nav__link">
    3 Another look at fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ferrimagnetic-not-yet" title="4 Ferrimagnetic (not yet)" class="md-nav__link">
    4 Ferrimagnetic (not yet)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-spin-orbit-coupling-soc" title="5 The spin-orbit coupling (SOC)" class="md-nav__link">
    5 The spin-orbit coupling (SOC)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-norm-conserving-pseudo-potentials" title="5.1 Norm-conserving pseudo-potentials" class="md-nav__link">
    5.1 Norm-conserving pseudo-potentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-projector-augmented-wave" title="5.2 Projector Augmented-Wave" class="md-nav__link">
    5.2 Projector Augmented-Wave
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-rotation-of-the-magnetization-and-spin-orbit-coupling-coming-soon" title="6 Rotation of the magnetization and spin-orbit coupling (coming soon)" class="md-nav__link">
    6 Rotation of the magnetization and spin-orbit coupling (coming soon)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-summary" title="7 Summary" class="md-nav__link">
    7 Summary
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/spin.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="tutorial-about-the-spin">Tutorial about the spin<a class="headerlink" href="#tutorial-about-the-spin" title="Permanent link">&para;</a></h1>
<h2 id="properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling">Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).<a class="headerlink" href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to get the following physical properties:</p>
<ul>
<li>the total magnetization of a ferromagnetic (or ferrimagnetic) material</li>
<li>the estimation of the atom magnetic moment</li>
<li>analyse the total density of states per spin direction</li>
<li>analyse the density of states per atom and per spin direction</li>
<li>effect of spin-orbit coupling for a non magnetic system</li>
<li>non-collinear magnetism (not yet)</li>
<li>spin-orbit coupling and magnetocristalline anisotropy (not yet)</li>
</ul>
<p>You will learn to use features of ABINIT which deal with spin.</p>
<p>This tutorial should take about 1.5 hour.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-a-ferromagnetic-material-bcc-fe">1 A ferromagnetic material: <em>bcc</em> Fe<a class="headerlink" href="#1-a-ferromagnetic-material-bcc-fe" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory, as
for the other tutorials. Why not Work_spin?</em></p>
<p>The file <em>tspin_x.abi</em> in <em>$ABI_TESTS/tutorial/Input</em> lists the input files for the spin tutorials.
You can copy the first one in the <em>Work_spin</em> directory with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$ABI_TESTS</span>/tutorial/Input
mkdir Work_spin
<span class="nb">cd</span> Work_spin
cp ../tspin_1.abi .
</code></pre></div>
<div class="text-center"><button type="button" id="uuid-8576e303-f1c6-44d2-903e-61e438e9b925" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tspin_1.abi
</button></div>
<div id="uuid-eed085e2-559e-4595-a715-5ba3f33a05f2" class="my_dialog" title="tests/tutorial/Input/tspin_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># In this input file, the location of the information on this or that line</span>
<span class="c1"># is not important : a keyword is located by the parser, and the related</span>
<span class="c1"># information should follow. </span>
<span class="c1"># The &quot;#&quot; symbol indicate the beginning of a comment : the remaining</span>
<span class="c1"># of the line will be skipped.</span>

<span class="c1"># Fe normal bcc structure for test of a ferromagnetic calculation</span>
<span class="c1"># The first dataset is without magnetization for comparison</span>

 ndtset <span class="m">2</span>

<span class="c1"># Magnetism: spin related quantities (only second dataset)</span>
 spinat2   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">4</span>.0
 nsppol2   <span class="m">2</span>

<span class="c1"># cutoff, k-points: </span>
   ecut   <span class="m">18</span>.0
  ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
nshiftk   <span class="m">1</span>
 shiftk   <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1"># SCF:</span>
  nstep   <span class="m">50</span>
 tolvrs   <span class="m">1</span>.0d-10

<span class="c1"># Crystal cell definition:</span>
  natom   <span class="m">1</span>
 ntypat   <span class="m">1</span>
 znucl    <span class="m">26</span>
  typat   <span class="m">1</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0

  acell   <span class="m">3</span>*5.42
  rprim   -0.5  <span class="m">0</span>.5  <span class="m">0</span>.5
           <span class="m">0</span>.5 -0.5  <span class="m">0</span>.5
           <span class="m">0</span>.5  <span class="m">0</span>.5 -0.5

<span class="c1"># Electron occupation:</span>
 occopt   <span class="m">3</span>
  nband   <span class="m">10</span>
 tsmear   <span class="m">0</span>.01

<span class="c1"># printing:</span>
 prtdos   <span class="m">1</span>
 prtden   <span class="m">1</span>


<span class="c1"># Pseudo:</span>
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/Fe.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tspin_1.abo, tolnlines=  1, tolabs=  1.010e-09, tolrel=  2.000e-06</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Fe normal bcc structure for test of a ferromagnetic calculation</span>
<span class="c1">#%%  The first dataset is without magnetization for comparison</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-eed085e2-559e-4595-a715-5ba3f33a05f2", "#uuid-8576e303-f1c6-44d2-903e-61e438e9b925") }); </script>

<p>You can now run the calculation with:</p>
<div class="highlight"><pre><span></span><code>abinit tspin_1.abi &gt; log &gt; err <span class="p">&amp;</span>
</code></pre></div>
<p>In the mean time the calculation is done, have a look at the input file, and read it carefully.
Because we are going to perform magnetic calculations, there are two new types of variables related to magnetism:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a></li>
</ul>
<p>You will work with a low <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> (=18Ha) and a small k-point grid (defined by <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>) of 4x4x4
Monkhorst-Pack grid. It is implicit that in <em>real life</em>, you should do a
convergence test with respect to both <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> parameters and this is even more
important with magnetism that involves low energy differences and small magnetization density values.</p>
<p>This basic first example will compare two cases, 
one that do not take into account magnetism and one that take into account it 
(done through two datasets in the input, the dataset 1 does not include magnetism and dataset 2 includes it).
We now look at the output file. 
In the magnetic case (dataset 2), the electronic density is split into two parts,
the &ldquo;Spin-up&rdquo; and the &ldquo;Spin-down&rdquo; parts to which correspond different Kohn-Sham
potentials and different sets of eigenvalues whose occupations are given by the
Fermi-Dirac function (without the ubiquitous factor 2).</p>
<p>For the first k-point, for instance, we get:</p>
<div class="highlight"><pre><span></span><code>(no magnetism)
   2.00000    2.00000    2.00000    2.00000    2.00000    1.99999    1.99999    1.28101   1.28101    0.35284

(magnetic case)
(SPIN UP)
   1.00000    1.00000    1.00000    1.00000    1.00000    1.00000    1.00000    0.97826   0.97826    0.68642
(SPIN DOWN)
   1.00000    1.00000    1.00000    1.00000    1.00000    0.99995    0.99995    0.05851   0.05851    0.01699
</code></pre></div>
<p>We note that the occupations of the magnetic case are different for up and down spin channels, which
means that the eigenvalues are shifted 
(which is in turn due to a shift of the exchange-correlation potential and therefore of the effective potential).
You can have a look at the output file to compare spin-up and down eigenvalues:</p>
<div class="highlight"><pre><span></span><code>(up channel:)
  -3.09143   -1.74675   -1.74675   -1.74418    0.25777    0.36032    0.36032    0.46350   0.46350    0.49374
(dn channel:)
  -3.04218   -1.69171   -1.69171   -1.68906    0.27331    0.40348    0.40348    0.52935   0.52935    0.54215
</code></pre></div>
<p>Now you can move down in the output file and look at the following section:
<div class="highlight"><pre><span></span><code> Integrated electronic and magnetization densities in atomic spheres:
 ---------------------------------------------------------------------
 Radius=ratsph(iatom), smearing ratsm=  0.0000. Diff(up-dn)=approximate z local magnetic moment.
 Atom    Radius    up_density   dn_density  Total(up+dn)  Diff(up-dn)
    1   2.00000     7.658786     6.158329     13.817115     1.500458
 ---------------------------------------------------------------------
  Sum:              7.658786     6.158329     13.817115     1.500458
 Total magnetization (from the atomic spheres):             1.500458
 Total magnetization (exact up - dn):                       1.571040
======================================================================
</code></pre></div></p>
<p>In the last line, it is reported the total magnetization of the whole unit cell 
(in unit of <span><span class="MathJax_Preview">\mu_B</span><script type="math/tex">\mu_B</script></span> - Bohr&rsquo;s magneton), which correponds to the difference between the
integrated up and down densities, here we have 1.571040 <span><span class="MathJax_Preview">\mu_B</span><script type="math/tex">\mu_B</script></span>.
It is also reported the same difference but as integrated into spheres around each atom 
(here we have only one atom), which gives here 1.500458 <span><span class="MathJax_Preview">\mu_B</span><script type="math/tex">\mu_B</script></span> on iron atom.
The integrated magnetization in atomic spheres is an approximation, one should always check
that the sum of the integrated atomic magnetization &ldquo;from the atomic sphere&rdquo; is very close to the 
exact up-dn unit cell magnetization.
In the case of dataset 1 without magnetism, only the integrated electronic density is reported since there is
no distinction between up and down spin channels.</p>
<p>You can look at the total energy of dataset 1 and 2:</p>
<div class="highlight"><pre><span></span><code>           etotal1    -1.2342819713E+02
           etotal2    -1.2343141307E+02
</code></pre></div>
<p>The energy of the magnetic calculation is lower than the non-magnetic one,
which is expected for a magnetic crystal (the system gains energy through the extra degrees of freedom given by the spins).
Finally, you can also remark that the stress tensor is affected by the presence of magnetism.
This would also be true for the forces, but we don&rsquo;t remark it here because we are in high symmetry symmetry structure (all the forces are zeroed by symmetry), however this would be apparent for a less symmetric material.</p>
<p>It is interesting to consider in more detail the distribution of eigenvalues
for each spin channel, which is best done by looking at the respective densities of state (DOS).
To this end we have set <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a> = 1 in the input file that will print the up and down DOS (as soon as <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a> = 2).
The DOS data can be found in the files <em>tspin_1o_DS1_DOS</em> and <em>tspin_1o_DS2_DOS</em>
for the non-magnetic and the magnetic cases respectively, which can be used with a plotting software.
Traditionally, in order to enhance visibility, the DOS of minority spin electrons is done using negative values.
If we compare the DOS of the magnetized system (the Fermi energy is highlighted by a vertical dashed line):</p>
<p><img alt="" src="../spin_assets/bccfe_mag_dos2.jpg" /></p>
<p>and the non-magnetized system:</p>
<p><img alt="" src="../spin_assets/bccfe_nonmag_dos2.jpg" /></p>
<p>We observe that the up and down DOS channels have been &ldquo;shifted&rdquo; with respect to each other, which is a footprint of the presence of non-zero total magnetization in the crystal (either ferro- or ferri-magnetic).
The integrated DOS yields the number of electrons for each spin direction, 
and we see that the magnetization arises from the fact that there are more up than down electrons at the Fermi level.</p>
<p>The magnetization is from the up channels because we initialized <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> with positive values.
We could initialize it to a negative value to have negative magnetization.
<a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> serves two purposes: it is a way to initially break the spin symmetry (up/down), 
and also to start with an initial magnetic moment, 
ideally close enough to the final DFT one but sometimes a final non-zero magnetic moment on the atoms is obtained by initializing <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> to larger values than the formal one 
(in spin DFT there can be several local minima for the total energy and depending on your starting point you can end up in different local minima).</p>
<p>Note that <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> has three components (i.e. for x, y  and z directions) for each atom 
but in the absence of spin-orbit coupling (collinear calculation) 
there is no relation between the direction of magnetization and the crystal axes.
In these collinear magnetism calculations, only the z component of the spins is read to define the amplitude of the atomic magnetic moment 
(treated as a scalar value, i.e. only sign and amplitude matter).</p>
<p>The self-consistent loop is affecting both the density (like in the non-magnetic case) as
well as the spin-magnetization. 
For this reason, it might be more difficult to reach convergence in the magnetic cases than in 
the non-magnetic cases.
Not only starting with a large enough magnetic moment might help to converge toward the correct
magnetic ground sate, 
but also modified (tighter) convergence parameters might be needed. 
For example, in the case of Cobalt, in order to obtain the correct (non-zero) magnetic moment, 
a rather dense k-point sampling in the Brillouin zone must be used (e.g. 16x16x16), with a 
rather small value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a>. 
The convergence of a magnetic calculation a smaller value of <a class="wikilink codevar-wikilink" href="../../variables/dev#tolrde">tolrde</a> (e.g. 0.001 instead of the default 0.005),
a larger value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a> (e.g. 6 to 12 instead of the default 4) 
and/or reducing the mixing parameters diemix and mostly diemixmag.</p>
<h2 id="2-an-antiferromagnetic-example-fcc-fe">2 An antiferromagnetic example: <em>fcc</em> Fe<a class="headerlink" href="#2-an-antiferromagnetic-example-fcc-fe" title="Permanent link">&para;</a></h2>
<p>Well sort of....</p>
<p>Actually, fcc Fe, displays many complicated structures, in particular spin spirals.
A spiral is characterized by a direction along an axis, an angle of
the magnetization with respect to this axis and a step after which the magnetization comes full circled.
A very simple particular case is when the angle is 90, the axis is &lt;100&gt; and
the step is the unit cell side: spin directions alternate between
planes perpendicular to the &lt;100&gt; axis yielding a &ldquo;spiral stairway&rdquo;:</p>
<p><img alt="" src="../spin_assets/fcc_fe_conv.jpg" /></p>
<p>For instance, if the atom at [x,y,0] possesses an &ldquo;up&rdquo; magnetization, the atom
at [x+&frac12;,y,&frac12;] would possess a down magnetization etc&hellip;
To describe such a structure, a unit cell with two atoms is sufficient, [0,0,0] and
[&frac12;,0,&frac12;].
The two atoms will be given opposite magnetization with the help of the variable <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>.</p>
<p>Copy the file <em>$ABI_TESTS/tutorial/Input/tspin_2.abi</em> in <em>Work_spin</em>.</p>
<div class="text-center"><button type="button" id="uuid-775f25f0-6801-4544-ac43-96d8c704fb92" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tspin_2.abi
</button></div>
<div id="uuid-d8316a16-508b-4740-853e-c91dbbe77da4" class="my_dialog" title="tests/tutorial/Input/tspin_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Added by runtests.py</span>
<span class="nv">output_file</span> <span class="o">=</span> <span class="s2">&quot;tspin_2.abo&quot;</span>
<span class="nv">indata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_2i&quot;</span>
<span class="nv">outdata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_2o&quot;</span>
<span class="nv">tmpdata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_2t&quot;</span>
<span class="c1"># end runtests.py section</span>

<span class="c1"># Fe fcc structure with two atoms per unit cell for test of antiferromagnetic order</span>
<span class="c1"># This is the simplest fcc structure compatible with a X point spiral</span>

<span class="c1"># cutoff, k-points: </span>
   ecut  <span class="m">25</span>.0
 ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">2</span>
nshiftk  <span class="m">1</span>
 shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1"># SCF:</span>
 tolwfr   <span class="m">1</span>.0d-7
  nstep   <span class="m">70</span>

<span class="c1"># Magnetism: Antiferromagnic order</span>
 nsppol   <span class="m">1</span>
 nspden   <span class="m">2</span>
 spinat   <span class="m">0</span>.0 <span class="m">0</span>.0   <span class="m">4</span>.0
          <span class="m">0</span>.0 <span class="m">0</span>.0  -4.0

<span class="c1"># Crystal cell definition:</span>
  natom   <span class="m">2</span>
 ntypat   <span class="m">1</span>
 znucl    <span class="m">26</span>
  typat   <span class="m">1</span> <span class="m">1</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
          <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5

  acell   <span class="m">3</span>*6.60
 rprim    <span class="m">0</span>.5  -0.5  <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.5  <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.0  <span class="m">1</span>.0

<span class="c1"># Treating electron occupation:</span>
  nband   <span class="m">20</span>
 occopt   <span class="m">3</span>
 tsmear   <span class="m">0</span>.001

<span class="c1"># Printing:</span>
 prtdos  <span class="m">1</span>  
 prtden  <span class="m">1</span>


<span class="c1"># Pseudo:</span>
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/Fe.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tspin_2.abo, tolnlines = 60, tolabs = 0.000e+00, tolrel = 0.000e+00, fld_options=-medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Fe fcc structure with two atoms per unit cell for test of antiferromagnetic</span>
<span class="c1">#%%   This is the simplest fcc structure compatible with a X point spiral</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d8316a16-508b-4740-853e-c91dbbe77da4", "#uuid-775f25f0-6801-4544-ac43-96d8c704fb92") }); </script>

<p>This is your input file.</p>
<p>You can run the calculation, then you should edit the <em>tspin_2.in</em> file, and briefly
look at the two changes with respect to the file <em>tspin_1.abi</em>: the
unit cell basis vectors <a class="wikilink codevar-wikilink" href="../../variables/basic#rprim">rprim</a>, and the new <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>.</p>
<p>Note also that we use now <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a> = 1 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspden">nspden</a> = 2: this combination of values
is only valid when performing a strictly antiferromagnetic (AFM) calculation: 
nspden = 2 means that we have 2 independent components for the charge density 
while nsppol = 1 means that we have 1 independent component for the wave-functions.
In that case, ABINIT uses the so-called Shubnikov symmetries, to perform
calculations twice faster than with <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a> = 2 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspden">nspden</a> = 2 
(spin up and down channels are equivalent by symmetry in the case of perfect AFM cases). 
The symmetry of the crystal is not the full fcc symmetry anymore, since the
symmetry must now preserve the magnetization of each atom.<br />
ABINIT is nevertheless able to detect such symmetry belonging to the Shubnikov groups
and correctly finds that the cell is primitive, which would not be the case
if we had the same vector <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> on each atom (FM case).</p>
<p>If we now run this AFM calculation, its computation time is
approximately 10-20 seconds on a recent CPU.
If we look at the eigenvalues and occupations, they are again filled with a
factor 2, which comes from the symmetry considerations aforementioned, and
not from the &ldquo;usual&rdquo; spin degeneracy: the potential for spin-up is equal to
the potential for spin-down, shifted by the antiferromagnetic translation
vector. Eigenenergies are identical for spin-up and spin-down, but
wavefunctions are shifted one with respect to the other.</p>
<div class="highlight"><pre><span></span><code> kpt#   1, nband= 20, wtk=  0.25000, kpt=  0.1250  0.1250  0.2500 (reduced coord)
  -2.75606   -2.71227   -1.51270   -1.50656   -1.50211   -1.46164   -1.45614   -1.45485
   0.25613    0.34136    0.38202    0.41368    0.41915    0.46180    0.48400    0.50628
   0.52100    0.54004    0.56337    0.64500
      occupation numbers for kpt#   1
   2.00000    2.00000    2.00000    2.00000    2.00000    2.00000    2.00000    2.00000
   2.00000    2.00000    2.00000    2.00000    2.00000    2.00000    2.00000    2.00000
   1.95186    0.00000    0.00000    0.00000
</code></pre></div>
<p>The total magnetization being zero we can question how do we know we have magnetic order?
Indeed, the DOS will not be useful since we have as many up and down electrons.</p>
<p>We can however look at the integrated magnetization around each atom to have an
indication of the magnetic moment carried by each atom:</p>
<div class="highlight"><pre><span></span><code> Integrated electronic and magnetization densities in atomic spheres:
 ---------------------------------------------------------------------
 Radius=ratsph(iatom), smearing ratsm=  0.0000. Diff(up-dn)=approximate z local magnetic moment.
 Atom    Radius    up_density   dn_density  Total(up+dn)  Diff(up-dn)
    1   2.00000     7.748236     6.575029     14.323265     1.173206
    2   2.00000     6.575029     7.748236     14.323265    -1.173206
 ---------------------------------------------------------------------
  Sum:             14.323265    14.323265     28.646531    -0.000000
 Total magnetization (from the atomic spheres):            -0.000000
 Total magnetization (exact up - dn):                      -0.000000
================================================================================
</code></pre></div>
<p>which gives (dependent on the radius used to project the charge density):</p>
<div class="codehilite"><pre><span></span><code>magnetization of atom 1= 1.173206
magnetization of atom 2=-1.173206
</code></pre></div>

<p>Another way to get integrated atom magnetization can be done by using the utility 
<em>cut3d</em> which yields an interpolation of the magnetization at any point in space. 
<em>cut3d</em> is one of the executables of the ABINIT package and is installed together with abinit.
For the moment cut3d is interactive, and we will use it through a very primitive script
(written in Python) to perform a rough estimate of the magnetization on each atom.
You can have a look at the <a href="../spin_assets/magnetization.py">magnetization.py program</a>, and note
(or believe) that it does perform an integration of the magnetization in a cube of
side acell/2 around each atom; if applicable, you might consider adjusting the
value of the &ldquo;CUT3D&rdquo; string in the Python script.</p>
<p>Copy it in your <em>Work_spin</em> directory. If you run the program, by typing</p>
<div class="highlight"><pre><span></span><code>python magnetization.py
</code></pre></div>
<p>you will see the result:</p>
<div class="highlight"><pre><span></span><code>For atom 0 magnetic moment 1.2336144871839712
For atom 1 magnetic moment -1.2336216848949257
</code></pre></div>
<p>which also show that the magnetizations of the two atoms are opposite.
The values of the atom magnetization is a bit different than the ones from the
ABINIT output because it uses a slightly different integration paramters.</p>
<h2 id="3-another-look-at-fcc-fe">3 Another look at <em>fcc</em> Fe<a class="headerlink" href="#3-another-look-at-fcc-fe" title="Permanent link">&para;</a></h2>
<p>Instead of treating fcc Fe directly as an AFM material, we will
not make any hypotheses on its magnetic structure, and run the calculation
like the one for bcc Fe, anticipating only that the two spin directions are going to be different.
We will not even assume that the initial spins are of the same magnitude.</p>
<p>You can copy the file <em>$ABI_TESTS/tutorial/Input/tspin_3.abi</em> to <em>Work_spin</em>.</p>
<div class="text-center"><button type="button" id="uuid-f5e30683-da70-4755-985c-087824559feb" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tspin_3.abi
</button></div>
<div id="uuid-e39e55a5-5ade-4aaa-bb48-d41d5ce4b8ec" class="my_dialog" title="tests/tutorial/Input/tspin_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Added by runtests.py</span>
<span class="nv">output_file</span> <span class="o">=</span> <span class="s2">&quot;tspin_3.abo&quot;</span>
<span class="nv">indata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_3i&quot;</span>
<span class="nv">outdata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_3o&quot;</span>
<span class="nv">tmpdata_prefix</span> <span class="o">=</span> <span class="s2">&quot;tspin_3t&quot;</span>
<span class="c1"># end runtests.py section</span>

<span class="c1"># Fe fcc structure with two atoms per unit cell for test of antiferromagnetic</span>
<span class="c1"># This is the simplest fcc structure compatible with a X point spiral</span>


   ecut  <span class="m">25</span>.0

<span class="c1"># SCF:</span>
  nstep   <span class="m">70</span>
 tolwfr   <span class="m">1</span>.0d-7

<span class="c1"># Multidataset:</span>
ndtset <span class="m">3</span>

 ngkpt1  <span class="m">4</span> <span class="m">4</span> <span class="m">2</span> 
prtdos1  <span class="m">1</span>

 ngkpt2  <span class="m">3</span> <span class="m">3</span> <span class="m">2</span>
  iscf2  -3
getden2  <span class="m">1</span>
prtdos2  <span class="m">3</span>
natsph2  <span class="m">1</span>
iatsph2  <span class="m">1</span>
ratsph2  <span class="m">2</span>.4

 ngkpt3  <span class="m">3</span> <span class="m">3</span> <span class="m">2</span>
getden3  <span class="m">1</span>
  iscf3  -3
prtdos3  <span class="m">3</span>
natsph3  <span class="m">1</span>
iatsph3  <span class="m">2</span>
ratsph3  <span class="m">2</span>.4

<span class="c1"># Crystal cell definition:</span>
  natom   <span class="m">2</span>
 ntypat   <span class="m">1</span>
  znucl   <span class="m">26</span>
  typat   <span class="m">1</span> <span class="m">1</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
          <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5

  acell   <span class="m">3</span>*6.60
  rprim   <span class="m">0</span>.5  -0.5  <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.5  <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.0  <span class="m">1</span>.0

<span class="c1"># Magnetism:</span>
 nsppol   <span class="m">2</span>
 spinat   <span class="m">0</span>.0 <span class="m">0</span>.0   <span class="m">4</span>.0
          <span class="m">0</span>.0 <span class="m">0</span>.0  -4.0

<span class="c1"># Electron occupation:</span>
  nband   <span class="m">20</span>
 occopt   <span class="m">3</span>
 tsmear   <span class="m">0</span>.001

<span class="c1"># Printing:</span>
 prtden   <span class="m">1</span>
 prtkpt   <span class="m">1</span>

<span class="c1"># Pseudo:</span>
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/Fe.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tspin_3.abo, tolnlines = 0, tolabs = 0.000e+00, tolrel = 0.000e+00</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Fe fcc structure with two atoms per unit cell for test of antiferromagnetic</span>
<span class="c1">#%%   This is the simplest fcc structure compatible with a X point spiral</span>
<span class="c1">#%% topics = ElecDOS</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e39e55a5-5ade-4aaa-bb48-d41d5ce4b8ec", "#uuid-f5e30683-da70-4755-985c-087824559feb") }); </script>

<p>You can run the calculation with this is input file and look at it to understand its contents.</p>
<p>Note the values of <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>. In this job, we will again characterize the magnetic structure.
We are going to use atom and angular momentum projected densities of state.
These are DOS weighted by the projection of the wave functions
on angular momentum channels (i.e. the spherical harmonics) centered on each atom of the system.
Note that these DOS are computed with the tetrahedron method, which is rather
time consuming and produces more accurate but less smooth DOS than the smearing method. 
The CPU time is strongly dependent on the number of k-points, and we use here only a reduced set.
(This will take about 40 seconds on a modern computer)</p>
<p>To specify this calculation we need new variables, in addition to <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a> set now to 3:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#natsph">natsph</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#iatsph">iatsph</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#ratsph">ratsph</a></li>
</ul>
<p>This will specify the atoms around which the calculation will be performed, and the radius of the sphere.
We specifically select a new dataset for each atom, a non self-consistent
calculation being run to generate the projected density of states.
First, we note that the value of the total energy is -2.4972993185E+02 Ha,
which shows that we have attained essentially the same state as in tspin2 (etotal=-2.4972993198E+02).</p>
<p>The density of states will be in the files <em>tspin_3o_DS2_DOS_AT0001</em> for the
first atom, and <em>tspin_3o_DS3_DOS_AT0002</em> for the second atom.
We can extract the density of d states, which carries most of the magnetic
moment and whose integral up to the Fermi level will yield an estimate of the
magnetization on each atom.
We note the Fermi level (echoed in the file <em>tspin_3o_DS1_DOS</em>):</p>
<div class="codehilite"><pre><span></span><code>Fermi energy :      0.52472131
</code></pre></div>

<p>If we have a look at the integrated site-projected density of states, we can
compute the total moment on each atom. To this end, one can open the file
<em>tspin_3o_DS3_DOS_AT0002</em>, which contains information pertaining to atom 2. This
file is self-documented, and describes the line content, for spin up and spin down:</p>
<div class="highlight"><pre><span></span><code># energy(Ha)  l=0   l=1   l=2   l=3   l=4    (integral=&gt;)  l=0   l=1   l=2 l=3   l=4
</code></pre></div>
<p>If we look for the lines containing  an energy of &ldquo;0.52450&rdquo;, we find</p>
<p>up :
  0.52450  0.3714  1.0151  13.6555  0.1144  0.0683   1.29  3.30  <font color="red">2.49</font>  0.05  0.02</p>
<p>down :
  0.52450  0.1597  1.6758   9.8137  0.0872  0.0750   1.29  3.32  <font color="red">3.69</font>  0.04  0.01</p>
<p>There are apparently changes in the DOS for all projected orbitals,
but only the d orbital projection has sizeable differences. 
This is confirmed by looking at the integrated DOS which is different only for the
d-channel. 
The difference between up and down is 1.20, in rough agreement
(regarding our very crude methods of integration) with the previous
calculation. 
Using a calculation with the same number of k-points for the
projected DOS, we can plot the up-down integrated dos difference for the d-channel of each atom:</p>
<p><img alt="" src="../spin_assets/energy_diff_fccfe.jpg" /></p>
<p>Note that there is some scatter in this graph, due to the finite number of digits
of the integrated DOS given in the file <em>tspin_3o_DS3_DOS_AT0001</em> and <em>tspin_3o_DS3_DOS_AT0002</em>.
If we now look at the up and down DOS for each atom, we can see that the
corner atom and the face atom possess opposite magnetizations, which roughly
cancel each other. 
The DOS computed with the tetrahedron method is not as smooth as by the smearing method, 
and a running average allows for a better view.</p>
<h2 id="4-ferrimagnetic-not-yet">4 Ferrimagnetic (not yet)<a class="headerlink" href="#4-ferrimagnetic-not-yet" title="Permanent link">&para;</a></h2>
<p>Some materials can display a particular form of ferromagnetism, which also can
be viewed as non compensated antiferromagnetism, called ferrimagnetism.
Some atoms possess up spin and other possess down spin, but the total spin magnetization is non zero.
This happens generally for system with different type of atoms with different magnetic moment, and sometimes
in rather complicated structures such as magnetite.</p>
<h2 id="5-the-spin-orbit-coupling-soc">5 The spin-orbit coupling (SOC)<a class="headerlink" href="#5-the-spin-orbit-coupling-soc" title="Permanent link">&para;</a></h2>
<p>For heavy atoms a relativistic description of the electronic structure becomes
necessary, and this can be accomplished through the relativistic DFT approach.</p>
<h3 id="51-norm-conserving-pseudo-potentials">5.1 Norm-conserving pseudo-potentials<a class="headerlink" href="#51-norm-conserving-pseudo-potentials" title="Permanent link">&para;</a></h3>
<p>For atoms, the Dirac equation is solved and the 2(2l+1) l-channel
degeneracy is lifted according to the eigenvalues of the <span><span class="MathJax_Preview">L+S</span><script type="math/tex">L+S</script></span> operator
(l+&frac12; and l-&frac12; of degeneracy 2l+2 and 2l).
After pseudization, the associated wave functions can be recovered by adding to usual pseudo-potential projectors a
spin-orbit term of the generic form <span><span class="MathJax_Preview">v(r).|l,s\rangle L.S \langle l,s|</span><script type="math/tex">v(r).|l,s\rangle L.S \langle l,s|</script></span>.
Not all potentials include this additional term,  if you use the pseudopotentials from pseudodojo, you have
to choose those generated in a fully relativistic option (with &ldquo;FR&rdquo; in the name, &ldquo;SR&rdquo; means semi-relativistic).</p>
<p>In a plane wave calculation, the wavefunctions will be two-component
spinors, that is they will have a spin-up and a spin-down component, and these
components will be coupled. 
This means the size of the Hamiltonian matrix is quadrupled and the CPU time will be enlarged.</p>
<p>We will consider here a heavier atom than Iron: <em>Tantalum</em>.</p>
<p>You can copy the file <em>$ABI_TESTS/tutorial/Input/tspin_5.abi</em> in <em>Work_spin</em> and run the calculation.</p>
<div class="text-center"><button type="button" id="uuid-cec0743e-2ee5-45f7-b587-47aeff62f58d" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tspin_5.abi
</button></div>
<div id="uuid-7e6261e2-4b15-4f61-84f7-757afbbd3d62" class="my_dialog" title="tests/tutorial/Input/tspin_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#  Single Ta atom in a big box (BCC), treated with spin-orbit coupling.</span>
 enunit <span class="m">2</span> 

 ndtset <span class="m">2</span>

<span class="c1"># First dataset : scalar wavefunctions</span>
<span class="c1"># Second dataset : spinor wavefunctions</span>
 nspinor2 <span class="m">2</span>

<span class="c1"># cutoff, k-points: </span>
 ecut <span class="m">10</span>
 nkpt  <span class="m">1</span>
 istwfk <span class="m">1</span>  
 kptopt <span class="m">0</span>          <span class="c1"># Enter the k points manually </span>
 kpt  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1"># Crystal cell definition:</span>
 natom  <span class="m">1</span> 
 ntypat  <span class="m">1</span>
 znucl <span class="m">73</span>.0
 typat  <span class="m">1</span> 
 xred  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

 acell <span class="m">3</span>*15.00
 rprim   <span class="m">0</span>.5  <span class="m">0</span>.5 -0.5 
        -0.5  <span class="m">0</span>.5  <span class="m">0</span>.5 
         <span class="m">0</span>.5 -0.5  <span class="m">0</span>.5

<span class="c1"># SCF: </span>
 toldfe  <span class="m">1</span>.0d-7
  nline  <span class="m">5</span>  
 nstep   <span class="m">10</span>

<span class="c1"># Electron occupation:</span>
 nband   <span class="m">26</span>
 occopt  <span class="m">7</span>  
 tsmear  <span class="m">0</span>.01

<span class="c1"># Pseudo:</span>
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_fr_04_pbe_standard_psp8/Ta.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tspin_5.abo, tolnlines = 10, tolabs = 2.0e-8, tolrel = 8.0e-5</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = NC</span>
<span class="c1">#%% description = Single Ta atom in a big box (BCC), treated with spin-orbit coupling.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7e6261e2-4b15-4f61-84f7-757afbbd3d62", "#uuid-cec0743e-2ee5-45f7-b587-47aeff62f58d") }); </script>

<p>The input file contains one new variable:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#nspinor">nspinor</a></li>
</ul>
<p>Have a look at it. You should also look at <a class="wikilink codevar-wikilink" href="../../variables/gstate#so_psp">so_psp</a>; it is not set explicitly here,
because the SO information is directly read from the pseudopotential file.
One could force a non-SO calculation by setting <a class="wikilink codevar-wikilink" href="../../variables/gstate#so_psp">so_psp</a> to 0 even if the pseudo is &ldquo;FR&rdquo;.</p>
<p>In this run, we check that we recover the splitting of the atomic levels by
performing a calculation in a big box. 
Two calculations are launched with and without SOC.</p>
<p>We can easily follow the symmetry of the different levels of the non-SOC calculation:</p>
<div class="highlight"><pre><span></span><code> kpt#   1, nband= 26, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -2.60792   -1.43380   -1.43380   -1.43380   -0.14851   -0.09142   -0.09142   -0.09142
  -0.09033   -0.09033    0.02657    0.02657    0.02657    0.05604    0.14930    0.14930
   0.14930    0.15321    0.15321    0.15321    0.16211    0.16211    0.27952    0.27952
   0.27952    0.31238
</code></pre></div>
<p>That is, the symmetry: s, p, s, d
After application of the SOC, we now have to consider twice as many levels:</p>
<div class="highlight"><pre><span></span><code> kpt#   1, nband= 26, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -2.59704   -2.59704   -1.65268   -1.65268   -1.32544   -1.32544   -1.32544   -1.32544
  -0.14663   -0.14663   -0.09760   -0.09760   -0.09760   -0.09760   -0.07881   -0.07881
  -0.07805   -0.07805   -0.07805   -0.07805    0.01044    0.01044    0.03597    0.03597
   0.03597    0.03597
</code></pre></div>
<p>The levels are not perfectly degenerate, due to the finite size of the simulation box,
and in particular the cubic shape, which gives a small crystal field splitting of the d orbitals
between <span><span class="MathJax_Preview">e_g</span><script type="math/tex">e_g</script></span> and <span><span class="MathJax_Preview">t_{2g}</span><script type="math/tex">t_{2g}</script></span> states.
We can nevetheless compute the splitting of the levels, and we obtain, for e.g. the p-channel: 1.65268-1.32544=0.32724 Ha</p>
<p>If we now consider the
<a href="https://www.nist.gov/pml/atomic-reference-data-electronic-structure-calculations-tantalum">NIST table</a>
of atomic data, we obtain:</p>
<div class="codehilite"><pre><span></span><code><span class="mf">5</span><span class="n">p</span> <span class="n">splitting</span><span class="p">,</span> <span class="nb">tab</span><span class="n">le</span><span class="p">:</span> <span class="mf">1.681344</span><span class="o">-</span><span class="mf">1.359740</span> <span class="o">=</span> <span class="mf">0.321604</span> <span class="n">Ha</span>
<span class="mf">5</span><span class="n">d</span> <span class="n">splitting</span><span class="p">,</span> <span class="nb">tab</span><span class="n">le</span><span class="p">:</span> <span class="mf">0.153395</span><span class="o">-</span><span class="mf">0.131684</span> <span class="o">=</span> <span class="mf">0.021711</span> <span class="n">Ha</span>
</code></pre></div>

<p>We obtain a reasonable agreement. A better agreement could be obtained by improving the convergence parameters.</p>
<h3 id="52-projector-augmented-wave">5.2 Projector Augmented-Wave<a class="headerlink" href="#52-projector-augmented-wave" title="Permanent link">&para;</a></h3>
<p>Within the Projector Augmented-Wave (PAW) method, the usual (pseudo-)Hamiltonian can be expressed as:</p>
<div>
<div class="MathJax_Preview">
H  =  K + V_{eff} + \Sigma_{ij} D_{ij}  |p_i \rangle \langle p_j|
</div>
<script type="math/tex; mode=display">
H  =  K + V_{eff} + \Sigma_{ij} D_{ij}  |p_i \rangle \langle p_j|
</script>
</div>
<p>If the two following conditions are satisfied:</p>
<p>(1) the local PAW basis is complete enough;
(2) the electronic density is mainly contained in the PAW augmentation regions,</p>
<p>it can be shown that a very good approximation of the PAW Hamiltonian &ndash;
including spin-orbit coupling &ndash; is:</p>
<div>
<div class="MathJax_Preview">
H  \simeq  K + V_{eff} + \Sigma (D_{ij}+D^{SO}_{ij})  |p_i \rangle \langle p_j|
</div>
<script type="math/tex; mode=display">
H  \simeq  K + V_{eff} + \Sigma (D_{ij}+D^{SO}_{ij})  |p_i \rangle \langle p_j|
</script>
</div>
<p>where <span><span class="MathJax_Preview">D^{SO}_{ij}</span><script type="math/tex">D^{SO}_{ij}</script></span> is the projection of the (<span><span class="MathJax_Preview">L.S</span><script type="math/tex">L.S</script></span>) operator into the PAW augmentation regions.
As an immediate consequence, we have the possibility to use the standard <span><span class="MathJax_Preview">p_i</span><script type="math/tex">p_i</script></span> PAW projectors;
in other words, it is possible to use the standard PAW datasets (pseudopotentials) to perform
calculations including SOC.
But, of course, it is still necessary to express the wave-functions as two
components spinors (spin-up and a spin-down components).
Let&rsquo;s have a look at the following keyword:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/paw#pawspnorb">pawspnorb</a></li>
</ul>
<p>This activates the spin-orbit coupling within PAW (forcing <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspinor">nspinor</a>=2).</p>
<p>Now the practice:
We consider Bismuth, the PAW dataset file contains the 5d, 6s and 6p electrons in the valence.</p>
<p>You can copy the file <em>$ABI_TESTS/tutorial/Input/tspin_6.abi</em> in <em>Work_spin</em>
(one Bismuth atom in a large cell) and run the calculation. 
It takes about 10 seconds on a recent computer.</p>
<div class="text-center"><button type="button" id="uuid-bd648ce3-76b8-45f3-bdd3-8257f1291c0b" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tspin_6.abi
</button></div>
<div id="uuid-09b168d3-0a5e-44fb-a70e-49cab229d4b4" class="my_dialog" title="tests/tutorial/Input/tspin_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#  Isolated Bi atom</span>

   ndtset   <span class="m">2</span>

 pawspnorb1 <span class="m">0</span>  ! Without spin-orbit
 pawspnorb2 <span class="m">1</span>  ! With spin-orbit

    nsym   <span class="m">1</span>

<span class="c1"># cutoff, k-points: </span>
  kptopt   <span class="m">4</span>
    ecut   <span class="m">8</span>
 pawecutdg <span class="m">15</span>

<span class="c1"># Crystal cell definition:</span>
    natom  <span class="m">1</span>
   ntypat  <span class="m">1</span> 
    typat  <span class="m">1</span>
   znucl   <span class="m">83</span>.d0
    xred   <span class="m">3</span>*0.0

   acell   <span class="m">3</span>*10   <span class="c1">#This parameter is of course for testing purposes only</span>


<span class="c1"># electron occupation:</span>
  occopt   <span class="m">7</span>
  tsmear   <span class="m">0</span>.02
   nband1  <span class="m">12</span>
   nband2  <span class="m">24</span> <span class="c1"># 2 times more band with SOC</span>

<span class="c1"># SCF: </span>
   nstep   <span class="m">20</span>
  toldfe   <span class="m">1</span>.0d-7

<span class="c1"># Pseudo:</span>
 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_paw_pw_standard/Bi.xml&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tspin_6.abo, tolnlines=  5, tolabs=  3.000e-08, tolrel=  3.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = PAW </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Bismuth atom, isolated, in a supercell - with and without spin-orbit coupling.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-09b168d3-0a5e-44fb-a70e-49cab229d4b4", "#uuid-bd648ce3-76b8-45f3-bdd3-8257f1291c0b") }); </script>

<p>Two datasets are executed: the first without SOC, the second one using  <a class="wikilink codevar-wikilink" href="../../variables/paw#pawspnorb">pawspnorb</a>=1.</p>
<p>The resulting eigenvalues are:</p>
<p>Without SOC:
<div class="highlight"><pre><span></span><code> Eigenvalues (hartree) for nkpt=   1  k points:
 kpt#   1, nband= 12, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
5d  -0.86985   -0.86985   -0.86879   -0.86879   -0.86879   
6s  -0.43169   
6p  -0.05487   -0.05486   -0.05486   
...
</code></pre></div></p>
<p>With SOC:
<div class="highlight"><pre><span></span><code> kpt#   1, nband= 24, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
5d  -0.91133   -0.91133   -0.91133   -0.91133   -0.80022   -0.80022   -0.80022   -0.80022   -0.79954   -0.79954   
6s  -0.41639   -0.41639   
6p  -0.09817   -0.09817   -0.02546   -0.02546   -0.02546   -0.02546        
...
</code></pre></div></p>
<p>Again, the levels are not perfectly degenerate, due to the finite size and non spherical
shape of the simulation box.
We can compute the splitting of the levels, and we obtain:</p>
<div class="codehilite"><pre><span></span><code><span class="mf">5</span><span class="n">d</span><span class="o">-</span><span class="n">channel</span><span class="p">:</span> <span class="mf">0.91133</span><span class="o">-</span><span class="mf">0.80022</span> <span class="o">=</span> <span class="mf">0.11111</span> <span class="n">Ha</span>
<span class="mf">6</span><span class="n">p</span><span class="o">-</span><span class="n">channel</span><span class="p">:</span> <span class="mf">0.09817</span><span class="o">-</span><span class="mf">0.02546</span> <span class="o">=</span> <span class="mf">0.07271</span> <span class="n">Ha</span>
</code></pre></div>

<p>If we now consider the
<a href="https://www.nist.gov/pml/atomic-reference-data-electronic-structure-calculations-bismuth">NIST table</a>
of atomic data, we obtain:</p>
<div class="codehilite"><pre><span></span><code><span class="mf">5</span><span class="n">d</span><span class="o">-</span><span class="n">channel</span><span class="p">:</span> <span class="mf">1.063136</span><span class="o">-</span><span class="mf">0.952668</span> <span class="o">=</span> <span class="mf">0.11047</span> <span class="n">Ha</span>
<span class="mf">6</span><span class="n">p</span><span class="o">-</span><span class="n">channel</span><span class="p">:</span> <span class="mf">0.228107</span><span class="o">-</span><span class="mf">0.156444</span> <span class="o">=</span> <span class="mf">0.07166</span> <span class="n">Ha</span>
</code></pre></div>

<p>A perfect agreement even with a small simulation cell and very small values of plane-wave cut-offs.
This comes from the generation of the PAW dataset, where the SOC is calculated very accurately
and for an atomic reference. 
The exchange correlation functional has little impact on large SOC
splittings, which are mainly a kinetic energy effect.</p>
<h2 id="6-rotation-of-the-magnetization-and-spin-orbit-coupling-coming-soon">6 Rotation of the magnetization and spin-orbit coupling (coming soon)<a class="headerlink" href="#6-rotation-of-the-magnetization-and-spin-orbit-coupling-coming-soon" title="Permanent link">&para;</a></h2>
<p>The most spectacular manifestation of the SOC is the energy
associated with a rotation of the magnetisation with respect to the crystal axis.
It is at the origin of the magneto crystalline anisotropy (MCA) of paramount technological importance.</p>
<h2 id="7-summary">7 Summary<a class="headerlink" href="#7-summary" title="Permanent link">&para;</a></h2>
<p>The table below can help to know how to handle the different magnetic calculation cases in ABINIT:</p>
<table>
<thead>
<tr>
<th>case</th>
<th>msppol</th>
<th>nspinor</th>
<th>nspden</th>
</tr>
</thead>
<tbody>
<tr>
<td>non-magnetic</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>collinear FM</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>collinear AFM</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>non-collinear</td>
<td>1</td>
<td>2</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Note that non-collinear magnetism can be done with or without SOC.
With SOC do not use time reversal symmetry (<a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a> = 4), however as the symmetries
in the presence of SOC it is not (yet fully) implemented please remove all symmetries when running
non-collinear magnetism with SOC (i.e. <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=3 and <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1).
The non-collinear magnetism + SOC cases can be much more difficult to converge (SCF) and might require 
to strongly reduce the <a class="wikilink codevar-wikilink" href="../../variables/gstate#diemix">diemix</a> and mostly the <a class="wikilink codevar-wikilink" href="../../variables/gstate#diemixmag">diemixmag</a> mixing flags; you might have to increase <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a> and play with negative values of <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a>.
DFT+U correction is also necessary in most of the magnetic calculations if you use regular LDA and GGA functionals (i.e. not hybrid fucntionals).</p>
<hr />
<p>GZ would like to thank B. Siberchicot for useful comments.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../base4/" title="Base4" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Base4
              </span>
            </div>
          </a>
        
        
          <a href="../paw1/" title="PAW1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PAW1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (GZ, MT, EB, MJV)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>