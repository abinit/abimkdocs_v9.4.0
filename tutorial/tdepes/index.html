



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/tdepes/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Tdepes - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#tutorial-tdepes" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  EPH-legacy
                </span>
              
            
            Tdepes
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9" checked>
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Tdepes
      </label>
    
    <a href="./" title="Tdepes" class="md-nav__link md-nav__link--active">
      Tdepes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#temperature-dependence-of-the-electronic-structure" title="Temperature-DEPendence of the Electronic Structure." class="md-nav__link">
    Temperature-DEPendence of the Electronic Structure.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-calculation-of-the-zpr-of-eigenenergies-at-q" title="1 Calculation of the ZPR of eigenenergies at q=." class="md-nav__link">
    1 Calculation of the ZPR of eigenenergies at q=.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-converging-the-calculation-with-respect-to-the-grid-of-phonon-wavevectors" title="2 Converging the calculation with respect to the grid of phonon wavevectors" class="md-nav__link">
    2 Converging the calculation with respect to the grid of phonon wavevectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-calculation-of-the-eigenenergy-corrections-along-high-symmetry-lines" title="3 Calculation of the eigenenergy corrections along high-symmetry lines" class="md-nav__link">
    3 Calculation of the eigenenergy corrections along high-symmetry lines
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#temperature-dependence-of-the-electronic-structure" title="Temperature-DEPendence of the Electronic Structure." class="md-nav__link">
    Temperature-DEPendence of the Electronic Structure.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-calculation-of-the-zpr-of-eigenenergies-at-q" title="1 Calculation of the ZPR of eigenenergies at q=." class="md-nav__link">
    1 Calculation of the ZPR of eigenenergies at q=.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-converging-the-calculation-with-respect-to-the-grid-of-phonon-wavevectors" title="2 Converging the calculation with respect to the grid of phonon wavevectors" class="md-nav__link">
    2 Converging the calculation with respect to the grid of phonon wavevectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-calculation-of-the-eigenenergy-corrections-along-high-symmetry-lines" title="3 Calculation of the eigenenergy corrections along high-symmetry lines" class="md-nav__link">
    3 Calculation of the eigenenergy corrections along high-symmetry lines
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/tdepes.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="tutorial-tdepes">Tutorial TDepES<a class="headerlink" href="#tutorial-tdepes" title="Permanent link">&para;</a></h1>
<h2 id="temperature-dependence-of-the-electronic-structure">Temperature-DEPendence of the Electronic Structure.<a class="headerlink" href="#temperature-dependence-of-the-electronic-structure" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to get the following physical properties, for periodic solids:</p>
<ul>
<li>
<p>The zero-point-motion renormalization (ZPR) of eigenenergies</p>
</li>
<li>
<p>The temperature-dependence of eigenenergies</p>
</li>
<li>
<p>The lifetime/broadening of eigenenergies</p>
</li>
</ul>
<p>It should take about 1 hour.</p>
<p>For the theory related to the temperature-dependent calculations, please read
the following papers: <a class="wikilink citation-wikilink" data-content="Temperature dependence of the electronic structure of semiconductors and insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2015">[Ponce2015]</a>, <a class="wikilink citation-wikilink" data-content="Verification of first-principles codes: Comparison of total energies, phonon frequencies, electronphonon coupling and zero-point motion correction to the gap between ABINIT and QE/Yambo" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2014">[Ponce2014]</a> and <a class="wikilink citation-wikilink" data-content="Temperature dependence of electronic eigenenergies in the adiabatic harmonic approximation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2014a">[Ponce2014a]</a>.</p>
<p>There are three ways to compute the temperature dependence with Abinit:</p>
<ul>
<li>
<p><strong>Using Anaddb</strong>: historically the first implementation.</p>
</li>
<li>
<p><strong>Using post-processing python scripts</strong>: This way provides more options and is more efficient (less disk space, less memory demanding). 
    This option <strong>requires Netcdf</strong> (both in Abinit and python). In this tutorial, we only focus on this approach.</p>
</li>
<li>
<p><strong>Using an interpolation of the perturbed potential</strong>: This new way is covered in the <a href="../eph4zpr">ZPR and T-dependent band structures</a> tutorial.  </p>
</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In order to run the python script you need:</p>
<ul>
<li>python 2.7.6 or higher, python3 is not supported</li>
<li>numpy 1.7.1 or higher</li>
<li>netCDF4 and netCDF4 for python</li>
<li>scipy 0.12.0 or higher</li>
</ul>
<p>This can be done with:</p>
<div class="codehilite"><pre><span></span><code>sudo apt-get install netcdf-bin
sudo apt-get install python-dev
pip install numpy
pip install scipy
pip install netcdf4
</code></pre></div>

<p>A list of configuration files for clusters is available in the
<a href="https://github.com/abinit/abiconfig">abiconfig repository</a></p>
<p>If you have a prebuilt abinit executable, use:</p>
<div class="codehilite"><pre><span></span><code>./abinit -b
</code></pre></div>

<p>to get the list of libraries/options activated in the build.
You should see netcdf in the <code>TRIO flavor</code> section:</p>
<div class="codehilite"><pre><span></span><code> === Connectors / Fallbacks === 
  LINALG flavor  : netlib
  FFT flavor     : goedecker
  HDF5           : yes
  NetCDF         : yes
  NetCDF Fortran : yes
  LibXC          : yes
  Wannier90      : no
</code></pre></div>

</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
</div>
<p>Visualisation tools are NOT covered in this tutorial.
Powerful visualisation procedures have been developed in the Abipy context,
relying on matplotlib. See the README of <a href="https://github.com/abinit/abipy">Abipy</a>
and the <a href="https://github.com/abinit/abitutorials">Abipy tutorials</a>.</p>
<h2 id="1-calculation-of-the-zpr-of-eigenenergies-at-q">1 Calculation of the ZPR of eigenenergies at q=.<a class="headerlink" href="#1-calculation-of-the-zpr-of-eigenenergies-at-q" title="Permanent link">&para;</a></h2>
<p>The reference input files for this tutorial are located in
~abinit/tests/tutorespfn/Input and the corresponding reference output files
are in ~abinit/tests/tutorespfn/Refs.
The prefix for files is <strong>tdepes</strong>. As usual, we use the shorthand <code>~abinit</code> to indicate
the root directory where the abinit package has been deployed, but most often
consider the paths relative to this directory.</p>
<p>First, examine the <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.abi" target="_blank">tests/tutorespfn/Input/tdepes_1.abi</a> input file.</p>
<div class="text-center"><button type="button" id="uuid-e3bb26dd-a63e-4268-b31f-7330b64df244" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_1.abi
</button></div>
<div id="uuid-ba58107a-e00c-4e05-9d8b-979a7bcfd3ae" class="my_dialog" title="tests/tutorespfn/Input/tdepes_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># C in diamond structure. </span>
 ndtset <span class="m">3</span>
 elph2_imagden <span class="m">0</span>.1 eV   <span class="c1"># Imaginary shift of the denominator of the sum-over-states </span>
                        <span class="c1"># in the perturbation denominator. Usual value is 0.1 eV to reproduce</span>
                        <span class="c1"># experimental broadening at 300K. Increasing the value help the </span>
                        <span class="c1"># convergence with respect to the number of q-points. </span>
 ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>            <span class="c1"># Underconverged : k-grid should be at least 4x4x4 for diamond to be converged.</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1"># Ground state density</span>
 tolvrs1  <span class="m">1</span>.0d-8      <span class="c1"># Underconverged : tolvrs 1.0d-18 should be used for converged results</span>

<span class="c1"># Non self-consistent calculation with an arbitrary q point (here Gamma)</span>
 getden2  <span class="m">1</span>
 iscf2   -2
 nqpt2    <span class="m">1</span>
 qpt2     <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
 nbdbuf2  <span class="m">2</span>
 tolwfr2  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>

<span class="c1"># Computation at Gamma</span>
 getwfk3  <span class="m">1</span>
 getwfq3  <span class="m">2</span>
 nqpt3    <span class="m">1</span>
 qpt3     <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Calculation at Gamma</span>
 ieig2rf3 <span class="m">5</span>            <span class="c1"># Static eigenvalues corrections using DFPT (Sternheimer)</span>
 smdelta3 <span class="m">1</span>            <span class="c1"># Flag required to produce the _EIGI2D used to </span>
                       <span class="c1"># compute the lifetime of electronic levels.</span>
                       <span class="c1"># smdelta = 1 ==&gt; Fermi-Dirac smearing.</span>
 nbdbuf3  <span class="m">2</span>            <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 rfphon3  <span class="m">1</span>            <span class="c1"># Do phonon response</span>
 rfatpol3 <span class="m">1</span> <span class="m">2</span>          <span class="c1"># Treat displacements of all atoms</span>
 rfdir3   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>        <span class="c1"># Do all directions </span>
 tolwfr3  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>

<span class="c1"># Cell dependent parameters</span>
 acell <span class="m">3</span>*6.675
 rprim <span class="m">0</span> .5 .5 .5 <span class="m">0</span> .5 .5 .5 <span class="m">0</span>
 nsym <span class="m">1</span>              <span class="c1"># Disable symmetries. K-point symmetries are not yet working.</span>
 kptopt  <span class="m">3</span>           <span class="c1"># Disable TR symmetry</span>
 natom <span class="m">2</span>
 typat <span class="m">1</span> <span class="m">1</span>
 xred <span class="m">3</span>*0.0 <span class="m">3</span>*0.25
 nband <span class="m">12</span>
 ntypat <span class="m">1</span>
 znucl <span class="m">6</span>
 diemac <span class="m">6</span>
 ecut <span class="m">37</span>              
 enunit <span class="m">2</span>
 istwfk *1

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/C.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tdepes_1.abo,  tolnlines= 20, tolabs=  5.000e-05, tolrel=  5.000e-04, fld_options=-medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Ponc\&#39;e</span>
<span class="c1">#%% keywords = NC, DFPT, EPH_OLD</span>
<span class="c1">#%% description = Temperature dependence calculation of diamond.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-ba58107a-e00c-4e05-9d8b-979a7bcfd3ae", "#uuid-e3bb26dd-a63e-4268-b31f-7330b64df244") }); </script>

<p>Note that there are three datasets (<a class="wikilink codevar-wikilink" href="../../variables/basic#ndtset">ndtset</a>=3). The first dataset corresponds to a standard
self-consistent calculation, with an unshifted eight k-point grid,
producing e.g. the ground-state eigenvalue file tdepes_1o_DS1_EIG.nc ,
as well as the density file tdepes_1o_DS1_DEN. The latter is read (<a class="wikilink codevar-wikilink" href="../../variables/files#getden">getden</a>2=1)
to initiate the second dataset calculation,
which is a non-self-consistent run, specifically at the Gamma point only (there is no real recomputation
with respect to the dataset 1, it only extract a subset of the eight k-point grid).
This second dataset produces the wavefunction file tdepes_1o_DS2_WFQ, that is read by the third dataset (<a class="wikilink codevar-wikilink" href="../../variables/files#getwfq">getwfq</a>3=2),
as well as the tdepes_1o_DS1_WFK file from the first dataset (<a class="wikilink codevar-wikilink" href="../../variables/files#getwfk">getwfk</a>3=1).</p>
<p>The third dataset corresponds to a DFPT phonon calculation (<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a>3=1)
with displacement of all atoms (<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a>3= 1 2) in all directions (<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>3= 1 1 1).
This induces the creation of the Derivative DataBase file tdepes_1o_DS3_DDB.
The electron-phonon matrix elements are produced because of <a class="wikilink codevar-wikilink" href="../../variables/dfpt#ieig2rf">ieig2rf</a>3=5 ,
this option generating the needed netCDF files tdepes_1o_DS3_EIGR2D.nc and tdepes_1o_DS3_GKK.nc .</p>
<p>In order to run abinit, we suggest that you create a working directory, why not call it <code>Work</code>,
as subdirectory of ~abinit/tests/tutorespfn/Input, then
copy/modify the relevant files. Explicitly:</p>
<div class="codehilite"><pre><span></span><code>cd ~abinit/tests/tutorespfn/Input
mkdir Work
cd Work
cp ../tdepes*in .
</code></pre></div>

<p>Finally, issue</p>
<div class="codehilite"><pre><span></span><code>abinit tdepes_1.abi
</code></pre></div>

<p>The calculation will produce several _EIG.nc, _DDB, EIGR2D.nc and EIGI2D.nc files, 
that contain respectively the eigenvalues (GS or perturbed), 
the second-order derivative of the total energy with respect to
two atomic displacements, the electron-phonon matrix elements used to compute
the renormalization of the eigenenergies and the electron-phonon matrix
elements used to compute the lifetime of the electronic states.</p>
<p>You can now copy three post-processing python files from
~abinit/scripts/post_processing/temperature-dependence .
Make sure you are in the directory containing the output files produced by the code and issue:</p>
<div class="codehilite"><pre><span></span><code>cp ~abinit/scripts/post_processing/temperature-dependence/temperature_final.py .
cp ~abinit/scripts/post_processing/temperature-dependence/rf_final.py .
cp ~abinit/scripts/post_processing/plot_bs.py .
</code></pre></div>

<p>in which ~abinit has been replaced by the proper path.</p>
<!--
as well as the python file
containing the required classes from ~abinit/scripts/post_processing/mrgeignc.py
into the directory where you did the calculations.
-->

<p>You can then simply run the python script with the following command:</p>
<div class="codehilite"><pre><span></span><code>python temperature_final.py
</code></pre></div>

<p>and enter the information asked by the script, typically the following
(data contained in ~abinit/tests/tutorespfn/Input/tdepes_1_temperature.in):</p>
<div class="highlight"><pre><span></span><code>1                          # Number of cpus
2                          # Static ZPR computed in the Allen-Heine-Cardona theory
temperature_1              # Prefix for output files
0.1                        # Value of the smearing parameter for AHC (in eV)
0.1                        # Gaussian broadening for the Eliashberg function and PDOS (in eV)
0 0.5                      # Energy range for the PDOS and Eliashberg calculations (in eV)
0 1000 50                  # min, max temperature and temperature step
1                          # Number of Q-points we have (here we only computed $\Gamma$)
tdepes_1o_DS3_DDB          # Name of the response-funtion (RF) DDB file
tdepes_1o_DS2_EIG.nc       # Eigenvalues at $\mathbf{k+q}$
tdepes_1o_DS3_EIGR2D.nc    # Second-order electron-phonon matrix element
tdepes_1o_DS3_GKK.nc       # Name of the 0 GKK file
tdepes_1o_DS1_EIG.nc       # Name of the unperturbed EIG.nc file with Eigenvalues at $k$
</code></pre></div>
<p>Alternatively, copy this example file in the Work directory if not yet done, and then run</p>
<div class="codehilite"><pre><span></span><code>python temperature_final.py &lt; tdepes_1_temperature.in
</code></pre></div>

<div class="text-center"><button type="button" id="uuid-cb933cbf-07f0-412d-baed-c5f965cbaf17" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_1_temperature.in
</button></div>
<div id="uuid-95c5639d-ef16-4917-9635-8b79d4abdfcb" class="my_dialog" title="tests/tutorespfn/Input/tdepes_1_temperature.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="m">1</span>
<span class="m">2</span>
temperature_1
<span class="m">0</span>.1
<span class="m">0</span>.1
<span class="m">0</span> <span class="m">0</span>.5
<span class="m">0</span> <span class="m">1000</span> <span class="m">50</span>
<span class="m">1</span>
tdepes_1o_DS3_DDB
tdepes_1o_DS2_EIG.nc
tdepes_1o_DS3_EIGR2D.nc
tdepes_1o_DS3_GKK.nc
tdepes_1o_DS1_EIG.nc
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-95c5639d-ef16-4917-9635-8b79d4abdfcb", "#uuid-cb933cbf-07f0-412d-baed-c5f965cbaf17") }); </script>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Remember to install the libraries required by the script before running.</p>
<p>For pip, use:</p>
<div class="codehilite"><pre><span></span><code>pip install netcdf4
</code></pre></div>

<p>or:</p>
<div class="codehilite"><pre><span></span><code>conda install netcdf4
</code></pre></div>

<p>if you are using <a href="https://docs.conda.io/en/latest/miniconda.html">conda</a></p>
</div>
<p>You should see on the screen an output similar to:</p>
<div class="highlight"><pre><span></span><code>Start on <span class="m">21</span>/12/2020 at 15h21 

    ____  ____       _                                      _                   
   <span class="p">|</span>  _ <span class="se">\|</span>  _ <span class="se">\ </span>    <span class="p">|</span> <span class="p">|</span>_ ___ _ __ ___  _ __   ___ _ __ __ _<span class="p">|</span> <span class="p">|</span>_ _   _ _ __ ___  
   <span class="p">|</span> <span class="p">|</span>_<span class="o">)</span> <span class="p">|</span> <span class="p">|</span>_<span class="o">)</span> <span class="p">|</span>____<span class="p">|</span> __/ _ <span class="se">\ </span><span class="s1">&#39;_ ` _ \| &#39;</span>_ <span class="se">\ </span>/ _ <span class="se">\ </span><span class="s1">&#39;__/ _` | __| | | | &#39;</span>__/ _ <span class="se">\ </span>
   <span class="p">|</span>  __/<span class="p">|</span>  __/_____<span class="p">|</span> <span class="o">||</span>  __/ <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>_<span class="o">)</span> <span class="p">|</span>  __/ <span class="p">|</span> <span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  __/ 
   <span class="p">|</span>_<span class="p">|</span>   <span class="p">|</span>_<span class="p">|</span>         <span class="se">\_</span>_<span class="se">\_</span>__<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> .__/ <span class="se">\_</span>__<span class="p">|</span>_<span class="p">|</span>  <span class="se">\_</span>_,_<span class="p">|</span><span class="se">\_</span>_<span class="p">|</span><span class="se">\_</span>_,_<span class="p">|</span>_<span class="p">|</span>  <span class="se">\_</span>__<span class="p">|</span> 
                                      <span class="p">|</span>_<span class="p">|</span>                              Version <span class="m">1</span>.5         

This script compute the static/dynamic zero-point motion 
  and the temperature dependence of eigenenergies due to electron-phonon interaction.
  The electronic lifetime can also be computed. 

  WARNING: The first Q-point MUST be the Gamma point.

Enter the number of cpu on which you want to multi-thread
Define the <span class="nb">type</span> of calculation you want to perform. Type:
                         <span class="m">1</span> <span class="k">if</span> you want to run a non-adiabatic AHC calculation
                         <span class="m">2</span> <span class="k">if</span> you want to run a static AHC calculation
                         <span class="m">3</span> <span class="k">if</span> you want to run a static AHC calculation without control on active space <span class="o">(</span>not recommended !<span class="o">)</span>
   Note that <span class="k">for</span> <span class="m">1</span> <span class="p">&amp;</span> <span class="m">2</span> you need _EIGR2D.nc and _GKK.nc files obtained through ABINIT option <span class="s2">&quot;ieig2rf 5&quot;</span>
Enter name of the output file
Enter value of the smearing parameter <span class="k">for</span> AHC <span class="o">(</span><span class="k">in</span> eV<span class="o">)</span>
Enter value of the Gaussian broadening <span class="k">for</span> the Eliashberg <span class="k">function</span> and PDOS <span class="o">(</span><span class="k">in</span> eV<span class="o">)</span>
Enter the energy range <span class="k">for</span> the PDOS and Eliashberg calculations <span class="o">(</span><span class="k">in</span> eV<span class="o">)</span>: <span class="o">[</span>e.g. <span class="m">0</span> <span class="m">0</span>.5<span class="o">]</span> 
Introduce the min temperature, the max temperature and the temperature steps. e.g. <span class="m">0</span> <span class="m">200</span> <span class="m">50</span> <span class="k">for</span> <span class="o">(</span><span class="m">0</span>,50,100,150<span class="o">)</span>
Enter the number of Q-points you have
Enter the name of the <span class="m">0</span> DDB file
Enter the name of the <span class="m">0</span> eigq file
Enter the name of the <span class="m">0</span> EIGR2D file
Enter the name of the <span class="m">0</span> GKK file
Enter the name of the unperturbed EIG.nc file at Gamma
Inside the dynamic_zpm_temp def
Q-point:  <span class="m">0</span>  with <span class="nv">wtq</span> <span class="o">=</span> <span class="m">1</span>.0  and reduced coord. <span class="o">[</span><span class="m">0</span>. <span class="m">0</span>. <span class="m">0</span>.<span class="o">]</span>
WARNING: An eigenvalue is negative with value:  -2.8630004909173537e-10  ... but proceed with value <span class="m">0</span>.0
Now compute active space ...
Now compute generalized g2F Eliashberg electron-phonon spectral <span class="k">function</span> ...
End on <span class="m">21</span>/12/2020 at <span class="m">15</span> h <span class="m">21</span> 
Runtime: <span class="m">0</span> seconds <span class="o">(</span>or <span class="m">0</span>.0 minutes<span class="o">)</span>
</code></pre></div>
<p>The python code has generated the following files:</p>
<dl>
<dt><strong>temperature_1.txt</strong></dt>
<dd>This text file contains the zero-point motion renormalization (ZPR) at each k-point for each band.
  It also contain the evolution of each band with temperature at k=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>.
  At the end of the file, the Fan/DDW contribution is also reported.</dd>
<dt><strong>temperature_1_EP.nc</strong></dt>
<dd>This netcdf file contains a number for each k-point,
  for each band and each temperature. The real part of this number is the ZPR correction
  and the imaginary part is the lifetime.</dd>
</dl>
<!--
**temperature_BRD.txt**
: This text file contains the lifetime of the electronic states
  at each k-point for each band. It also contains the evolution of each band with temperature at k=$\Gamma$.
-->

<p>We can for example visualize the temperature dependence at k=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>  of the LUMO bands
(<code>Band: 4</code> section in the <strong>temperature_1.txt</strong> file, that you can examine)
with the contribution of only q=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>.</p>
<p><img alt="" src="../tdepes_assets/plot1.png" /></p>
<p>As you can see, the LUMO correction goes down with temperature. 
If the calculations were converged, the HOMO eigenenergies correction should go up with temperature. 
In general, the ZPR correction as well as their temperature dependence usually closes the gap
of semiconductors.</p>
<p>As usual, checking whether the input parameters give converged values is of course important.</p>
<!--   OBSOLETE

### If Abinit is **not** compiled with Netcdf ...

In this case, we should first use [[help:mrgddb|mrgddb]] to merge the _DDB and _EIGR2D/_EIGI2D
but since we only have one q-point we do not have to perform this step.
The static temperature dependence and the G2F can be computed thanks to anaddb
with the files file tdepes_2.files and the input
file [[tests/tutorespfn/Input/tdepes_2.abi]].

The information contained in the files file can be understood by looking at the echo
if its reading in the standard output:

<div class="highlight"><pre><span></span><code>  Give name for formatted input file:
-   tdepes_2.abi
  Give name for formatted output file:
-   tdepes_2.out
  Give name for input derivative database:
-   tdepes_1o_DS3_DDB
  Give name for output molecular dynamics:
-   dummyo.md
  Give name for input elphon matrix elements (GKK file):
-   tdepes_1o_DS3_EIGR2D
  Give root name for elphon output files:
-   tdepes_1_ana
  Give name for file containing ddk filenames for elphon/transport:
-   dummy.ddk
</code></pre></div>

<div class="text-center"><button type="button" id="uuid-d8a3a2d1-035a-4338-a76e-258b8e98bb21" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_2.abi
</button></div>
<div id="uuid-5f3339c5-c9f3-4293-80ca-6f7461fdbb6a" class="my_dialog" title="tests/tutorespfn/Input/tdepes_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># This is the set of values that have been changed compared to the previous ABINIT run.</span>
ndtset <span class="m">1</span>
nstep <span class="m">0</span>    
prtvol -1              <span class="c1"># This is to stop immediately after computation of the set of k points</span>
ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>            <span class="c1"># The grid for which we try to compute the number of k points</span>
nshiftk <span class="m">1</span>
shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
nsym <span class="m">0</span>

<span class="c1"># C in diamond structure. </span>
 elph2_imagden <span class="m">0</span>.1 eV   <span class="c1"># Imaginary shift of the denominator of the sum-over-states </span>
                        <span class="c1"># in the perturbation denominator. Usual value is 0.1 eV to reproduce</span>
                        <span class="c1"># experimental broadening at 300K. Increasing the value help the </span>
                        <span class="c1"># convergence with respect to the number of q-points. </span>

<span class="c1"># Ground state density</span>
 tolvrs1  <span class="m">1</span>.0d-8      <span class="c1"># Underconverged : tolvrs 1.0d-18 should be used for converged results</span>

<span class="c1"># Non self-consistent calculation with an arbitrary q point (here Gamma)</span>
 getden2  <span class="m">1</span>
 iscf2   -2
 nqpt2    <span class="m">1</span>
 qpt2     <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
 nbdbuf2  <span class="m">2</span>
 tolwfr2  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>

<span class="c1"># Computation at Gamma</span>
 getwfk3  <span class="m">1</span>
 getwfq3  <span class="m">2</span>
 nqpt3    <span class="m">1</span>
 qpt3     <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Calculation at Gamma</span>
 ieig2rf3 <span class="m">5</span>            <span class="c1"># Static eigenvalues corrections using DFPT (Sternheimer)</span>
 smdelta3 <span class="m">1</span>            <span class="c1"># Flag required to produce the _EIGI2D used to </span>
                       <span class="c1"># compute the lifetime of electronic levels.</span>
                       <span class="c1"># smdelta = 1 ==&gt; Fermi-Dirac smearing.</span>
 nbdbuf3  <span class="m">2</span>            <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 rfphon3  <span class="m">1</span>            <span class="c1"># Do phonon response</span>
 rfatpol3 <span class="m">1</span> <span class="m">2</span>          <span class="c1"># Treat displacements of all atoms</span>
 rfdir3   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>        <span class="c1"># Do all directions </span>
 tolwfr3  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt3  <span class="m">3</span>

<span class="c1"># Cell dependent parameters</span>
 acell <span class="m">3</span>*6.675
 rprim <span class="m">0</span> .5 .5 .5 <span class="m">0</span> .5 .5 .5 <span class="m">0</span>
 natom <span class="m">2</span>
 typat <span class="m">1</span> <span class="m">1</span>
 xred <span class="m">3</span>*0.0 <span class="m">3</span>*0.25
 nband <span class="m">12</span>
 ntypat <span class="m">1</span>
 znucl <span class="m">6</span>
 diemac <span class="m">6</span>
 ecut <span class="m">37</span>              
 enunit <span class="m">2</span>
 istwfk *1

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/C.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tdepes_2.abo,  tolnlines= 20, tolabs=  5.000e-05, tolrel=  5.000e-04, fld_options=-medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Ponc\&#39;e</span>
<span class="c1">#%% keywords = NC, DFPT, EPH_OLD</span>
<span class="c1">#%% description = Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5f3339c5-c9f3-4293-80ca-6f7461fdbb6a", "#uuid-d8a3a2d1-035a-4338-a76e-258b8e98bb21") }); </script>

As concern the anaddb input file, note that the electron-phonon analysis is triggered by
[[anaddb:thmflag]] 3, as well as [[anaddb:telphint]] 1 .

Launch anaddb by the command

    anaddb tdepes_2.abi 

(where `anaddb` might have to be replaced by the proper location of the anaddb executable).

The run will generate 3 files:

**tdepes_2.out_ep_G2F**
:  This g2F spectral function represents the contribution of the phononic modes of energy E
   to the change of electronic eigenenergies according to the equation

**tdepes_2.out_ep_PDS**
:  This file contains the phonon density of states

**tdepes_2.out_ep_TBS**
:  This file contains the eigenenergy corrections as well
   as the temperature dependence one.
   You can check that the results are the same as with the python script approach here above.


END OF OBSOLETE

-->

<h2 id="2-converging-the-calculation-with-respect-to-the-grid-of-phonon-wavevectors">2 Converging the calculation with respect to the grid of phonon wavevectors<a class="headerlink" href="#2-converging-the-calculation-with-respect-to-the-grid-of-phonon-wavevectors" title="Permanent link">&para;</a></h2>
<p>Convergence studies with respect to most of the parameters will rely on obvious modifications
of the input file detailed in the previous section. However, using more than one
q-point phonon wavevector needs a non-trivial generalisation of this procedure.
This is because each q-point needs to be treated in a different dataset in the current version of ABINIT.</p>
<!--
From now on we will only describe the approach with Abinit **compiled with Netcdf support**.
The approach with Anaddb is similar to what we described in the previous sections.
Note, however, that Anaddb only supports integration with homogenous q-point grids.
-->
<p>The code can perform the q-wavevector integration either with random q-points or
homogenous Monkhorst-Pack meshes.
Both grids have been used in the Ref. <a class="wikilink citation-wikilink" data-content="Verification of first-principles codes: Comparison of total energies, phonon frequencies, electronphonon coupling and zero-point motion correction to the gap between ABINIT and QE/Yambo" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2014">[Ponce2014]</a>, see e.g. Fig. 3 of this paper.</p>
<p>For the random integration method you
should create a script that generates random q-points, perform the Abinit
calculations at these points, gather the results and analyze them.
The temperature_final.py script will detect that you used random
integration thanks to the weight of the q-point stored in the _EIGR2D.nc file
and perform the integration accordingly.
The random integration converges slowly but in a smooth manner.</p>
<p>However, since this method is a little bit less user-friendly than the one based on homogeneous grids,
we will focus on this homogenous integration. 
In this case, the user must specify in the ABINIT input file the homogeneous q-point grid,
using input variables like
<a class="wikilink codevar-wikilink" href="../../variables/gstate#ngqpt">ngqpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptopt">qptopt</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#shiftq">shiftq</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#nshiftq">nshiftq</a>, &hellip;, i.e. variables whose names
are similar to those used to specify the k-point grid (for electrons).</p>
<p>There are several difficulties here.
First, since we focus on the k=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> point, we expect to be able to use symmetries to decrease the computational
load, as <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> is invariant under all symmetry operations of the crystal. The symmetry operations of the crystal will be used
to decrease the number of q-wavevectors, but they cannot be used as well to decrease the k-point grid during the corresponding
self-consistent phonon computation.
How this different behaviour of k-grids and q-grids can be handled by ABINIT ?
By convention, in such case, with <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1 the k-point grid will be generated in the Full Brillouin zone,
without use of symmetries, while the q-point grid with <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptopt">qptopt</a>=1 with be generated in the irreducible Brillouin Zone,
despite <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1. In order to generate q-point grids that are not folded in the irreducible Brillouin Zone, one need to use another value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptopt">qptopt</a>.
In particular <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptopt">qptopt</a>=3 has to be used to generate q points in the full Brillouin zone.</p>
<p>Second, the number of ABINIT datasets is expected to be given in the input file, by the user,
but not determined on-the-flight by ABINIT. Still, this number of datasets is determined by the number of q points.
Thus, the user will have to compute it before being able to launch the real q-point calculations, since it determines <a class="wikilink codevar-wikilink" href="../../variables/basic#ndtset">ndtset</a>.</p>
<p>How to determine the number of irreducible q points ?</p>
<p>Well, the easiest procedure is to compute it for an equivalent k-point grid, by a quick run.</p>
<p>An example will clarify this.
Suppose that one is looking for the number of q-points corresponding to</p>
<div class="codehilite"><pre><span></span><code>ngqpt 4 4 4
qptopt 1
nshiftq 1
shiftq 0.0 0.0 0.0
</code></pre></div>

<p>One make a quick ABINIT run with <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_2.abi" target="_blank">tests/tutorespfn/Input/tdepes_2.abi</a>.
Note that several input variables have been changed with respect to <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.abi" target="_blank">tests/tutorespfn/Input/tdepes_1.abi</a>:</p>
<div class="codehilite"><pre><span></span><code>ndtset 1
nstep 0
prtebands 0
ngkpt 4 4 4
nshiftk 1
shiftk 0.0 0.0 0.0
nsym 0
</code></pre></div>

<p>In this example, the new values of <a class="wikilink codevar-wikilink" href="../../variables/basic#ndtset">ndtset</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>, and the definition of <a class="wikilink codevar-wikilink" href="../../variables/gstate#prtebands">prtebands</a>
allow a fast run (<a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>==0 might be specified as well,
or even, the run might be interrupted after a few seconds, since the number of k points is very quickly available).
Then, the k-point grid is
specified thanks to <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nshiftk">nshiftk</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#shiftk">shiftk</a>, replacing the corresponding input variables for the q-point
grid. The use of symmetries has been reenabled thanks to <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=0.</p>
<p>To run it, issue:</p>
<div class="codehilite"><pre><span></span><code>abinit  tdepes_2.abi
</code></pre></div>

<p>Now, the number of points can be seen in the output file :</p>
<div class="highlight"><pre><span></span><code>             nkpt           8
</code></pre></div>
<p>the list of these eight k-points being given in
<div class="highlight"><pre><span></span><code>              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
</code></pre></div></p>
<p>We are now ready to launch the determination of the
_EIG.nc, _DDB, EIGR2D.nc and EIGI2D.nc files, with 8 q-points.
As for the <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> calculation of the previous section, we will rely on three
datasets for each q-point. This permits a well-structured set of calculations,
although there is some redundancy. Indeed, the first of these datasets will correspond
to an unperturbed ground-state calculation identical for all q. It is done very quickly because
the converged wavefunctions are already available. The second dataset will correspond to
a non-self-consistent ground-state calculation at k+q (it is also quick thanks to previously available wavefunctions),
and the third dataset will correspond to the DFPT calculations at k+q (this is the CPU intensive part) .</p>
<p>So, compared to the first run in this tutorial, we have to replace</p>
<div class="codehilite"><pre><span></span><code>ndtset 3     by      ndtset 24 udtset 8 3
</code></pre></div>

<p>in the input file <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.abi" target="_blank">tests/tutorespfn/Input/tdepes_3.abi</a>, and adjusted accordingly all input variables that were dataset-dependent.</p>
<div class="text-center"><button type="button" id="uuid-257b96ff-eccd-4f34-b860-e763f4fe1f60" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_3.abi
</button></div>
<div id="uuid-0e94eeb9-5316-46d8-801a-00bad0a27988" class="my_dialog" title="tests/tutorespfn/Input/tdepes_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># C in diamond structure. </span>
 ndtset <span class="m">24</span> udtset <span class="m">8</span> <span class="m">3</span>
 iqpt:? <span class="m">1</span>               <span class="c1"># Index of the first q-point of this file (useful if you split your </span>
                        <span class="c1"># input files</span>

 elph2_imagden <span class="m">0</span>.1 eV   <span class="c1"># Imaginary shift of the denominator of the sum-over-states </span>
                        <span class="c1"># in the perturbation denominator. Usual value is 0.1 eV to reproduce</span>
                        <span class="c1"># experimental broadening at 300K. Increasing the value help the </span>
                        <span class="c1"># convergence with respect to the number of q-points. </span>
 ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>            <span class="c1"># Underconverged : k-grid should be at least 4x4x4 for diamond to be converged.</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
 ngqpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>            <span class="c1"># Should be converged upon</span>
 qptopt <span class="m">1</span>
 nshiftq <span class="m">1</span>
 shiftq <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1"># Ground state density</span>
 iqpt+?    <span class="m">1</span>
 tolvrs?1  <span class="m">1</span>.0d-8     <span class="c1"># Underconverged : tolvrs 1.0d-18 should be used for converged results</span>

<span class="c1"># Non self-consistent calculation with an arbitrary q point (here Gamma)</span>
 getden?2 -1
 iscf?2   -2
 nqpt?2    <span class="m">1</span>
 nbdbuf?2  <span class="m">2</span>
 tolwfr?2  <span class="m">1</span>.0d-8   <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?2  <span class="m">3</span>

<span class="c1"># Computation at Gamma</span>
 getwfk?3 -2
 getwfq?3 -1
 nqpt?3    <span class="m">1</span>
 ieig2rf?3 <span class="m">5</span>            <span class="c1"># Static eigenvalues corrections using DFPT (Sternheimer)</span>
 smdelta?3 <span class="m">1</span>            <span class="c1"># Flag required to produce the _EIGI2D used to </span>
                        <span class="c1"># compute the lifetime of electronic levels.</span>
                        <span class="c1"># smdelta = 1 ==&gt; Fermi-Dirac smearing.</span>
 nbdbuf?3  <span class="m">2</span>            <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 rfphon?3  <span class="m">1</span>            <span class="c1"># Do phonon response</span>
 rfatpol?3 <span class="m">1</span> <span class="m">2</span>          <span class="c1"># Treat displacements of all atoms</span>
 rfdir?3   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>        <span class="c1"># Do all directions </span>
 tolwfr?3  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?3  <span class="m">3</span>

<span class="c1"># Cell dependent parameters</span>
 acell <span class="m">3</span>*6.675
 rprim <span class="m">0</span> .5 .5 .5 <span class="m">0</span> .5 .5 .5 <span class="m">0</span>
 nsym <span class="m">1</span>                <span class="c1"># Disable symmetries. Symmetries are not yet in production.</span>
 natom <span class="m">2</span>
 typat <span class="m">1</span> <span class="m">1</span>
 xred <span class="m">3</span>*0.0 <span class="m">3</span>*0.25
 nband <span class="m">12</span>
 ntypat <span class="m">1</span>
 znucl <span class="m">6</span>
 diemac <span class="m">6</span>
 ecut <span class="m">37</span>              
 enunit <span class="m">2</span>
 istwfk *1

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/C.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tdepes_3.abo,  tolnlines= 30, tolabs=  5.000e-05, tolrel=  5.000e-04, fld_options=-medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Ponc\&#39;e</span>
<span class="c1">#%% keywords = NC, DFPT, EPH_OLD</span>
<span class="c1">#%% description = Temperature dependence calculation of diamond.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-0e94eeb9-5316-46d8-801a-00bad0a27988", "#uuid-257b96ff-eccd-4f34-b860-e763f4fe1f60") }); </script>

<p>Please, refer to the
<a class="wikilink user-guide-wikilink" href="../../guide/abinit#35-defining-a-double-loop-dataset">explanation of the usage of a double-loop of datasets</a>
if you are confused about the meaning of <a class="wikilink codevar-wikilink" href="../../variables/basic#udtset">udtset</a>, and the usage of the corresponding metacharacters.
We have indeed also introduced</p>
<div class="codehilite"><pre><span></span><code>iqpt:? 1
iqpt+? 1
</code></pre></div>

<p>that translates into</p>
<div class="codehilite"><pre><span></span><code>iqpt11 1
iqpt12 1
iqpt13 1
iqpt21 2
iqpt22 2
iqpt23 2
iqpt31 3
 ...
</code></pre></div>

<p>allowing to perform calculations for three datasets at each q-point.</p>
<p>Then issue:</p>
<div class="codehilite"><pre><span></span><code>abinit tdepes_3.abi
</code></pre></div>

<p>This is a significantly longer ABINIT run (still less than two minutes), also producing many files.</p>
<p>When the run is finished, copy the file <a class="wikilink abifile-wikilink" href="../../tests/tutorespfn/Input/tdepes_3_temperature.in" target="_blank">tests/tutorespfn/Input/tdepes_3_temperature.in</a> in the
working directory (if not yet done) and launch the python script with:</p>
<div class="codehilite"><pre><span></span><code>./temperature_final.py &lt; tdepes_3_temperature.in
</code></pre></div>

<div class="text-center"><button type="button" id="uuid-6aa1164a-5a8d-49b9-a138-6b06ac2486c8" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_3_temperature.in
</button></div>
<div id="uuid-915a7aa0-a6f3-4fa3-85d9-4a5407b48bc9" class="my_dialog" title="tests/tutorespfn/Input/tdepes_3_temperature.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="m">1</span>                  
<span class="m">2</span>                  
temperature_3
<span class="m">0</span>.1                
<span class="m">0</span>.1                
<span class="m">0</span> <span class="m">0</span>.5              
<span class="m">0</span> <span class="m">1000</span> <span class="m">50</span>          
<span class="m">8</span>                  
tdepes_3o_DS13_DDB 
tdepes_3o_DS23_DDB
tdepes_3o_DS33_DDB
tdepes_3o_DS43_DDB
tdepes_3o_DS53_DDB
tdepes_3o_DS63_DDB
tdepes_3o_DS73_DDB
tdepes_3o_DS83_DDB
tdepes_3o_DS12_EIG.nc
tdepes_3o_DS22_EIG.nc
tdepes_3o_DS32_EIG.nc
tdepes_3o_DS42_EIG.nc
tdepes_3o_DS52_EIG.nc
tdepes_3o_DS62_EIG.nc
tdepes_3o_DS72_EIG.nc
tdepes_3o_DS82_EIG.nc
tdepes_3o_DS13_EIGR2D.nc
tdepes_3o_DS23_EIGR2D.nc
tdepes_3o_DS33_EIGR2D.nc
tdepes_3o_DS43_EIGR2D.nc
tdepes_3o_DS53_EIGR2D.nc
tdepes_3o_DS63_EIGR2D.nc
tdepes_3o_DS73_EIGR2D.nc
tdepes_3o_DS83_EIGR2D.nc
tdepes_3o_DS13_GKK.nc
tdepes_3o_DS23_GKK.nc
tdepes_3o_DS33_GKK.nc
tdepes_3o_DS43_GKK.nc
tdepes_3o_DS53_GKK.nc
tdepes_3o_DS63_GKK.nc
tdepes_3o_DS73_GKK.nc
tdepes_3o_DS83_GKK.nc
tdepes_3o_DS11_EIG.nc
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-915a7aa0-a6f3-4fa3-85d9-4a5407b48bc9", "#uuid-6aa1164a-5a8d-49b9-a138-6b06ac2486c8") }); </script>

<p>Examination of the same HOMO and LUMO bands at k=<span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> for a 4x4x4 q-point grid gives a very different result
than previously. 
The zero-point renormalization (ZPR) is the change of the bandgap at 0 K and was (band 4 - band 3):</p>
<div class="codehilite"><pre><span></span><code>-0.012507 - 0.017727 = -0.030234 eV
</code></pre></div>

<p>and is now:</p>
<div class="codehilite"><pre><span></span><code>-0.351528 - 0.095900 = -0.447428 eV
</code></pre></div>

<p>This means that the bandgap was closing by 30 meV at 0 K and is now closing by 447 meV at 0 K. 
For comparison, the converged direct bandgap ZPR of diamond is 438.6 meV from Ref. <a class="wikilink citation-wikilink" data-content="Temperature dependence of the electronic structure of semiconductors and insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2015">[Ponce2015]</a>.</p>
<p>As a matter of fact, diamond requires an extremely dense q-point grid (40x40x40) to be converged.
On the bright side, each q-point calculation is independent and thus the parallel scaling is ideal.
Running separate jobs for different q-points is quite easy thanks to the dtset approach.</p>
<h2 id="3-calculation-of-the-eigenenergy-corrections-along-high-symmetry-lines">3 Calculation of the eigenenergy corrections along high-symmetry lines<a class="headerlink" href="#3-calculation-of-the-eigenenergy-corrections-along-high-symmetry-lines" title="Permanent link">&para;</a></h2>
<p>The calculation of the electronic eigenvalue correction due to electron-phonon
coupling along high-symmetry lines requires the use of 6 datasets per q-point.
Moreover, the choice of an arbitrary k-wavevector breaks all symmetries of the crystal.
Different datasets are required to compute the following quantites:</p>
<p><span><span class="MathJax_Preview">\Psi^{(0)}_{kHom}</span><script type="math/tex">\Psi^{(0)}_{kHom}</script></span> : The ground-state wavefunctions on the Homogeneous k-point sampling.</p>
<p><span><span class="MathJax_Preview">\Psi^{(0)}_{kBS}</span><script type="math/tex">\Psi^{(0)}_{kBS}</script></span> : The ground-state wavefunctions computed along the bandstructure k-point sampling.</p>
<p><span><span class="MathJax_Preview">\Psi^{(0)}_{kHom+q}</span><script type="math/tex">\Psi^{(0)}_{kHom+q}</script></span> : The ground-state wavefunctions on the shifted Homogeneous k+q-point sampling.</p>
<p><span><span class="MathJax_Preview">n^{(1)}</span><script type="math/tex">n^{(1)}</script></span> : The perturbed density integrated over the homogeneous k+q grid.</p>
<p><span><span class="MathJax_Preview">\Psi^{(0)}_{kBS+q}</span><script type="math/tex">\Psi^{(0)}_{kBS+q}</script></span> : The ground-state wavefunctions obtained from reading the perturbed density of the previous dataset.</p>
<p>Reading the previous quantity we obtain the el-ph matrix elements along the bandstructure with all physical
quantities integrated over a homogeneous grid.</p>
<p>We will use the <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.abi" target="_blank">tests/tutorespfn/Input/tdepes_4.abi</a> input file</p>
<div class="text-center"><button type="button" id="uuid-790930dc-58d2-456b-a27c-257613e71c63" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_4.abi
</button></div>
<div id="uuid-0d80be15-8d2d-4797-967b-34c8bb7f708d" class="my_dialog" title="tests/tutorespfn/Input/tdepes_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># C in diamond structure. </span>
 ndtset <span class="m">48</span> udtset <span class="m">8</span> <span class="m">6</span>
 iqpt:? <span class="m">1</span>               <span class="c1"># Index of the first q-point of this file (useful if you split your </span>
                        <span class="c1"># input files</span>

 elph2_imagden <span class="m">0</span>.1 eV   <span class="c1"># Imaginary shift of the denominator of the sum-over-states </span>
                        <span class="c1"># in the perturbation denominator. Usual value is 0.1 eV to reproduce</span>
                        <span class="c1"># experimental broadening at 300K. Increasing the value help the </span>
                        <span class="c1"># convergence with respect to the number of q-points. </span>
 ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>            <span class="c1"># Underconverged : k-grid should be at least 4x4x4 for diamond to be converged.</span>
 nshiftk <span class="m">1</span>
 shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
 ngqpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>            <span class="c1"># Should be converged upon</span>
 qptopt <span class="m">3</span>
 nshiftq <span class="m">1</span>
 shiftq <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0

<span class="c1"># Ground state density</span>
 iqpt+?    <span class="m">1</span>
 tolvrs?1  <span class="m">1</span>.0d-8   <span class="c1"># Underconverged : tolvrs 1.0d-18 should be used for converged results</span>

<span class="c1"># Non self-consistent calculation following high sym k path</span>
 getden?2   -1
 iscf?2     -2
 getwfk?2   -1
 nstep?2     <span class="m">50</span>
 tolwfr?2    <span class="m">1</span>.0d-8   <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?2   -9
 ndivsm?2    <span class="m">5</span>
 kptbounds?2
    <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># L</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>
    <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># X</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># L</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>.0  <span class="c1"># X</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>

<span class="c1"># Non self-consistent calculation with an arbitrary q point </span>
 getden?3 -2
 getwfk?3 -2
 iscf?3   -2
 nqpt?3    <span class="m">1</span>
 nbdbuf?3  <span class="m">2</span>
 tolwfr?3  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?3  <span class="m">1</span>

<span class="c1"># Computation at q</span>
 getwfk?4 -3
 getwfq?4 -1
 nqpt?4    <span class="m">1</span>
 ieig2rf?4 <span class="m">5</span>            <span class="c1"># Static eigenvalues corrections using DFPT (Sternheimer)</span>
 smdelta?4 <span class="m">1</span>            <span class="c1"># Flag required to produce the _EIGI2D used to </span>
                        <span class="c1"># compute the lifetime of electronic levels.</span>
                        <span class="c1"># smdelta = 1 ==&gt; Fermi-Dirac smearing.</span>
 nbdbuf?4  <span class="m">2</span>            <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 rfphon?4  <span class="m">1</span>            <span class="c1"># Do phonon response</span>
 rfatpol?4 <span class="m">1</span> <span class="m">2</span>          <span class="c1"># Treat displacements of all atoms</span>
 rfdir?4   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>        <span class="c1"># Do all directions </span>
 tolwfr?4  <span class="m">1</span>.0d-8       <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?4  <span class="m">3</span>

<span class="c1"># Non self-consistent calculation following high sym k path</span>
 nqpt?5      <span class="m">1</span>
 getden?5   -4
 iscf?5     -2
 get1den?5  -1
 getwfk?5   -3
 nbdbuf?5    <span class="m">2</span>       <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 nstep?5     <span class="m">1</span>       <span class="c1"># We do not want mixing (self-consistent)</span>
 tolwfr?5    <span class="m">1</span>.0d-8  <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 kptopt?5   -9
 ndivsm?5    <span class="m">5</span>
 kptbounds?5
    <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># L</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>
    <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># X</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># L</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>.0  <span class="c1"># X</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>


<span class="c1"># Computation at an other q point</span>
 nqpt?6     <span class="m">1</span>
 getden?6  -5
 get1den?6 -2
 getwfk?6  -4
 getwfq?6  -1
 tolwfr?6   <span class="m">1</span>.0d-8  <span class="c1"># Underconverged : tolwfr 1.0d-22 should be used for converged results</span>
 nbdbuf?6   <span class="m">2</span>       <span class="c1"># 2 buffer bands. RF converges much faster.</span>
 <span class="c1">#ieig2rf?6  1</span>
 ieig2rf?6  <span class="m">5</span>
 smdelta?6  <span class="m">1</span>
 rfphon?6   <span class="m">1</span>
 rfatpol?6  <span class="m">1</span> <span class="m">2</span>
 rfdir?6    <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 iscf?6    -2
 kptopt?6  -9
 ndivsm?6   <span class="m">5</span>
 kptbounds?6
    <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># L</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>
    <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># X</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>/2  <span class="c1"># L</span>
    <span class="m">1</span>/4 <span class="m">1</span>/2 <span class="m">3</span>/4  <span class="c1"># W</span>
    <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>.0  <span class="c1"># X</span>
    <span class="m">3</span>/8 <span class="m">3</span>/8 <span class="m">3</span>/4  <span class="c1"># K</span>
    <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># Gamma</span>

<span class="c1"># Cell dependent parameters</span>
 acell <span class="m">3</span>*6.675
 rprim <span class="m">0</span> .5 .5 .5 <span class="m">0</span> .5 .5 .5 <span class="m">0</span>
 nsym <span class="m">1</span>                <span class="c1"># Disable symmetries. Symmetries are not yet in production.</span>
 natom <span class="m">2</span>
 typat <span class="m">1</span> <span class="m">1</span>
 xred <span class="m">3</span>*0.0 <span class="m">3</span>*0.25
 nband <span class="m">12</span>
 ntypat <span class="m">1</span>
 znucl <span class="m">6</span>
 diemac <span class="m">6</span>
 ecut <span class="m">37</span>              
 enunit <span class="m">2</span>
 istwfk *1

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;Pseudodojo_nc_sr_04_pw_standard_psp8/C.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = [^s][^c][^o].*</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tdepes_4.abo,  tolnlines= 0, tolabs=  0.0, tolrel=  0.0</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Ponc\&#39;e</span>
<span class="c1">#%% keywords = NC, DFPT, EPH_OLD</span>
<span class="c1">#%% description = Temperature dependence calculation of diamond.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-0d80be15-8d2d-4797-967b-34c8bb7f708d", "#uuid-790930dc-58d2-456b-a27c-257613e71c63") }); </script>

<p>Note the use of the usual input variables to define a path in the Brillouin Zone to build an electronic band structure:
<a class="wikilink codevar-wikilink" href="../../variables/gstate#kptbounds">kptbounds</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gstate#ndivsm">ndivsm</a>. Note also that we have defined <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptopt">qptopt</a>=3. The number of q-points
is thus very easy to determine, as being the product of <a class="wikilink codevar-wikilink" href="../../variables/gstate#ngqpt">ngqpt</a> values times <a class="wikilink codevar-wikilink" href="../../variables/gstate#nshiftq">nshiftq</a>. Here a very rough 2*2*2 grid has been chosen,
even less dense than the one for section 2.</p>
<p>Then issue:</p>
<div class="codehilite"><pre><span></span><code>abinit tdepes_4.abi
</code></pre></div>

<p>This is a significantly longer ABINIT run (5-10 minutes), also producing many files.</p>
<p>then use <a class="wikilink abifile-wikilink" href="../../tests/tutorespfn/Input/tdepes_4_temperature.in" target="_blank">tests/tutorespfn/Input/tdepes_4_temperature.in</a> for the python script.</p>
<div class="text-center"><button type="button" id="uuid-0c8a4212-d9d7-4572-8b34-f0de3fdd2a0c" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/tdepes_4_temperature.in
</button></div>
<div id="uuid-48d05a6c-91e3-4253-8b11-82396417eda2" class="my_dialog" title="tests/tutorespfn/Input/tdepes_4_temperature.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="m">1</span>                  
<span class="m">2</span>                  
temperature_4
<span class="m">0</span>.1                
<span class="m">0</span>.1                
<span class="m">0</span> <span class="m">0</span>.5              
<span class="m">0</span> <span class="m">1000</span> <span class="m">50</span>          
<span class="m">8</span>                  
tdepes_4o_DS14_DDB
tdepes_4o_DS24_DDB
tdepes_4o_DS34_DDB
tdepes_4o_DS44_DDB
tdepes_4o_DS54_DDB
tdepes_4o_DS64_DDB
tdepes_4o_DS74_DDB
tdepes_4o_DS84_DDB
tdepes_4o_DS15_EIG.nc
tdepes_4o_DS25_EIG.nc
tdepes_4o_DS35_EIG.nc
tdepes_4o_DS45_EIG.nc
tdepes_4o_DS55_EIG.nc
tdepes_4o_DS65_EIG.nc
tdepes_4o_DS75_EIG.nc
tdepes_4o_DS85_EIG.nc
tdepes_4o_DS16_EIGR2D.nc 
tdepes_4o_DS26_EIGR2D.nc
tdepes_4o_DS36_EIGR2D.nc
tdepes_4o_DS46_EIGR2D.nc
tdepes_4o_DS56_EIGR2D.nc
tdepes_4o_DS66_EIGR2D.nc
tdepes_4o_DS76_EIGR2D.nc
tdepes_4o_DS86_EIGR2D.nc
tdepes_4o_DS16_GKK.nc 
tdepes_4o_DS26_GKK.nc
tdepes_4o_DS36_GKK.nc
tdepes_4o_DS46_GKK.nc
tdepes_4o_DS56_GKK.nc
tdepes_4o_DS66_GKK.nc
tdepes_4o_DS76_GKK.nc
tdepes_4o_DS86_GKK.nc
tdepes_4o_DS12_EIG.nc 
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-48d05a6c-91e3-4253-8b11-82396417eda2", "#uuid-0c8a4212-d9d7-4572-8b34-f0de3fdd2a0c") }); </script>

<p>with the usual syntax:</p>
<div class="codehilite"><pre><span></span><code>./temperature_final.py &lt; tdepes_4_temperature.in
</code></pre></div>

<!-- THIS SECTION DOES NOT SEEM CORRECT : there is no other k point computed in section 2 ...
Of course, the high symmetry points computed in section 2 have the same value here.
It is a good idea to check it by running the script with the file tdepes_3bis.files.

-->

<p>You can now copy the plotting script (Plot-EP-BS) python file from
~abinit/scripts/post_processing/plot_bs.py into the directory where you did all the calculations.
Now run the script:</p>
<div class="codehilite"><pre><span></span><code>./plot_bs.py
</code></pre></div>

<p>with the following input data:</p>
<div class="highlight"><pre><span></span><code>temperature_4_EP.nc
L \Gamma X W K L W X K \Gamma
-20 30
0
</code></pre></div>
<p>or more directly</p>
<div class="codehilite"><pre><span></span><code>./plot_bs.py &lt; tdepes_4_plot_bs.abi
</code></pre></div>

<p>This should give the following bandstructure</p>
<p><img alt="" src="../tdepes_assets/plot4.png" /></p>
<p>where the solid black lines are the traditional electronic bandstructure, the
dashed lines are the electronic eigenenergies with electron-phonon
renormalization at a defined temperature (here 0K). Finally the area around
the dashed line is the lifetime of the electronic eigenstates.</p>
<p>Notice all the spikes in the electron-phonon case. This
is because we did a completely under-converged calculation
with respect to the q-point sampling.</p>
<p>It is possible to converge the calculations using <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>=30 Ha, a <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>
grid of 6x6x6 and an increasing <a class="wikilink codevar-wikilink" href="../../variables/gstate#ngqpt">ngqpt</a> grid to get converged results:</p>
<div class="codehilite"><pre><span></span><code><span class="o">|</span><span class="w"> </span><span class="n">Convergence</span><span class="w"> </span><span class="n">study</span><span class="w"> </span><span class="n">ZPR</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">inverse</span><span class="w"> </span><span class="n">lifetime</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n"></span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">eV</span><span class="o">]</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mi">0</span><span class="n">K</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">q</span><span class="o">-</span><span class="n">grid</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Nb</span><span class="w"> </span><span class="n">qpt</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="n">25</span><span class="err">&#39;</span><span class="w">      </span><span class="o">|</span><span class="w">        </span><span class="n">15</span><span class="w">       </span><span class="o">|</span><span class="w">      </span><span class="nf">Min</span><span class="w"> </span><span class="n"></span><span class="o">-</span><span class="n">X</span><span class="w">     </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">IBZ</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">ZPR</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">/</span><span class="n"></span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="n">ZPR</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">/</span><span class="n"></span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="n">ZPR</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="o">/</span><span class="n"></span><span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="n">x4x4</span><span class="w">    </span><span class="o">|</span><span class="w">  </span><span class="mi">8</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1175</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0701</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3178</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1916</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1570</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0250</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="n">x10x10</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">47</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1390</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0580</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.3288</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1847</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1605</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0308</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">20</span><span class="n">x20x20</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">256</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1446</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0574</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2691</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1823</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1592</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0298</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">26</span><span class="n">x26x26</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">511</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1448</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0573</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2736</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1823</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1592</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0297</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">34</span><span class="n">x34x34</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">1059</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1446</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0573</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2699</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1821</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1591</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0297</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">43</span><span class="n">x43x43</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">2024</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1447</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0572</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2650</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.1821</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1592</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0.0297</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
</code></pre></div>

<p>As you can see the limiting factor for the convergence study is the
convergence of the LUMO band at <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>. This band is not the lowest in energy (the
lowest is on the line between <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> and X) and therefore this band is rather
unstable. This can also be seen by the fact that it has a large electronic
broadening, meaning that this state will decay quickly into another state.</p>
<p>Using the relatively dense q-grid of 43x43x43 we can obtain the following
converged bandstructure, at a high temperature (1900K):</p>
<p><img alt="" src="../tdepes_assets/plot5.png" /></p>
<p>Here we show the renormalization at a very high temperature of 1900K in order
to highlight more the broadening and renormalization that occurs. If you want
accurate values of the ZPR at 0K you can look at the table above.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you use an extremely fine q-point grid, the acoustic phonon frequencies for
q-points close to <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> will be wrongly determined by Abinit. Indeed in order to
have correct phonon frequencies close to <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span>, one has to impose the acousting sum rule
with anaddb and <a class="wikilink codevar-wikilink" href="../../variables/anaddb#asr">asr@anaddb</a>.
However, this feature is not available in the python script. Instead, the script reject the
contribution of the acoustic phonon close to <span><span class="MathJax_Preview">\Gamma</span><script type="math/tex">\Gamma</script></span> if their phonon frequency is
lower than 1E-6 Ha. Otherwise one gets unphysically large contribution.</p>
<p>One can tune this parameter by editing the variable &ldquo;tol6 = 1E-6&rdquo; in the beginning of the script.</p>
<p>For example, for the last 43x43x43 calculation, it was set to 1E-4.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is possible to speed up the convergence with respect to increasing q-point density by noticing
that the renormalization behaves analytically with increasing q-point grid and smaller broadening.</p>
<p>It is therefore possible to extrapolate the results. Different analytical behavior extists depending
if the material is polar and if the state we are considering is a band extrema or not.
More information can be found in Ref. <a class="wikilink citation-wikilink" data-content="Temperature dependence of the electronic structure of semiconductors and insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#ponce2015">[Ponce2015]</a></p>
</div>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../eph/" title="Eph" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Eph
              </span>
            </div>
          </a>
        
        
          <a href="../gw1/" title="GW1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GW1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (SP)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>