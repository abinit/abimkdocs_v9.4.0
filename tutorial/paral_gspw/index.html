



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paral_gspw/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Parallelization of ground state</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#parallelization-of-ground-state-calculations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  Parallelism
                </span>
              
            
            GSPW
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.4.0
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeedMem/" title="TuningSpeedMem" class="md-nav__link">
      TuningSpeedMem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11" checked>
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        GSPW
      </label>
    
    <a href="./" title="GSPW" class="md-nav__link md-nav__link--active">
      GSPW
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Explore the k-points/plane waves/bands parallelization" class="md-nav__link">
    Explore the k-points/plane waves/bands parallelization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-simple-way-to-begin-automatic-distributed-parallelism" title="A simple way to begin: automatic distributed parallelism" class="md-nav__link">
    A simple way to begin: automatic distributed parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-more-sophisticated-method" title="A more sophisticated method" class="md-nav__link">
    A more sophisticated method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#even-more-sophisticated-bands-per-process-bandpp" title="Even more sophisticated: BANDs Per Process (bandpp)" class="md-nav__link">
    Even more sophisticated: BANDs Per Process (bandpp)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-parallelism-mpiopenmp" title="Hybrid parallelism: MPI+OpenMP" class="md-nav__link">
    Hybrid parallelism: MPI+OpenMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-kgb-parallelization" title="6 The KGB parallelization" class="md-nav__link">
    6 The KGB parallelization
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Explore the k-points/plane waves/bands parallelization" class="md-nav__link">
    Explore the k-points/plane waves/bands parallelization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-simple-way-to-begin-automatic-distributed-parallelism" title="A simple way to begin: automatic distributed parallelism" class="md-nav__link">
    A simple way to begin: automatic distributed parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-more-sophisticated-method" title="A more sophisticated method" class="md-nav__link">
    A more sophisticated method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#even-more-sophisticated-bands-per-process-bandpp" title="Even more sophisticated: BANDs Per Process (bandpp)" class="md-nav__link">
    Even more sophisticated: BANDs Per Process (bandpp)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-parallelism-mpiopenmp" title="Hybrid parallelism: MPI+OpenMP" class="md-nav__link">
    Hybrid parallelism: MPI+OpenMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-kgb-parallelization" title="6 The KGB parallelization" class="md-nav__link">
    6 The KGB parallelization
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paral_gspw.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="parallelization-of-ground-state-calculations">Parallelization of ground state calculations<a class="headerlink" href="#parallelization-of-ground-state-calculations" title="Permanent link">&para;</a></h1>
<h2 id="explore-the-k-pointsplane-wavesbands-parallelization">Explore the <em>k-points/plane waves/bands</em> parallelization<a class="headerlink" href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Permanent link">&para;</a></h2>
<p>This tutorial discusses how to perform ground-state calculations on hundreds/thousands
of computing unit (CPUs) cores using ABINIT.</p>
<p>You will learn how to use some keywords related to the <strong>KGB</strong> parallelization scheme where
<strong>K</strong> stands for <em>k-point</em>, <strong>G</strong> refers to the wavevector of a <em>planewave</em>, and <strong>B</strong> stands for <em>Band</em>.
It is possible to use ABINIT with other levels of parallelism but this is not the focus of this tutorial.
You will learn how to speedup your calculations and how to improve their convergence rate.</p>
<p>This tutorial should take about 1.5 hour and requires access to 64 CPU core parallel computer except for the last section which requires 256 CPU cores.</p>
<p>You are supposed to know already some basics of ABINIT.
Some useful references: <a class="wikilink citation-wikilink" data-content="Parallel eigensolvers in plane-wave Density Functional Theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#levitt2015">[Levitt2015]</a>, <a class="wikilink citation-wikilink" data-content="Large-scale ab initio calculations based on three levels of parallelization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bottin2008">[Bottin2008]</a>, <a class="wikilink citation-wikilink" data-content="Toward the Optimal Preconditioned Eigensolver: Locally Optimal Block Preconditioned Conjugate Gradient Method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#knyazev2001">[Knyazev2001]</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir <span class="c1"># Change this line</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>      <span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/             <span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> ~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><em>Before continuing you might work in a different subdirectory as for the other
tutorials. Why not work_paral_kgb?</em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In what follows, the names of files are mentioned as if you were in this subdirectory.
All the input files can be found in the <code>\$ABI_TESTS/tutoparal/Input</code> directory.
You can compare your results with reference output files located in <code>\$ABI_TESTS/tutoparal/Refs</code>.</p>
<p>In the following, when &ldquo;run ABINIT over <em>nn</em> CPU cores&rdquo; appears, you have to use
a specific command line according to the operating system and architecture of
the computer you are using. This can be for instance: <code>mpirun -n nn abinit input.abi</code>
or the use of a specific submission file.</p>
</div>
<p>When the size of the system increases up to 100 or 1000 atoms, it is usually
impossible to perform <em>ab initio</em> calculations with a single computing core.
This is because the basis sets used to solve the problem (plane waves, bands, &hellip;) increase
&mdash; linearly, as the square, or even exponentially &mdash;.
The computational resources are limited by two factors:</p>
<ul>
<li>The memory, <em>i.e</em>. the amount of data stored in RAM,</li>
<li>The computing efficiency, with specific bottlenecks.</li>
</ul>
<p>Therefore, it is mandatory to adopt a parallelization strategy:</p>
<ol>
<li>Distribute or share the data across a large number of computing nodes,</li>
<li>Parallelize the time consuming routines.</li>
</ol>
<p>In this tutorial, we will discuss:</p>
<ul>
<li>How to improve performance by using a large number of computing units (CPU cores),</li>
<li>
<p>How to decrease the computational time for a given number of CPU cores by:</p>
<ol>
<li>Reducing the time needed to perform one electronic iteration (improve efficiency)</li>
<li>Reducing the number of electronic iterations (improve convergence)</li>
</ol>
</li>
</ul>
<p>The tests are performed on a 107 gold atom system.
In this tutorial the plane-wave
cutoff energy is strongly reduced, for practical reasons.</p>
<h2 id="a-simple-way-to-begin-automatic-distributed-parallelism">A simple way to begin: automatic distributed parallelism<a class="headerlink" href="#a-simple-way-to-begin-automatic-distributed-parallelism" title="Permanent link">&para;</a></h2>
<p>The easiest way to activate the KGB parallelization in ABINIT is to
add just one input variable in the input file, <a class="wikilink codevar-wikilink" href="../../variables/paral#paral_kgb">paral_kgb</a>, which controls
everything concerning the KGB parallelization, including the choice of the iterative
eigensolver (<a class="wikilink codevar-wikilink" href="../../variables/dev#wfoptalg">wfoptalg</a> <strong>= 1, 4, 14, 114</strong>) and the use of a parallel 3dim-FFT.
Then you have to choose between 2 strategies:</p>
<ul>
<li>Activate the &mdash; not so good &mdash; flag <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> (automatic parallelization)
and use the associated <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> variable (maximum number of CPU cores you want),</li>
</ul>
<p>or</p>
<ul>
<li>Manually define the number of processes associated to each level of parallelism:
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npkpt">npkpt</a> (number of processes for k points),
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> (number of processes for bands),
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> (number of processes for plane-waves/FFT).</li>
</ul>
<p>OK, let&rsquo;s start!</p>
<p>Copy the <code>tgspw_01.abi</code> file the tutorial directory into your working directory.</p>
<div class="text-center"><button type="button" id="uuid-a2756576-419f-444d-9283-64f5ff8b5ba5" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_01.abi
</button></div>
<div id="uuid-2881c425-324d-480b-a85c-5ccc39f0b437" class="my_dialog" title="tests/tutoparal/Input/tgspw_01.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#############################################</span>
<span class="c1"># Gold with one vacancy (107 atoms of gold) #</span>
<span class="c1">#############################################</span>

<span class="c1"># Definition of the unit cell</span>
<span class="c1"># ===========================</span>
natom         <span class="m">107</span>

ntypat        <span class="m">1</span>

<span class="c1"># Species     </span>
<span class="c1">#             Au  </span>
znucl         
              <span class="m">79</span>  

typat         <span class="m">107</span>*1

acell         <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01

xred          
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01

pp_dirpath   <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
pseudos      <span class="s2">&quot;Pseudodojo_paw_pw_standard/Au.xml&quot;</span>

<span class="c1"># Electronic configuration</span>
<span class="c1"># ========================</span>
nband         <span class="m">640</span>
occopt        <span class="m">3</span> 
tsmear        <span class="m">0</span>.002
nkpt          <span class="m">1</span>

<span class="c1"># Convergence parameters</span>
<span class="c1"># ======================</span>
ecut          <span class="m">5</span>  <span class="c1"># Irrealist. Just to reduce the computation time in order to perform some benchmark</span>
pawecutdg     <span class="m">5</span>  <span class="c1"># Minimal value not converge to run with ecut</span>

<span class="c1"># Control of the SCF cycle</span>
<span class="c1"># ========================</span>
nstep         <span class="m">5</span>
toldfe        <span class="m">1</span>.e-7

<span class="c1"># Parallelization</span>
<span class="c1"># ===============</span>
paral_kgb     <span class="m">1</span>
autoparal     <span class="m">1</span>
max_ncpus     <span class="m">64</span>
timopt        -3 <span class="c1"># Get timing information of the run in the *.abo (output) file</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% expected_failure = yes</span>
<span class="c1">#%% [NCPU_1]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_01_MPI1.abo, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% nprocs_to_test = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin, J. Bieder</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description =  Gold with one vacancy (107 atoms of gold).</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-2881c425-324d-480b-a85c-5ccc39f0b437", "#uuid-a2756576-419f-444d-9283-64f5ff8b5ba5") }); </script>

<p>Then run ABINIT on 1 CPU core (using 1 MPI process and 1 <em>OpenMP</em> thread).</p>
<p>ABINIT should stop without starting a calculation (don&rsquo;t pay attention to the error message).
At the end of the output file <code>tgspw_01.abo</code>, you will see:</p>
<div class="highlight"><pre><span></span><code> Searching for all possible proc distributions for this input with <span class="ni">#CPUs</span>&lt;=64:

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 |       npkpt|       npfft|      npband|      bandpp|  <span class="ni">#MPI</span>(proc)|    WEIGHT|
 |    1&lt;&lt;    1|    1&lt;&lt;   22|    1&lt;&lt;   64|    1&lt;&lt;  640|    1&lt;&lt;   64|  &lt;=    64|
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 |           1|           4|          16|          10|          64|    42.328|
 |           1|           8|           8|          20|          64|    41.844|
 |           1|          16|           4|          40|          64|    41.730|
 |           1|           6|          10|          16|          60|    40.093|
 |           1|          15|           4|          40|          60|    39.054|
 |           1|           4|          16|           8|          64|    39.043|
 |           1|          12|           5|          32|          60|    39.026|
 |           1|           8|           8|          16|          64|    38.598|
 |           1|          16|           4|          32|          64|    38.493|
 |           1|           3|          20|           8|          60|    38.319|
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 Only the best possible choices for nproc are printed...
</code></pre></div>
<p>A weight is assigned to each distribution of processors. As indicated, you are advised
to select a processor distribution with a high <em>weight</em>. If we just focus on <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>
and <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>, we see that, for 64 MPI processes, the recommended distribution <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>x<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> is 16x4.</p>
<p>In a second step you can launch ABINIT in parallel on 64 cores by
changing your input file as follows:</p>
<div class="highlight"><pre><span></span><code><span class="gd">- autoparal     1</span>
<span class="gd">- max_ncpus     64</span>
<span class="gi">+ npband        16</span>
<span class="gi">+ npfft         4</span>
</code></pre></div>
<p>You can now perform your calculations using the KGB parallelization in ABINIT.
But somehow, you did it without understanding how you got the result&hellip;</p>
<h2 id="a-more-sophisticated-method">A more sophisticated method<a class="headerlink" href="#a-more-sophisticated-method" title="Permanent link">&para;</a></h2>
<p>In this part we will try to recover the previous process distribution, but with a better
understanding. As shown above, the pair (<a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> x <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>) of input variables
can have various values: (64x1), (32x2), (16x4), (8x8), (4x16).
In order to perform these 5 calculations you can use the <code>tgspw_02.abi</code>.</p>
<div class="text-center"><button type="button" id="uuid-17123f18-39b4-4423-8cda-6a7f1ede3927" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_02.abi
</button></div>
<div id="uuid-bfb8a920-55cc-4a2f-be49-1a0f2e99240f" class="my_dialog" title="tests/tutoparal/Input/tgspw_02.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#############################################</span>
<span class="c1"># Gold with one vacancy (107 atoms of gold) #</span>
<span class="c1">#############################################</span>

<span class="c1"># Definition of the unit cell</span>
<span class="c1"># ===========================</span>
natom         <span class="m">107</span>

ntypat        <span class="m">1</span>

<span class="c1"># Species     </span>
<span class="c1">#             Au  </span>
znucl         
              <span class="m">79</span>  

typat         <span class="m">107</span>*1

acell         <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01

xred          
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01

pp_dirpath   <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
pseudos      <span class="s2">&quot;Pseudodojo_paw_pw_standard/Au.xml&quot;</span>

<span class="c1"># Electronic configuration</span>
<span class="c1"># ========================</span>
nband         <span class="m">640</span>
occopt        <span class="m">3</span> 
tsmear        <span class="m">0</span>.002
nkpt          <span class="m">1</span>

<span class="c1"># Convergence parameters</span>
<span class="c1"># ======================</span>
ecut          <span class="m">5</span>  <span class="c1"># Irrealist. Just to reduce the computation time in order to perform some benchmark</span>
pawecutdg     <span class="m">5</span>  <span class="c1"># Minimal value not converge to run with ecut</span>

<span class="c1"># Control of the SCF cycle</span>
<span class="c1"># ========================</span>
nstep         <span class="m">5</span>
toldfe        <span class="m">1</span>.e-7

<span class="c1"># Parallelization</span>
<span class="c1"># ===============</span>
paral_kgb     <span class="m">1</span>
npband        <span class="m">16</span>  <span class="c1"># Change this line according to the tutorial  </span>
npfft         <span class="m">4</span>   <span class="c1"># Change this line according to the tutorial</span>
timopt        -3  <span class="c1"># Get timing information of the run in the *.abo (output) file</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [NCPU_64]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_02_MPI64.abo, tolnlines = 170, tolabs = 1.1e-3, tolrel = 1.0e-2 </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 64</span>
<span class="c1">#%% nprocs_to_test = 64</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin, J. Bieder</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-bfb8a920-55cc-4a2f-be49-1a0f2e99240f", "#uuid-17123f18-39b4-4423-8cda-6a7f1ede3927") }); </script>

<p>Change the line corresponding to the processor distribution.
A first calculation with:
<div class="highlight"><pre><span></span><code><span class="gd">- npband         16</span>
<span class="gd">- npfft          4</span>
<span class="gi">+ npband         64</span>
<span class="gi">+ npfft          1</span>
</code></pre></div></p>
<p>A second one with:
<div class="highlight"><pre><span></span><code><span class="gd">- npband         64</span>
<span class="gd">- npfft          1</span>
<span class="gi">+ npband         32</span>
<span class="gi">+ npfft          2</span>
</code></pre></div></p>
<p>And so on, until you have run all 5 calculations (<a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>x<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>) : (64x1), (32x2), (16x4), (8x8), (4x16).</p>
<p>Store all the output files by renaming them as follows:
The timing of each calculation can be retrieved using the shell command:
<code>tgspw_02.64.01.abo</code>, <code>tgspw_02.32.02.abo</code>,
<code>tgspw_02.16.04.abo</code>, <code>tgspw_02.08.08.abo</code> and
<code>tgspw_02.04.16.abo</code></p>
<p>The timing of each calculation can be retrieved using the shell command:
<div class="highlight"><pre><span></span><code>grep Proc *.abo
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>tgspw_02.04.16.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">62</span>.9  <span class="nv">wall</span><span class="o">=</span>         <span class="m">69</span>.4
tgspw_02.08.08.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">57</span>.9  <span class="nv">wall</span><span class="o">=</span>         <span class="m">64</span>.0
tgspw_02.16.04.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">56</span>.0  <span class="nv">wall</span><span class="o">=</span>         <span class="m">61</span>.8
tgspw_02.32.02.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">57</span>.1  <span class="nv">wall</span><span class="o">=</span>         <span class="m">62</span>.8
tgspw_02.64.01.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">60</span>.7  <span class="nv">wall</span><span class="o">=</span>         <span class="m">66</span>.4
</code></pre></div>
<p>As far as the timing is concerned, the best distributions are the ones
proposed in previous section: (16x4) seems to be the best one.
The prediction using <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> was pretty good.</p>
<p>Up to now, we have not learned more than before. We have so far only
considered the timing of 10 electronic steps.</p>
<p>However the <em>Locally Optimal Block Preconditioned Conjugate Gradient</em> algorithm (LOBPCG)
&mdash; used in ABINIT by default when <a class="wikilink codevar-wikilink" href="../../variables/paral#paral_kgb">paral_kgb</a> == 1 &mdash; operates a diagonalization by block of eigenvectors.
Each block of eigenvectors is concurrently diagonalized by the <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> processes,
one block after the other. When the <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> value is modified, the size of the block
changes accordingly (it is exactly equal to <code>npband</code>), and the solutions of the eigensolver are modified.
One calculation can be the quickest if we look at the time needed by one iteration
but the slowest at the end because many more steps are performed.
In order to see this, we can have a look at the convergence rate at the end
of the calculations.
The last iterations of the SCF loops are:</p>
<div class="highlight"><pre><span></span><code>grep <span class="s2">&quot;ETOT  5&quot;</span> *.abo
tgspw_02.04.16.abo: ETOT  <span class="m">5</span>  -3654.9080524851    -1.683E-04 <span class="m">6</span>.622E-05 <span class="m">2</span>.509E-04
tgspw_02.08.08.abo: ETOT  <span class="m">5</span>  -3654.9081359132    -2.710E-04 <span class="m">6</span>.111E-05 <span class="m">2</span>.318E-04
tgspw_02.16.04.abo: ETOT  <span class="m">5</span>  -3654.9082768015    -6.727E-05 <span class="m">5</span>.277E-05 <span class="m">1</span>.490E-04
tgspw_02.32.02.abo: ETOT  <span class="m">5</span>  -3654.9081759902    -2.737E-04 <span class="m">2</span>.495E-05 <span class="m">1</span>.968E-04
tgspw_02.64.01.abo: ETOT  <span class="m">5</span>  -3654.9083410155    -1.580E-04 <span class="m">6</span>.181E-05 <span class="m">1</span>.440E-04
</code></pre></div>
<p>The last column indicates the convergence of the <strong>residual of the density</strong> (because we are using PAW, otherwise it would be the residual of the potential in norm-conserving).
You can see that this quantity is the smallest when <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> is
the highest. This result is expected: the convergence is better when the size
of the block is the largest. But this <strong>best convergence</strong> is obtained for
the (64x1) distribution&hellip; when the <strong>worst timing</strong> is measured.</p>
<p>Already at the third iteration this behaviour is observed !
<div class="highlight"><pre><span></span><code>grep <span class="s2">&quot;ETOT  3&quot;</span> *.abo
tgspw_02.04.16.abo: ETOT  <span class="m">3</span>  -3654.8846449612    -2.877E-01 <span class="m">5</span>.690E-04 <span class="m">7</span>.055E-02
tgspw_02.08.08.abo: ETOT  <span class="m">3</span>  -3654.8848503583    -2.884E-01 <span class="m">8</span>.889E-04 <span class="m">7</span>.093E-02
tgspw_02.16.04.abo: ETOT  <span class="m">3</span>  -3654.8858758622    -2.798E-01 <span class="m">5</span>.805E-04 <span class="m">6</span>.792E-02
tgspw_02.32.02.abo: ETOT  <span class="m">3</span>  -3654.8866790037    -2.689E-01 <span class="m">6</span>.794E-05 <span class="m">6</span>.472E-02
tgspw_02.64.01.abo: ETOT  <span class="m">3</span>  -3654.8885890816    -2.528E-01 <span class="m">4</span>.112E-05 <span class="m">5</span>.918E-02
</code></pre></div></p>
<p>So, you face a dilemma. The calculation with the smallest number of iterations
(the best convergence) is not the best concerning the timing of one iteration
(the best efficiency), and vice versa&hellip; The best choice is a compromise.</p>
<p>In the following we will choose the (16x4) pair, because it
definitively offers more guarantees concerning the convergence and the timing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You could check that the convergence is not changed when the <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> value is modified.</p>
</div>
<h2 id="even-more-sophisticated-bands-per-process-bandpp">Even more sophisticated: BANDs Per Process (bandpp)<a class="headerlink" href="#even-more-sophisticated-bands-per-process-bandpp" title="Permanent link">&para;</a></h2>
<p>We have seen in the previous section that the best convergence is obtained
when the size of the block is the largest. This size was exactly equal to the
<a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> value. It was only possible to increase the block size by increasing
the number of MPI processes.</p>
<ul>
<li>
<p><em>Is it possible to do better?</em></p>
<p>The answer is <strong>yes</strong>! The input variable named <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> (BANDs Per Process)
enables to increase the block size without changing the number of processes
dedicated to bands.</p>
</li>
<li>
<p><em>How does this work?</em></p>
<p>As previoulsy, each block of bands is diagonalized by <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> MPI processes in parallel.
But, if <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> is activated, each process handles <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> bands.
The block size is now equal to <code>npband x bandpp</code>. 
Accordingly the block size can be
modified (usually increased) by playing with the value of <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>, without changing
the number of MPI processes.
Note that FFTs are still performed by the <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> MPI processes.</p>
</li>
</ul>
<p>In the following we use the same settings as previously, just performing more electronic step:</p>
<div class="highlight"><pre><span></span><code><span class="gi">+ nstep         10</span>
<span class="gi">+ bandpp        1 # This is the default value</span>
</code></pre></div>
<div class="text-center"><button type="button" id="uuid-3d11aae6-dd29-4a04-9968-9c09201eb823" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_03.abi
</button></div>
<div id="uuid-eb6d1878-af71-4285-b396-c4c213a5d50b" class="my_dialog" title="tests/tutoparal/Input/tgspw_03.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#############################################</span>
<span class="c1"># Gold with one vacancy (107 atoms of gold) #</span>
<span class="c1">#############################################</span>

<span class="c1"># Definition of the unit cell</span>
<span class="c1"># ===========================</span>
natom         <span class="m">107</span>

ntypat        <span class="m">1</span>

<span class="c1"># Species     </span>
<span class="c1">#             Au  </span>
znucl         
              <span class="m">79</span>  

typat         <span class="m">107</span>*1

acell         <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01

xred          
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01

pp_dirpath   <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
pseudos      <span class="s2">&quot;Pseudodojo_paw_pw_standard/Au.xml&quot;</span>

<span class="c1"># Electronic configuration</span>
<span class="c1"># ========================</span>
nband         <span class="m">640</span>
occopt        <span class="m">3</span> 
tsmear        <span class="m">0</span>.002
nkpt          <span class="m">1</span>

<span class="c1"># Convergence parameters</span>
<span class="c1"># ======================</span>
ecut          <span class="m">5</span>  <span class="c1"># Irrealist. Just to reduce the computation time in order to perform some benchmark</span>
pawecutdg     <span class="m">5</span>  <span class="c1"># Minimal value not converge to run with ecut</span>

<span class="c1"># Control of the SCF cycle</span>
<span class="c1"># ========================</span>
nstep         <span class="m">10</span>
toldfe        <span class="m">1</span>.e-7

<span class="c1"># Parallelization</span>
<span class="c1"># ===============</span>
paral_kgb     <span class="m">1</span>
npband        <span class="m">16</span>  <span class="c1"># Change this line according to the tutorial  </span>
bandpp        <span class="m">2</span>   <span class="c1"># Change this line according to the tutorial</span>
npfft         <span class="m">4</span>   <span class="c1"># Change this line according to the tutorial</span>
timopt        -3  <span class="c1"># Get timing information of the run in the *.abo (output) file</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [NCPU_64]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_03_MPI64.abo, tolnlines = 170, tolabs = 1.1e-3, tolrel = 1.0e-2 </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 64</span>
<span class="c1">#%% nprocs_to_test = 64</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin, J. Bieder</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-eb6d1878-af71-4285-b396-c4c213a5d50b", "#uuid-3d11aae6-dd29-4a04-9968-9c09201eb823") }); </script>

<p>Copy the input file <code>tgspw_03.abi</code> then run ABINIT over 64 CPUs,
setting <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=1</strong> and then <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=2</strong>. The output files will be
named <code>tgspw_03.bandpp1.abo</code> and <code>tgspw_03.bandpp2.abo</code>, respectively. A
comparison of these two files shows that the convergence is better in the
second case.
Conclusion: for a given number of processors, it is possible to improve
the convergence by increasing bandpp.</p>
<p>However, as you can see, the CPU time per iteration
increases when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases: </p>
<div class="highlight"><pre><span></span><code>grep Proc tgspw_03.bandpp1.abo tgspw_03.bandpp2.abo
tgspw_03.bandpp1.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">90</span>.0  <span class="nv">wall</span><span class="o">=</span>         <span class="m">95</span>.6
tgspw_03.bandpp2.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">90</span>.6  <span class="nv">wall</span><span class="o">=</span>         <span class="m">96</span>.4
</code></pre></div>
<p>Now look at the last iteration
<div class="highlight"><pre><span></span><code>grep <span class="s2">&quot;ETOT 10&quot;</span> tgspw_03.bandpp1.abo tgspw_03.bandpp2.abo
tgspw_03.bandpp1.abo: ETOT <span class="m">10</span>  -3654.9085401615    -2.882E-08 <span class="m">5</span>.100E-05 <span class="m">1</span>.247E-08
tgspw_03.bandpp2.abo: ETOT <span class="m">10</span>  -3654.9085401624    -3.744E-08 <span class="m">2</span>.632E-05 <span class="m">8</span>.003E-09
</code></pre></div></p>
<p>With <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>=2, the calculation is more converged ! </p>
<p>We can also compare the (16x4)+<a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=2</strong> distribution (16x2=32) with
the (32x2)+<a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=1</strong> (32x1=32) one.
These 2 calculation have <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>x<a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>=32 (and <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>x<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>=64).
Thus the convergence is the same !
Use the same input file and change it according to:</p>
<div class="highlight"><pre><span></span><code><span class="gd">- npband        16 </span>
<span class="gd">- bandpp        2  </span>
<span class="gd">- npfft         4  </span>
<span class="gi">+ npband        32 </span>
<span class="gi">+ bandpp        1  </span>
<span class="gi">+ npfft         2  </span>
</code></pre></div>
<p>Then run ABINIT over 64 MPI processes and name the output file <code>tgspw_03.32.02.bandpp1.abo</code> 
(This is one of the calculation you already did in the previous section but with <a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>=10 instead of 5).
Perform a <code>diff</code> between the two output files <code>tgspw_03.bandpp2.abo</code> 
and <code>tgspw_03.32.02.bandpp1.abo</code>. 
As you can see, the two calculations give exactly the same 
convergence rate. This was expected since, in both cases, the block sizes are equal (to 32)
and the number of FFT processors <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> does not affect the convergence.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to adjust the distribution of processes, without changing the
convergence, by reducing <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> and increasing <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> proportionally.</p>
</div>
<ul>
<li>
<p><em>Where does this CPU time consumption come from?</em></p>
<p>As previously explained, each MPI processes handles <code>bandpp</code> bands <strong>sequentially</strong>.
Thus the <em>sequential part</em> of the code increases when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be carefull ! Depending on the number of plane waves and the the number of bands, increasing <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>
can increase or decrease the cpu time ! Usually starting from 1, increasing <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> first decreases or maintains the cpu time,
and continuing increasing <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> will then increase the cpu time. 
Experience it by yourself (also depends on the hardware).</p>
</div>
<p>We will see in the next section how the use of <em>hybrid parallelism</em> can again improve this&hellip;</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Using only MPI parallelism, the timing of a single electronic step should theoretically increase
when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases but the convergence rate is better.</p>
</div>
<h2 id="hybrid-parallelism-mpiopenmp">Hybrid parallelism: MPI+<em>OpenMP</em><a class="headerlink" href="#hybrid-parallelism-mpiopenmp" title="Permanent link">&para;</a></h2>
<p>In modern supercomputers, the computing units (CPU cores) are no more equally distributed.
They are grouped by <strong>nodes</strong> in which they share the same memory access.
In so-called <em>many-core</em> architecture CPU cores can be numerous on the same node.
You could continue to use them as if they were not sharing the memory (using MPI only)
but this is not the most efficient way to take benefit from the computer.
The best practice is to use <em>hybrid</em> parallelism, mixing distributed memory parallelism
(MPI, between nodes) and shared memory parallelism ( <em>OpenMP</em>, inside a node). As you will
see, this will also have consequences on the performance of the iterative diagonalization
algorithm (LOBPCG).
Let&rsquo;s try!</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To use ABINIT with both MPI and OpenMP, make sure to compile abinit with
<code>--enable-openmp</code> to activate OpenMP support
<strong>and</strong> to link against a linear algebra library that support multithreading like <a href="https://software.intel.com/content/www/us/en/develop/tools/oneapi/components/onemkl/link-line-advisor.html">mkl</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we say &ldquo;set <code>OMP_NUM_THREADS=XX</code>&rdquo;, set your environment with <code>export OMP_NUM_THREADS=XX</code> for <code>bash</code> or <code>setenv OMP_NUM_THREADS XX</code> for <code>csh</code></p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When using threads, we have to impose <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> <strong>= 1</strong>.
The best is to suppress it from the input file.</p>
</div>
<p>The <code>tgspw_04.abi</code> input file has the parallelization set to <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>=32 and <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>=2.
Thus it uses 32 MPI processes. We have set <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>=2.</p>
<ol>
<li>Run ABINIT using 64 MPI processes and 1 <em>OpenMP</em> threads (set <code>OMP_NUM_THREADS=1</code>). Copy the output file to <code>tgspw_04.bandpp2.1thread.abo</code></li>
<li>Set <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>=1 and run ABINIT using 32 MPI processes and 2 <em>OpenMP</em> threads (set <code>OMP_NUM_THREADS=2</code>). Copy the output file to <code>tgspw_04.bandpp2.2thread.abo</code></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>32 MPI x 2 threads = 64 cores.</p>
</div>
<div class="text-center"><button type="button" id="uuid-c70eb38f-b1af-4849-a8af-3ab2a061a7ef" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_04.abi
</button></div>
<div id="uuid-7da5a451-3e9a-448e-9f89-ce27c77c21b5" class="my_dialog" title="tests/tutoparal/Input/tgspw_04.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#############################################</span>
<span class="c1"># Gold with one vacancy (107 atoms of gold) #</span>
<span class="c1">#############################################</span>

<span class="c1"># Definition of the unit cell</span>
<span class="c1"># ===========================</span>
natom         <span class="m">107</span>

ntypat        <span class="m">1</span>

<span class="c1"># Species     </span>
<span class="c1">#             Au  </span>
znucl         
              <span class="m">79</span>  

typat         <span class="m">107</span>*1

acell         <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01   <span class="m">2</span>.30100000000000e+01

xred          
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.66415066890000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">1</span>.63260959810000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.66415066890000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66415066890000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32513080460000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.33584933110000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.33161164200000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.33140408550000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">3</span>.32916578170000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">1</span>.63260959810000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">1</span>.63260959810000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67486919540000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">1</span>.66496231940000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">3</span>.33140408550000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">8</span>.36739040190000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00   <span class="m">6</span>.66859591450000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">1</span>.66496231940000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.33584933110000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">3</span>.33140408550000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66838835800000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">3</span>.32916578170000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">3</span>.32916578170000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">8</span>.33503768060000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01   <span class="m">6</span>.67083421830000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01   <span class="m">6</span>.66971121710000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">1</span>.65969123860000e-01
              <span class="m">8</span>.36739040190000e-01   <span class="m">8</span>.36739040190000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.66859591450000e-01   <span class="m">6</span>.66859591450000e-01   <span class="m">0</span>.00000000000000e+00
              <span class="m">6</span>.67083421830000e-01   <span class="m">8</span>.33503768060000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.33503768060000e-01   <span class="m">6</span>.67083421830000e-01   <span class="m">5</span>.00000000000000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">3</span>.32135680110000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">3</span>.33028878290000e-01
              <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01   <span class="m">8</span>.34030876140000e-01
              <span class="m">8</span>.34030876140000e-01   <span class="m">8</span>.34030876140000e-01   <span class="m">6</span>.67864319890000e-01
              <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01   <span class="m">6</span>.66971121710000e-01

pp_dirpath   <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
pseudos      <span class="s2">&quot;Pseudodojo_paw_pw_standard/Au.xml&quot;</span>

<span class="c1"># Electronic configuration</span>
<span class="c1"># ========================</span>
nband         <span class="m">640</span>
occopt        <span class="m">3</span> 
tsmear        <span class="m">0</span>.002
nkpt          <span class="m">1</span>

<span class="c1"># Convergence parameters</span>
<span class="c1"># ======================</span>
ecut          <span class="m">5</span>  <span class="c1"># Irrealist. Just to reduce the computation time in order to perform some benchmark</span>
pawecutdg     <span class="m">5</span>  <span class="c1"># Minimal value not converge to run with ecut</span>

<span class="c1"># Control of the SCF cycle</span>
<span class="c1"># ========================</span>
nstep         <span class="m">10</span>
toldfe        <span class="m">1</span>.e-7

<span class="c1"># Parallelization</span>
<span class="c1"># ===============</span>
paral_kgb     <span class="m">1</span>
npband        <span class="m">32</span>  <span class="c1"># Change this line according to the tutorial  </span>
bandpp        <span class="m">2</span>   <span class="c1"># Change this line according to the tutorial</span>
npfft         <span class="m">2</span>   <span class="c1"># Change this line according to the tutorial</span>
timopt        -3  <span class="c1"># Get timing information of the run in the *.abo (output) file</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [NCPU_64]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_04_MPI64.abo, tolnlines = 170, tolabs = 1.1e-3, tolrel = 1.0e-2 </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 64</span>
<span class="c1">#%% nprocs_to_test = 64</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin, J. Bieder</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7da5a451-3e9a-448e-9f89-ce27c77c21b5", "#uuid-c70eb38f-b1af-4849-a8af-3ab2a061a7ef") }); </script>

<p>Let&rsquo;s have a look at the timings and compare them :</p>
<div class="highlight"><pre><span></span><code>grep Proc tgspw_04.bandpp2.1thread.abo tgspw_04.bandpp2.2thread.abo
tgspw_04.bandpp2.1thread.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">97</span>.0  <span class="nv">wall</span><span class="o">=</span>        <span class="m">102</span>.5
tgspw_04.bandpp2.2thread.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>        <span class="m">148</span>.3  <span class="nv">wall</span><span class="o">=</span>         <span class="m">86</span>.5
</code></pre></div>
<p>As you can wee, the new output file show a larger computing time for process 0: (cpu=....) disappointing?
Not really: you have to keep in mind that this timing is for one MPI process, adding the timings
of all the <em>OpenMP</em> tasks for this process. In the pure MPI case, we thus have <code>97 sec.</code> per task;
but in the <em>hybrid</em> case, we have <code>148/2=74 sec.</code> per task. 
As you can see, the &ldquo;wall= ....&rdquo; time is closer to thos value and is more or less the real user time.
Therefore with 2 threads, the run last 86s whereas with only 1 thread, the run last 102s !!</p>
<p>For the total 64 cores, the total cpu time used by ABINIT is <code>97x64=6208 sec.</code> in the MPI case, <code>74*32=2368 sec.</code> in the hybrid case.
This is much better!
The best way to confirm that is to look at the <em>Wall Time</em> (cumulated on all tasks) at the end
of the output file:</p>
<div class="highlight"><pre><span></span><code>grep Overall tgspw_04.bandpp2.1thread.abo tgspw_04.bandpp2.2thread.abo
tgspw_04.bandpp2.1thread.abo:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">6419</span>.3  <span class="nv">wall</span><span class="o">=</span>       <span class="m">6555</span>.8
tgspw_04.bandpp2.2thread.abo:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">4853</span>.7  <span class="nv">wall</span><span class="o">=</span>       <span class="m">2766</span>.3
</code></pre></div>
<p><em>How does ABINIT distribute the workload?</em></p>
<p>Each block of bands is diagonalized by <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> MPI processes.
As previously, each process handles <code>bandpp</code> bands but now using the <em>OpenMP</em> tasks.
This means that <code>bandpp x npband</code> bands are computed in parallel using
<code>nthreads x npband</code> tasks (<code>bandpp</code> is supposed to be a multiple of <code>nthreads</code> to get the best performances).
This is in principle more efficient than in the pure MPI case.
Scalar products, matrix multiplications and other algebra operations are done in parallel by the <em>OpenMP</em> tasks (<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> not used).
Doing so, the communications between MPI processes are also reduced !</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When using threads, <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> needs not to be a multiple of threads but it is <strong>highly recommanded</strong>!</p>
</div>
<ul>
<li><em>How do we choose the number of threads?</em></li>
</ul>
<p>Well, it strongly depends on the computer architecture and the case!</p>
<p>A computer is made of <em>nodes</em>. On each node, there are <em>sockets</em> containing a given number
  of CPU cores. All the cores of one <em>node</em> can access the RAM of all the <em>sockets</em> but this access
  is faster on their own <em>socket</em>. This is the origin of the famous <em>Non Uniform Memory
  Access</em> effect (NUMA). The number of <em>threads</em> has thus to be a divisor of the total
  number of cores in the node, but it is better to choose a divisor of the number of
  cores in a <em>socket</em>. Indeed ABINIT performance is very sensitive to NUMA effect.</p>
<p>In the following, let&rsquo;s learn how to use ABINIT on 4 <em>OpenMP</em> threads&hellip;
First we change the input file as follows:</p>
<div class="highlight"><pre><span></span><code><span class="gd">- npband        32</span>
<span class="gd">- bandpp        2</span>
<span class="gi">+ npband        16</span>
<span class="gi">+ bandpp        4</span>
</code></pre></div>
<p>Then we run ABINIT using 16 MPI processes and 4 threads (still 64 cores) and rename the output file <code>tgspw_04.bandpp4.4thread.abo</code>
And we compare the timing of this &ldquo;4 threads&rdquo; case with the previous &ldquo;2 threads&rdquo; case:</p>
<div class="highlight"><pre><span></span><code>grep Overall tgspw_04.bandpp2.2thread.abo tgspw_04.bandpp4.4thread.abo
tgspw_04.bandpp2.2thread.abo:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">4853</span>.7  <span class="nv">wall</span><span class="o">=</span>       <span class="m">2766</span>.3
tgspw_04.bandpp4.4thread.abo:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">4423</span>.2  <span class="nv">wall</span><span class="o">=</span>       <span class="m">1316</span>.8
</code></pre></div>
<p>We again have improved ABINIT performances!</p>
<ul>
<li><em>Can we do better?</em></li>
</ul>
<p>In principle, yes. As previously explained, we have to increase the block size for
  the LOBPCG diagonalization algorithm. </p>
<p>Let&rsquo;s try it, just changing the <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> value in input file:</p>
<div class="highlight"><pre><span></span><code><span class="gd">- bandpp        4</span>
<span class="gi">+ bandpp        8</span>
</code></pre></div>
<p>We don&rsquo;t change here the number of threads (keeping 4).
And we obtain the following timings:</p>
<div class="highlight"><pre><span></span><code>grep Overall tgspw_04.bandpp4.4thread.abo tgspw_04.bandpp8.4thread.abo
tgspw_04.bandpp4.4thread.abo:+Overall time at end (sec) : cpu=       4423.2  wall=       1316.8
tgspw_04.bandpp8.4thread.abo:+Overall time at end (sec) : cpu=       4704.6  wall=       1417.3
</code></pre></div>
<p>The new settings do not give a better result&hellip;<strong>but</strong> for a few second you have a better convergence
<div class="highlight"><pre><span></span><code>grep &quot;ETOT 10&quot; tgspw_04.bandpp4.4thread.abo tgspw_04.bandpp8.4thread.abo
tgspw_04.bandpp4.4thread.abo: ETOT 10  -3654.9085401627    -5.105E-09 2.274E-05 1.673E-09
tgspw_04.bandpp8.4thread.abo: ETOT 10  -3654.9085401627    -1.376E-09 1.912E-05 6.053E-10
</code></pre></div>
Convergence has a cost&hellip;</p>
<p>To help you in choosing the distribution of processes/tasks, you can launch ABINIT with
the <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> and <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> keywords. <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> should be equal the
total number of targeted CPU cores, i.e. <code>nthreads x nMPI</code> and you should launch ABINIT on 1 MPI
process with <code>OMP_NUM_THREADS=nn</code>.
You can try this with <code>max_ncpus=64</code> and <code>OMP_NUM_THREADS=4</code>&hellip;</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The rules to distribute the workload are:</p>
<ul>
<li><code>npband x bandpp</code> (size of a block) should be maximized.
   It has to divide the number of bands (<code>nband</code>)</li>
<li><code>bandpp</code> should be a multiple of the number of <em>OpenMP</em> tasks</li>
<li><code>nband</code> has to be a multiple of <code>npband x bandpp</code>.</li>
<li>In any case, the ideal distribution is system dependent!</li>
</ul>
</div>
<h2 id="6-the-kgb-parallelization">6 The KGB parallelization<a class="headerlink" href="#6-the-kgb-parallelization" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this part, a cluster was used and therefore the timing for <code>tgspw_03.abi</code> is different than the previous run in the previous section.
<strong>Use the same cluster to run <code>tgspw_03.abi</code> and the following run.</strong></p>
</div>
<p>Up to now, we only performed a &ldquo;GB&rdquo; parallelization, using 2 levels (bands and/or FFT).
If the system has more than 1 <em>k-point</em>, one can add a third level of parallelization
and perform a full &ldquo;KBG&rdquo; parallelization. There is no difficulty in
adding processes to this level.</p>
<p>To test the full parallelism, we restart
with the same input file as in <code>tgspw_03.abi</code> and add a denser <em>k-point</em> grid.
In this case, the system has 4 <em>k-points</em> in
the <em>irreducible Brillouin zone</em> (IBZ) so the calculation can be parallelized over (at most) 4 <em>k-points</em>
MPI processes. This is done using the <a class="wikilink codevar-wikilink" href="../../variables/paral#npkpt">npkpt</a> input variable:</p>
<div class="highlight"><pre><span></span><code><span class="gd">- nkpt          1</span>
<span class="gi">+ ngkpt         4 4 4</span>
<span class="gi">+ npkpt         4</span>
</code></pre></div>
<p>We need 4 times more processes than before, so run ABINIT over
256 CPU cores (only MPI) with the <code>tgspw_05.abi</code> file.
The timing obtained in the output file <code>tgspw_05.abo</code> and <code>tgspw_03.abo</code> are:</p>
<p><div class="highlight"><pre><span></span><code>grep Proc tgspw_03.abo tgspw_05.abo 
tgspw_03.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">44</span>.2  <span class="nv">wall</span><span class="o">=</span>         <span class="m">45</span>.5
tgspw_05.abo:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">49</span>.3  <span class="nv">wall</span><span class="o">=</span>         <span class="m">50</span>.4
</code></pre></div>
They are quasi-identical !
This means that the scalability of ABINIT is quasi-linear on the <em>k-point</em> level.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When you want to parallelize a calculation, begin by the k-point level, then
follow with the band level; then activate the FFT level or OpenMP threads.</p>
</div>
<p>Here, the timing obtained for the output <code>tgspw_05.abo</code> leads to a hypothetical
speedup of <span><span class="MathJax_Preview">45.5/50.4 \times 256\approx 231</span><script type="math/tex">45.5/50.4 \times 256\approx 231</script></span>, which is good, but not 256 as expected if the scaling was
linear. Indeed, the time needed here is slightly longer (5 sec. more) than
the one obtained in <code>tgspw_03.abo</code>.
To go further, let&rsquo;s compare the time spent in all the routines.
All the input files you have used contain the input variable <a class="wikilink codevar-wikilink" href="../../variables/gstate#timopt">timopt</a>=-3 which activates the timing of different subparts of the run. 
You can find the results a the end of the output files before the references.</p>
<p>A first clue to undestand this not perfect speedup comes from the sequential code which is not parallelized. 
This sequential part is mainly (99%) done outside the &ldquo;vtowfk level&rdquo;.</p>
<p>Let&rsquo;s have a look at the time spend in the well parallelized subroutine <code>vtowfk</code>:</p>
<div class="highlight"><pre><span></span><code>grep -e <span class="s1">&#39;- vtowfk *[[:digit:]]&#39;</span> tgspw_03.abo tgspw_05.abo
tgspw_03.abo:- vtowfk                      <span class="m">2574</span>.132  <span class="m">89</span>.4   <span class="m">2589</span>.639  <span class="m">89</span>.3            <span class="m">640</span>                   <span class="m">0</span>.99       <span class="m">0</span>.99
tgspw_03.abo:- vtowfk                      <span class="m">2574</span>.132  <span class="m">89</span>.4   <span class="m">2589</span>.639  <span class="m">89</span>.3            <span class="m">640</span>                   <span class="m">0</span>.99       <span class="m">0</span>.99
tgspw_05.abo:- vtowfk                     <span class="m">10521</span>.057  <span class="m">82</span>.3  <span class="m">10595</span>.093  <span class="m">82</span>.3           <span class="m">2560</span>                   <span class="m">0</span>.99       <span class="m">0</span>.99
tgspw_05.abo:- vtowfk                     <span class="m">10521</span>.057  <span class="m">82</span>.3  <span class="m">10595</span>.093  <span class="m">82</span>.3           <span class="m">2560</span>                   <span class="m">0</span>.99       <span class="m">0</span>.99
</code></pre></div>
<p>We see that the KGB parallelization performs really well, since the wall time
spent within <code>vtowfk</code> is approximatively equal: <span><span class="MathJax_Preview">10521.057/256\approx 2574.132/64\approx 40</span><script type="math/tex">10521.057/256\approx 2574.132/64\approx 40</script></span>.
So, the speedup is quasi-linear in <code>vtowfk</code>. The problem comes from parts outside
<code>vtowfk</code> which are not parallelized and are responsible for the negligible
(100-82.3)% of time spent in sequential. These parts are no longer negligible
when you parallelize over hundreds of processors. The time spent in <code>vtowfk</code>
corresponds to 89.4% of the overall time when you don&rsquo;t parallelize over k-points,
and only 82.3% when you parallelize.</p>
<p>This behaviour is related to the <a href="https://en.wikipedia.org/wiki/Amdahl%27s_law">Amdhal&rsquo;s law</a>:</p>
<blockquote>
<p>The speedup of a program using multiple processes in parallel computing is
limited by the time needed for the sequential fraction of the program.</p>
</blockquote>
<p>For example, if a program needs 20 hours using a single processor core,
and a particular portion of 1 hour cannot be parallelized, while the remaining
portion of 19 hours (95%) can be parallelized, then regardless of how
many processor cores we have, the minimum execution time cannot be
less than that critical 1 hour. Hence the speedup is limited to 20.</p>
<p>In our case, the part above the loop over <em>k-points</em> in not parallelized by the
KGB parallelization. Even if this part is very small &mdash; less than 1% &mdash;
it determines an upper bound for the speedup.</p>
<!--
<sub><sup>To do in the future: discuss convergence, wfoptalg, nline</sup></sub>
-->
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../basepar/" title="Base" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Base
              </span>
            </div>
          </a>
        
        
          <a href="../paral_gswvl/" title="GSWVL" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GSWVL
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.4.0</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (FB, JB, MT)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>